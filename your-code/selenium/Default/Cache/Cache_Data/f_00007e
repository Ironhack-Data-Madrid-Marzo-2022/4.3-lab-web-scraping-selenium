{"version":3,"sources":["app/assets/modules/github/fuzzy-list-element.ts","app/assets/modules/github/virtual-list-element.ts","app/assets/modules/github/virtual-filter-input-element.ts","app/assets/modules/github/marked-text-element.ts","app/assets/modules/github/git-clone-help-element.ts","app/assets/modules/github/password-strength-element.ts","app/assets/modules/github/poll-include-fragment-element.ts","app/assets/modules/github/precise-time-ago-element.ts","app/assets/modules/github/slash-command-expander-element/keyword.ts","app/assets/modules/github/slash-command-expander-element/text-field-mirror.ts","app/assets/modules/github/slash-command-expander-element/text-field-selection-position.ts","app/assets/modules/github/slash-command-expander-element/slash-command-expander-element.ts","app/assets/modules/github/slash-command-expander-element/index.ts","app/assets/modules/github/behaviors/ajax-loading.ts","app/assets/modules/github/behaviors/ajax-pagination.ts","app/assets/modules/github/behaviors/analytics-events.ts","app/assets/modules/github/behaviors/announce-pjax-loading.ts","app/assets/modules/github/behaviors/autocheck.ts","app/assets/modules/github/behaviors/autocomplete.ts","app/assets/modules/github/behaviors/autosearch-form.ts","app/assets/modules/github/behaviors/autoselect.ts","app/assets/modules/github/behaviors/autosubmit.ts","app/assets/modules/github/behaviors/avatar-reset-text.ts","app/assets/modules/github/behaviors/batch-deferred-content.ts","app/assets/modules/github/behaviors/billing-addons.ts","app/assets/modules/github/behaviors/blob-csv.ts","app/assets/modules/github/repositories/blob-header.ts","app/assets/modules/github/blob-anchor.ts","app/assets/modules/github/range.ts","app/assets/modules/github/behaviors/blob-lines.ts","app/assets/modules/github/behaviors/branch-protection-integration-select.ts","app/assets/modules/github/behaviors/bulk-actions.ts","app/assets/modules/github/behaviors/bundle-download-stats.ts","app/assets/modules/github/behaviors/buttons.ts","app/assets/modules/github/behaviors/clear-data-on-logout.ts","app/assets/modules/github/behaviors/clipboard-copy.ts","app/assets/modules/github/behaviors/code-nav.ts","app/assets/modules/github/behaviors/commenting/ajax.ts","app/assets/modules/github/behaviors/commenting/close.ts","app/assets/modules/github/behaviors/commenting/focus.ts","app/assets/modules/github/png-scanner.ts","app/assets/modules/github/image-dimensions.ts","app/assets/modules/github/behaviors/commenting/caret-placement.ts","app/assets/modules/github/behaviors/commenting/markdown.ts","app/assets/modules/github/behaviors/commenting/preview.ts","app/assets/modules/github/behaviors/commenting/reaction-suggestion.ts","app/assets/modules/github/behaviors/commits.ts","app/assets/modules/github/behaviors/company-name-input.ts","app/assets/modules/github/behaviors/company-owned.ts","app/assets/modules/github/behaviors/details-element.ts","app/assets/modules/github/behaviors/details-menu.ts","app/assets/modules/github/behaviors/disable-with.ts","app/assets/modules/github/behaviors/document-dropzone.ts","app/assets/modules/github/behaviors/encrypt.ts","app/assets/modules/github/behaviors/favicon.ts","app/assets/modules/github/behaviors/feature-preview-indicator.ts","app/assets/modules/github/behaviors/feature-preview-trigger.ts","app/assets/modules/github/upload/attachment-upload.ts","app/assets/modules/github/upload/batch-upload.ts","app/assets/modules/github/upload/batch.ts","app/assets/modules/github/behaviors/file-attachment.ts","app/assets/modules/github/behaviors/filter-input.ts","app/assets/modules/github/behaviors/firefox-label-hacks.ts","app/assets/modules/github/behaviors/fixed-offset-fragment-navigation-observer.ts","app/assets/modules/github/flash.ts","app/assets/modules/github/behaviors/flash-observer.ts","app/assets/modules/github/behaviors/focus-delay.ts","app/assets/modules/github/behaviors/form-toggle.ts","app/assets/modules/github/behaviors/fuzzy-list.ts","app/assets/modules/github/behaviors/gfm.ts","app/assets/modules/github/behaviors/hooks.ts","app/assets/modules/github/behaviors/hovercards.ts","app/assets/modules/github/behaviors/hydro-analytics-pageview.ts","app/assets/modules/github/behaviors/hydro-analytics-tracking.ts","app/assets/modules/github/behaviors/hydro-click-tracking.ts","app/assets/modules/github/behaviors/immediate-updates.ts","app/assets/modules/github/behaviors/indeterminate.ts","app/assets/modules/github/behaviors/jump-to-loader.ts","app/assets/modules/github/behaviors/keyboard-shortcuts.ts","app/assets/modules/github/behaviors/length-limited-input-with-warning.ts","app/assets/modules/github/behaviors/link-prefetch-viewed.ts","app/assets/modules/github/behaviors/member-search-filter.ts","app/assets/modules/github/behaviors/new-organization-name.ts","app/assets/modules/github/behaviors/notice.ts","app/assets/modules/github/behaviors/open-in-github-dev.ts","app/assets/modules/github/behaviors/open-in-blackbird.ts","app/assets/modules/github/behaviors/permalink.ts","app/assets/modules/github/behaviors/permission-menu-form.ts","app/assets/modules/github/behaviors/pjax-loader.ts","app/assets/modules/github/behaviors/pjax-timing.ts","app/assets/modules/github/behaviors/turbo-timing.ts","app/assets/modules/github/behaviors/pjax/exceptions.ts","app/assets/modules/github/behaviors/pjax/navigation.ts","app/assets/modules/github/behaviors/pjax/submit.ts","app/assets/modules/github/behaviors/print-popup.ts","app/assets/modules/github/behaviors/poll-include-fragment.ts","app/assets/modules/github/behaviors/proxy-site-reporting.ts","app/assets/modules/github/behaviors/quick-submit.ts","app/assets/modules/github/behaviors/quote-selection.ts","app/assets/modules/github/behaviors/reactions.ts","app/assets/modules/github/behaviors/remote-form.ts","app/assets/modules/github/behaviors/remote-pagination-element.ts","app/assets/modules/github/behaviors/removed-contents.ts","app/assets/modules/github/behaviors/enrichable-markdown-render.ts","app/assets/modules/github/behaviors/render-editor.ts","app/assets/modules/github/behaviors/replace-remote-form.ts","app/assets/modules/github/behaviors/report-long-tasks.ts","app/assets/modules/github/behaviors/responsive-markdown-toolbar.ts","app/assets/modules/github/behaviors/saved-replies.ts","app/assets/modules/github/behaviors/scanning.ts","app/assets/modules/github/behaviors/segmented-nav.ts","app/assets/modules/github/session-resume-helpers.ts","app/assets/modules/github/behaviors/session-resume.ts","app/assets/modules/github/notifications/v2/notification-shelf-referrer-params.ts","app/assets/modules/github/notifications/v2/notification-shelf-helpers.ts","app/assets/modules/github/behaviors/site-notifications.ts","app/assets/modules/github/behaviors/site-search.ts","app/assets/modules/github/behaviors/size-to-fit.ts","app/assets/modules/github/behaviors/snippet-clipboard-copy.ts","app/assets/modules/github/behaviors/social.ts","app/assets/modules/github/alive-session.ts","app/assets/modules/github/alive/idle-state.ts","app/assets/modules/github/behaviors/socket-channel.ts","app/assets/modules/github/behaviors/socket-channel-cache.ts","app/assets/modules/github/behaviors/sso-auto-replay.ts","app/assets/modules/github/behaviors/statuses.ts","app/assets/modules/github/behaviors/sudo-required.ts","app/assets/modules/github/behaviors/suggesters/audit-log-suggester.ts","app/assets/modules/github/behaviors/suggesters/emoji-suggester.ts","app/assets/modules/github/behaviors/suggesters/issue-suggester.ts","app/assets/modules/github/behaviors/suggesters/mention-suggester.ts","app/assets/modules/github/behaviors/suggesters/slash-command-suggester.ts","app/assets/modules/github/behaviors/survey.ts","app/assets/modules/github/behaviors/sync-details-text.ts","app/assets/modules/github/behaviors/tab-container.ts","app/assets/modules/github/behaviors/targetable-elements.ts","app/assets/modules/github/behaviors/team-members.ts","app/assets/modules/github/behaviors/text-suggester-element.ts","app/assets/modules/github/behaviors/timeline/marker.ts","app/assets/modules/github/behaviors/timeline/progressive.ts","app/assets/modules/github/behaviors/timeline/timeline-accessibility.ts","app/assets/modules/github/behaviors/timing-stats.ts","app/assets/modules/github/behaviors/toggler.ts","app/assets/modules/github/behaviors/register-service-worker.ts","app/assets/modules/github/behaviors/turbo.ts","app/assets/modules/github/timezone.ts","app/assets/modules/github/behaviors/tz-cookie.ts","app/assets/modules/github/behaviors/webauthn-get.ts","app/assets/modules/github/behaviors/unread-comments.ts","app/assets/modules/github/behaviors/unread-item-counter.ts","app/assets/modules/github/behaviors/updatable-content-observer.ts","app/assets/modules/github/behaviors/updatable-content-stale-object.ts","app/assets/modules/github/behaviors/upload-avatar.ts","app/assets/modules/github/behaviors/user-content.ts","app/assets/modules/github/behaviors/user-status-loader.ts","app/assets/modules/github/behaviors/user-lists.ts","app/assets/modules/github/behaviors/visible-password-element.ts","app/assets/modules/github/behaviors/warn-unsaved-changes.ts","app/assets/modules/github/behaviors/will-transition-once.ts","app/assets/modules/github/behaviors/play-video.ts","app/assets/modules/github/issues/issue-link.ts","app/assets/modules/github/issues/labels.ts","app/assets/modules/github/notifications/configure-thread-subscription-dialog.ts","app/assets/modules/github/issues/sidebar-widget.ts","app/assets/modules/github/issues/sidebar-memex-input.ts","app/assets/modules/github/issues/sidebar.ts","app/assets/modules/github/analytics-overrides.ts","app/assets/modules/github/behaviors/button-outline.ts","app/assets/modules/github/behaviors/characters-remaining.ts","app/assets/modules/github/behaviors/confirm.ts","app/assets/modules/github/behaviors/include-fragment.ts","app/assets/modules/github/behaviors/pjax/beforeunload.ts","app/assets/modules/github/behaviors/responsive-underlinenav.ts","app/assets/modules/github/behaviors/side-navigation.ts","app/assets/modules/github/behaviors/stale-session.ts","app/assets/modules/github/behaviors/tag-input.ts","app/assets/modules/github/code-editor.ts","app/assets/modules/github/cookies.ts","app/assets/modules/github/failbot.ts","app/assets/modules/github/hydro-analytics.ts","app/assets/modules/github/hydro-tracking.ts","app/assets/modules/github/include-fragment-element-hacks.ts","app/assets/modules/github/jump-to/ranking.ts","app/assets/modules/github/jump-to/page-views.ts","app/assets/modules/github/notifications/v2/update-notification-states.ts","app/assets/modules/github/platform-toggle.ts","app/assets/modules/github/session-storage.ts","app/assets/modules/github/soft-nav-helpers.ts","app/assets/modules/github/sticky-scroll-into-view.ts","app/assets/modules/github/sudo.ts","app/assets/modules/github/text.ts","app/assets/modules/github/webauthn-support-level.ts"],"names":[],"mappings":"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","file":"behaviors-xxxxxxxxxxxx.js","sourcesContent":["import {score as fuzzyScore, hasMatch, positions} from 'fzy.js'\n\nconst getScore = (value: string, text: string, minScore: number) => {\n  if (!hasMatch(value, text)) return -Infinity\n  const score = fuzzyScore(value, text)\n  if (score < minScore) return -Infinity\n  return score\n}\nconst highlightElement = (node: HTMLElement, value: string, text: string) => {\n  node.innerHTML = ''\n\n  let lastPosition = 0\n  for (const i of positions(value, text)) {\n    const slice = text.slice(lastPosition, i)\n    if (slice !== '') {\n      node.appendChild(document.createTextNode(text.slice(lastPosition, i)))\n    }\n    lastPosition = i + 1\n    const mark = document.createElement('mark')\n    mark.textContent = text[i]\n    node.appendChild(mark)\n  }\n\n  node.appendChild(document.createTextNode(text.slice(lastPosition)))\n}\n\ninterface sortAbort {\n  aborted: boolean\n}\nconst sorting: WeakMap<FuzzyListElement, sortAbort> = new WeakMap()\n\ntype FuzzyListLazyRenderCallback = (text: string) => Node\ninterface state {\n  timer: number | null\n  handler: MutationObserver\n  items: Set<Node>\n  lazyItems: Map<string, FuzzyListLazyRenderCallback>\n}\nconst states: WeakMap<FuzzyListElement, state> = new WeakMap()\n\nconst textCache: WeakMap<Node, string> = new WeakMap()\nconst getTextCache = (item: Node) => {\n  if (!textCache.has(item) && item instanceof HTMLElement) {\n    const value = (item.getAttribute('data-value') || item.textContent || '').trim()\n    textCache.set(item, value)\n    return value\n  }\n  return textCache.get(item) || ''\n}\n\nclass FuzzyListElement extends HTMLElement {\n  connectedCallback() {\n    /* eslint-disable-next-line custom-elements/no-dom-traversal-in-connectedcallback */\n    const list = this.querySelector('ul')\n    if (!list) return\n\n    /* eslint-disable-next-line custom-elements/no-dom-traversal-in-connectedcallback */\n    const items = new Set(list.querySelectorAll('li'))\n\n    /* eslint-disable-next-line custom-elements/no-dom-traversal-in-connectedcallback */\n    const inputEl = this.querySelector('input')\n    if (inputEl instanceof HTMLInputElement) {\n      inputEl.addEventListener('input', () => {\n        this.value = inputEl.value\n      })\n    }\n\n    const handler = new MutationObserver(mutations => {\n      let update = false\n      for (const mutation of mutations) {\n        if (mutation.type === 'childList' && mutation.addedNodes.length) {\n          for (const item of mutation.addedNodes) {\n            if (item instanceof HTMLLIElement && !items.has(item)) {\n              const text = getTextCache(item)\n              update = update || hasMatch(this.value, text)\n              items.add(item)\n            }\n          }\n        }\n      }\n      if (update) this.sort()\n    })\n    handler.observe(list, {childList: true})\n\n    const state = {handler, items, lazyItems: new Map(), timer: null}\n    states.set(this, state)\n  }\n\n  disconnectedCallback() {\n    const state = states.get(this)\n    if (state) {\n      state.handler.disconnect()\n      states.delete(this)\n    }\n  }\n\n  addLazyItems(dataset: string[], render: FuzzyListLazyRenderCallback) {\n    const state = states.get(this)\n    if (!state) return\n    const {lazyItems} = state\n    const {value} = this\n    let update = false\n    for (const item of dataset) {\n      lazyItems.set(item, render)\n      update = update || (Boolean(value) && hasMatch(value, item))\n    }\n    if (update) this.sort()\n  }\n\n  sort() {\n    const oldSortAbort = sorting.get(this)\n    if (oldSortAbort) oldSortAbort.aborted = true\n    const sortAbort = {aborted: false}\n    sorting.set(this, sortAbort)\n    const {minScore, markSelector, maxMatches, value} = this\n    const state = states.get(this)\n    if (!state) return\n    if (!this.dispatchEvent(new CustomEvent('fuzzy-list-will-sort', {cancelable: true, detail: value}))) return\n    const {items, lazyItems} = state\n    const shouldMark = this.hasAttribute('mark-selector')\n\n    const list = this.querySelector('ul')\n    if (!list) return\n\n    const itemsToRender: Array<\n      {render: FuzzyListLazyRenderCallback; text: string; score: number} | {item: Node; score: number}\n    > = []\n\n    if (value) {\n      for (const item of items) {\n        const text = getTextCache(item)\n        const score = getScore(value, text, minScore)\n        if (score === -Infinity) continue\n        itemsToRender.push({item, score})\n      }\n      for (const [text, render] of lazyItems) {\n        const score = getScore(value, text, minScore)\n        if (score === -Infinity) continue\n        itemsToRender.push({text, render, score})\n      }\n      itemsToRender.sort((a, b) => b.score - a.score).splice(maxMatches)\n    } else {\n      let i = itemsToRender.length\n      for (const item of items) {\n        if (i >= maxMatches) break\n        itemsToRender.push({item, score: 1})\n        i += 1\n      }\n      for (const [text, render] of lazyItems) {\n        if (i >= maxMatches) break\n        itemsToRender.push({text, render, score: 1})\n        i += 1\n      }\n    }\n\n    requestAnimationFrame(() => {\n      if (sortAbort.aborted) return\n\n      // Store a reference to the checked input (if there is one) as when we\n      // append other (stale) items they could be checked, and we want to keep\n      // the originally checked item as the only checked item\n      const checkedInputBeforeFilter = list.querySelector('input[type=\"radio\"]:checked')\n\n      list.innerHTML = ''\n      let offset = 0\n\n      const nextBatch = () => {\n        if (sortAbort.aborted) return\n        const end = Math.min(itemsToRender.length, offset + 100)\n        const fragment = document.createDocumentFragment()\n        for (let i = offset; i < end; i += 1) {\n          const itemToRender = itemsToRender[i]\n          let item = null\n          if ('render' in itemToRender && 'text' in itemToRender) {\n            const {render, text} = itemToRender\n            item = render(text)\n            items.add(item)\n            textCache.set(item, text)\n            lazyItems.delete(text)\n          } else if ('item' in itemToRender) {\n            item = itemToRender.item\n          }\n          if (item instanceof HTMLElement) {\n            if (shouldMark) {\n              highlightElement(\n                markSelector ? item.querySelector(markSelector) || item : item,\n                shouldMark ? value : '',\n                getTextCache(item)\n              )\n            }\n            fragment.appendChild(item)\n          }\n        }\n        offset = end\n\n        // Loop through all items that are about to be rendered - if there are\n        // any radios that are checked that conflict with the one checked item,\n        // then reset them to unchecked state\n        let inputStateReset = false\n        if (checkedInputBeforeFilter instanceof HTMLInputElement) {\n          for (const checkedInput of fragment.querySelectorAll('input[type=\"radio\"]:checked')) {\n            if (checkedInput instanceof HTMLInputElement && checkedInput.value !== checkedInputBeforeFilter.value) {\n              checkedInput.checked = false\n              inputStateReset = true\n            }\n          }\n        }\n\n        list.appendChild(fragment)\n\n        // If any checked items were changed then a change event should be\n        // fired to let other observers know\n        if (checkedInputBeforeFilter && inputStateReset) {\n          checkedInputBeforeFilter.dispatchEvent(new Event('change', {bubbles: true}))\n        }\n\n        if (end < itemsToRender.length) {\n          requestAnimationFrame(nextBatch)\n        } else {\n          list.hidden = itemsToRender.length === 0\n          const emptyEl = this.querySelector<HTMLElement>('[data-fuzzy-list-show-on-empty]')\n          if (emptyEl) {\n            emptyEl.hidden = itemsToRender.length > 0\n          }\n\n          this.dispatchEvent(new CustomEvent('fuzzy-list-sorted', {detail: itemsToRender.length}))\n        }\n      }\n\n      nextBatch()\n    })\n  }\n\n  get value(): string {\n    return this.getAttribute('value') || ''\n  }\n\n  set value(value: string) {\n    this.setAttribute('value', value)\n  }\n\n  get markSelector(): string {\n    return this.getAttribute('mark-selector') || ''\n  }\n\n  set markSelector(value: string) {\n    if (value) {\n      this.setAttribute('mark-selector', value)\n    } else {\n      this.removeAttribute('mark-selector')\n    }\n  }\n\n  get minScore(): number {\n    return Number(this.getAttribute('min-score') || 0)\n  }\n\n  set minScore(value: number) {\n    if (Number.isNaN(value)) return\n    this.setAttribute('min-score', String(value))\n  }\n\n  get maxMatches(): number {\n    return Number(this.getAttribute('max-matches') || Infinity)\n  }\n\n  set maxMatches(value: number) {\n    if (Number.isNaN(value)) return\n    this.setAttribute('max-matches', String(value))\n  }\n\n  static get observedAttributes(): string[] {\n    return ['value', 'mark-selector', 'min-score', 'max-matches']\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (oldValue === newValue) return\n    const state = states.get(this)\n    if (!state) return\n    if (state.timer) window.clearTimeout(state.timer)\n    state.timer = window.setTimeout(() => this.sort(), 100)\n  }\n}\n\nexport default FuzzyListElement\n\nif (!window.customElements.get('fuzzy-list')) {\n  window.FuzzyListElement = FuzzyListElement\n  window.customElements.define('fuzzy-list', FuzzyListElement)\n}\n\ndeclare global {\n  interface Window {\n    FuzzyListElement: typeof FuzzyListElement\n  }\n}\n","/**\n * A list component that keeps only visible items in DOM.\n * The items that do not fit in the viewport will be detached from DOM and reattached on scroll.\n *\n * Important:\n * - Virtual List will use the first item in the dataset to calculate assumed visual height for all items\n * - There is no error correction for items having different visual height\n * - It extends Set to be compatible with virtual-filter-input-element - to be \"controllable\" from the outside\n */\nclass VirtualListElement<V> extends HTMLElement implements Set<V> {\n  #sorted = false\n  #items: Set<V> = new Set()\n\n  // Heights is used to track the rendered height\n  // of a list element. This is useful because the\n  // height may vary from item to item, and so each\n  // height must be tracked.\n  #heights: Map<V, number> = new Map()\n  #assumedHeight = Infinity\n\n  #rangeCache = new Map<string, [number, number]>()\n  #renderCache = new Map<V, Element>()\n\n  #animationFrameId = 0\n\n  static get observedAttributes() {\n    return ['data-updating']\n  }\n\n  get updating(): 'eager' | 'lazy' {\n    if (this.getAttribute('data-updating') === 'lazy') return 'lazy'\n    return 'eager'\n  }\n\n  set updating(value: 'eager' | 'lazy') {\n    this.setAttribute('data-updating', value)\n  }\n\n  get size(): number {\n    return this.#items.size\n  }\n\n  get range(): [number, number] {\n    const visibleHeight = this.getBoundingClientRect().height\n    const {scrollTop} = this\n    const key = `${scrollTop}-${visibleHeight}`\n    if (this.#rangeCache.has(key)) return this.#rangeCache.get(key)!\n    let rowStart = 0\n    let rowEnd = 0\n    let startHeight = 0\n    let endHeight = 0\n    const heights = this.#heights\n    for (const item of this.#items) {\n      const height = heights.get(item) || this.#assumedHeight\n      if (startHeight + height < scrollTop) {\n        startHeight += height\n        rowStart += 1\n        rowEnd += 1\n      } else if (endHeight - height < visibleHeight) {\n        endHeight += height\n        rowEnd += 1\n      } else if (endHeight >= visibleHeight) {\n        break\n      }\n    }\n    return [rowStart, rowEnd]\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null) {\n    if (oldValue === newValue || !this.isConnected) return\n    const nowEager = name === 'data-updating' && newValue === 'eager'\n    const nowSorted = name === 'data-sorted' && this.hasAttribute('data-sorted')\n    if (nowEager || nowSorted) {\n      this.update()\n    }\n  }\n\n  connectedCallback(): void {\n    // eslint-disable-next-line github/prefer-observers\n    this.addEventListener('scroll', () => this.update())\n    this.updateSync = this.updateSync.bind(this)\n  }\n\n  update(): void {\n    if (this.#animationFrameId) cancelAnimationFrame(this.#animationFrameId)\n    if (!this.#sorted && this.hasAttribute('data-sorted')) {\n      this.#animationFrameId = requestAnimationFrame(() => {\n        if (this.dispatchEvent(new CustomEvent('virtual-list-sort', {cancelable: true}))) {\n          this.sort()\n        }\n      })\n    } else {\n      this.#animationFrameId = requestAnimationFrame(this.updateSync)\n    }\n  }\n\n  private renderItem(item: V): Element {\n    const detail = {item, fragment: document.createDocumentFragment()}\n    this.dispatchEvent(new CustomEvent('virtual-list-render-item', {detail}))\n    return detail.fragment.children[0]\n  }\n\n  private recalculateHeights(value: V) {\n    const list = this.querySelector('ul, ol, tbody')\n    if (list) {\n      list.append(this.renderItem(value))\n      this.#assumedHeight = list.children[0].getBoundingClientRect().height\n      this.#heights.set(value, this.#assumedHeight)\n      list.replaceChildren()\n    }\n  }\n\n  private updateSync(): void {\n    const list = this.querySelector<HTMLElement>('ul, ol')\n    if (!list) return\n\n    const [rowStart, rowEnd] = this.range\n    if (rowEnd < rowStart) return\n    const cancelled = !this.dispatchEvent(new CustomEvent('virtual-list-update', {cancelable: true}))\n    if (cancelled) return\n    const itemsRows = new Map<V, Element>()\n    const renderCache = this.#renderCache\n    let i = -1\n    let renderEnd = true\n    let startHeight = 0\n    for (const item of this.#items) {\n      if (i === -1 && (!Number.isFinite(this.#assumedHeight) || this.#assumedHeight === 0)) {\n        // When virtual list is visually hidden, it still can accept and render data\n        // This branch handles the case when virtual list was shown after the data was rendered (with item height === 0)\n        this.recalculateHeights(item)\n      }\n      i += 1\n      if (i < rowStart) {\n        startHeight += this.#heights.get(item) || this.#assumedHeight\n        continue\n      }\n      if (i > rowEnd) {\n        renderEnd = false\n        break\n      }\n      let row = null\n      if (renderCache.has(item)) {\n        row = renderCache.get(item)!\n      } else {\n        row = this.renderItem(item)\n        if (!row) continue\n        renderCache.set(item, row)\n      }\n      itemsRows.set(item, row)\n    }\n    list.replaceChildren(...itemsRows.values())\n    list.style.paddingTop = `${startHeight}px`\n    const totalHeight = this.size * this.#assumedHeight\n    list.style.height = `${totalHeight || 0}px`\n\n    // The itemsRows list must be iterated after all rows have been rendered to get accurate heights\n    let renderedPastBottom = false\n    const scrollBottom = this.getBoundingClientRect().bottom\n    for (const [item, row] of itemsRows) {\n      const {height, bottom} = row.getBoundingClientRect()\n      renderedPastBottom = renderedPastBottom || bottom >= scrollBottom\n      this.#heights.set(item, height)\n    }\n\n    const moreItemsToRender = !renderEnd && this.size > itemsRows.size\n    if (moreItemsToRender && !renderedPastBottom) {\n      this.#rangeCache.delete(`${this.scrollTop}-${this.getBoundingClientRect().height}`)\n      return this.update()\n    }\n    this.dispatchEvent(new CustomEvent('virtual-list-updated'))\n  }\n\n  has(value: V): boolean {\n    return this.#items.has(value)\n  }\n\n  add(value: V): this {\n    this.#items.add(value)\n    this.#sorted = false\n    // If this is the first item added we need to render it to get an estimate for the row height of an entity.\n    if (!Number.isFinite(this.#assumedHeight)) {\n      this.recalculateHeights(value)\n    }\n    if (this.updating === 'eager') this.update()\n    return this\n  }\n\n  delete(value: V): boolean {\n    const ret = this.#items.delete(value)\n    this.#sorted = false\n    this.#heights.delete(value)\n    if (this.updating === 'eager') this.update()\n    return ret\n  }\n\n  clear(): void {\n    this.#items.clear()\n    this.#heights.clear()\n    // Resetting the assumedHeight attribute, as the fresh data may contain completely different items.\n    // This will lead to height recalculation for a fresh dataset.\n    // Otherwise, the size of the list container will be incorrectly estimated.\n    this.#assumedHeight = Infinity\n    this.#sorted = true\n    if (this.updating === 'eager') this.update()\n  }\n\n  forEach(callbackfn: (value: V, value2: V, set: Set<V>) => void, thisArg?: unknown): void {\n    for (const item of this) callbackfn.call(thisArg, item, item, this)\n  }\n\n  entries(): IterableIterator<[V, V]> {\n    return this.#items.entries()\n  }\n\n  values(): IterableIterator<V> {\n    return this.#items.values()\n  }\n\n  keys(): IterableIterator<V> {\n    return this.#items.keys()\n  }\n\n  [Symbol.iterator](): IterableIterator<V> {\n    return this.#items[Symbol.iterator]()\n  }\n\n  sort(compareFn?: (a: V, b: V) => number): this {\n    this.#items = new Set(Array.from(this).sort(compareFn))\n    this.#sorted = true\n    if (this.updating === 'eager') this.update()\n    return this\n  }\n}\n\ndeclare global {\n  interface Window {\n    VirtualListElement: typeof VirtualListElement\n  }\n  // @ts-fixme HTMLElement doesn't expose `Symbol.toStringTag`\n  interface HTMLElement {\n    [Symbol.toStringTag]: 'HTMLElement'\n  }\n}\n\nexport default VirtualListElement\n\nif (!window.customElements.get('virtual-list')) {\n  window.VirtualListElement = VirtualListElement\n  window.customElements.define('virtual-list', VirtualListElement)\n}\n","function isSetAlike<V>(value: unknown): value is Set<V> {\n  return Boolean(\n    value instanceof Set ||\n      (value && typeof value === 'object' && 'size' in value && 'add' in value && 'delete' in value && 'clear' in value)\n  )\n}\n\n/**\n * An input component that fetches and filters items.\n *\n * Important:\n * - Uses src attribute to fetch items.\n * - Uses `data-property` attribute to load items from the response.\n */\nclass VirtualFilterInputElement<V> extends HTMLElement {\n  #abortController?: AbortController\n  #animationFrameId = 0\n  #lastQuery: string | null = null\n  #timer?: number\n  #items: Set<V> = new Set()\n  #filtered: Set<V> | null = null\n  filter: (item: V, query: string) => boolean | null = (item, query) => String(item).includes(query)\n\n  static get observedAttributes() {\n    return ['src', 'loading', 'data-property', 'aria-owns']\n  }\n\n  get filtered(): Set<V> {\n    if (this.#filtered) return this.#filtered\n\n    if (this.hasAttribute('aria-owns')) {\n      const el = this.ownerDocument.getElementById(this.getAttribute('aria-owns') || '')\n      if (el && isSetAlike<V>(el)) {\n        this.#filtered = el\n      }\n    }\n\n    return (this.#filtered ||= new Set())\n  }\n\n  set filtered(set: Set<V>) {\n    this.#filtered = set\n  }\n\n  get input(): HTMLInputElement | HTMLTextAreaElement | null {\n    return this.querySelector<HTMLInputElement | HTMLTextAreaElement>('input, textarea')\n  }\n\n  get src(): string {\n    return this.getAttribute('src') || ''\n  }\n\n  set src(value: string) {\n    this.setAttribute('src', value)\n  }\n\n  get loading(): 'eager' | 'lazy' {\n    if (this.getAttribute('loading') === 'lazy') return 'lazy'\n    return 'eager'\n  }\n\n  set loading(value: 'eager' | 'lazy') {\n    this.setAttribute('loading', value)\n  }\n\n  get accept(): string {\n    return this.getAttribute('accept') || ''\n  }\n\n  set accept(value: string) {\n    this.setAttribute('accept', value)\n  }\n\n  get property(): string {\n    return this.getAttribute('data-property') || ''\n  }\n\n  set property(value: string) {\n    this.setAttribute('data-property', value)\n  }\n\n  reset() {\n    this.filtered.clear()\n    this.#items = new Set()\n  }\n\n  clear() {\n    if (!this.input) return\n    this.input.value = ''\n    this.input.dispatchEvent(new Event('input'))\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    const isReady = this.isConnected && this.src\n    const eager = this.loading === 'eager'\n    const isLoaderAttribute = name === 'src' || name === 'loading' || name === 'accept' || name === 'data-property'\n    const isDataSourceAttribute = name === 'src' || name === 'data-property'\n    const valueChanged = oldValue !== newValue\n\n    // Reset the lastQuery in case src or property has changed.\n    // This means that the data will be different and we don't want to preserve the same filtering query.\n    if (isDataSourceAttribute && valueChanged) {\n      this.#lastQuery = null\n      // clear the debounce timer when value and datasource has changed\n      // the new dataset will be filtered in load() method\n      if (this.#timer) clearTimeout(this.#timer)\n    }\n\n    if (isReady && eager && isLoaderAttribute && valueChanged) {\n      cancelAnimationFrame(this.#animationFrameId)\n      this.#animationFrameId = requestAnimationFrame(() => this.load())\n    } else if (name === 'aria-owns') {\n      this.#filtered = null\n    }\n  }\n\n  connectedCallback() {\n    if (this.src && this.loading === 'eager') {\n      cancelAnimationFrame(this.#animationFrameId)\n      this.#animationFrameId = requestAnimationFrame(() => this.load())\n    }\n    const input = this.input\n    if (!input) return\n\n    // Trigger aria-owns behavior which does not always trigger from attributeChangedCallback\n    const owns = this.getAttribute('aria-owns')\n    if (owns !== null) {\n      this.attributeChangedCallback('aria-owns', '', owns)\n    }\n\n    input.setAttribute('autocomplete', 'off')\n    input.setAttribute('spellcheck', 'false')\n\n    if (this.src && this.loading === 'lazy') {\n      if (document.activeElement === input) {\n        // If the input is focused, we want to load immediately\n        this.load()\n      } else {\n        // Otherwise, we want to load when the input is focused\n        input.addEventListener(\n          'focus',\n          () => {\n            this.load()\n          },\n          {once: true}\n        )\n      }\n    }\n\n    // Dispatches to `handleEvent`.\n    // See https://developer.mozilla.org/en-US/docs/Web/API/EventListener/handleEvent\n    input.addEventListener('input', this)\n  }\n\n  disconnectedCallback() {\n    this.input?.removeEventListener('input', this)\n  }\n\n  handleEvent(event: Event) {\n    if (event.type === 'input') {\n      if (this.#timer) clearTimeout(this.#timer)\n      // We try to simulate a \"sensible\" debounce, assuming that we're\n      // filtering a large number of items, we can debounce slightly longer\n      // for shallow queries\n      this.#timer = window.setTimeout(() => this.filterItems(), this.input?.value?.length || 0 < 3 ? 300 : 100)\n    }\n  }\n\n  async load() {\n    this.#abortController?.abort()\n    this.#abortController = new AbortController()\n    const {signal} = this.#abortController\n    if (!this.src) throw new Error('missing src')\n\n    // Functional stand in for the W3 spec \"queue a task\" paradigm\n    await new Promise(resolve => setTimeout(resolve, 0))\n    if (signal.aborted) return\n\n    this.dispatchEvent(new Event('loadstart'))\n\n    try {\n      const response = await this.fetch(this.request(), {signal})\n      if (location.origin + this.src !== response.url) {\n        // If the response URL does not match the src we are ignoring it.\n        return\n      }\n\n      if (!response.ok) {\n        throw new Error(`Failed to load resource: the server responded with a status of ${response.status}`)\n      }\n      this.#items = new Set((await response.json())[this.property])\n      // reset lastQuery, as the dataset has changed\n      this.#lastQuery = null\n      this.dispatchEvent(new Event('loadend'))\n    } catch (e) {\n      if (signal.aborted) {\n        this.dispatchEvent(new Event('loadend'))\n        return\n      }\n      // Dispatch `error` and `loadend` async to allow\n      // the `load()` promise to resolve _before_ these\n      // events are fired.\n      ;(async () => {\n        this.dispatchEvent(new Event('error'))\n        this.dispatchEvent(new Event('loadend'))\n      })()\n      throw e\n    }\n\n    this.filtered.clear()\n    this.filterItems()\n  }\n\n  request(): Request {\n    return new Request(this.src, {\n      method: 'GET',\n      credentials: 'same-origin',\n      headers: {\n        Accept: this.accept || 'application/json'\n      }\n    })\n  }\n\n  fetch(request: RequestInfo, init?: RequestInit): Promise<Response> {\n    return fetch(request, init)\n  }\n\n  filterItems() {\n    const query = this.input?.value.trim() ?? ''\n    const lastQuery = this.#lastQuery\n    this.#lastQuery = query\n    if (query === lastQuery) return\n    this.dispatchEvent(new CustomEvent('virtual-filter-input-filter'))\n    let items: Set<V>\n    // If the search is additive, we can filter the subset rather than the superset\n    // as we know the subset must contain all items present in the last query\n    if (lastQuery && query.includes(lastQuery)) {\n      items = this.filtered\n    } else {\n      items = this.#items\n      // If the search is not additive, we need to retain the original items order. To do that we need to repopulate the filtered set.\n      this.filtered.clear()\n    }\n    for (const item of items) {\n      if (this.filter(item, query)) {\n        this.filtered.add(item)\n      } else {\n        this.filtered.delete(item)\n      }\n    }\n    this.dispatchEvent(new CustomEvent('virtual-filter-input-filtered'))\n  }\n}\n\nexport default VirtualFilterInputElement\n\ndeclare global {\n  interface Window {\n    VirtualFilterInputElement: typeof VirtualFilterInputElement\n  }\n}\n\nif (!window.customElements.get('virtual-filter-input')) {\n  window.VirtualFilterInputElement = VirtualFilterInputElement\n  window.customElements.define('virtual-filter-input', VirtualFilterInputElement)\n}\n","function defaultPositions(query: string, text: string): number[] {\n  const positions: number[] = []\n  let lastIndex = 0\n  for (let i = 0; i < query.length; i++) {\n    const char = query[i]\n    const index = text.indexOf(char, lastIndex)\n    if (index === -1) return positions\n    lastIndex = index + 1\n    positions.push(index)\n  }\n  return positions\n}\n\nclass MarkedTextElement extends HTMLElement {\n  #lastText = ''\n  #lastQuery = ''\n  #observer: MutationObserver\n  #timer: number\n  positions?: typeof defaultPositions\n\n  static observedAttributes = ['query', 'data-owner-input']\n\n  get query(): string {\n    if (this.ownerInput) return this.ownerInput.value\n    return this.getAttribute('query') || ''\n  }\n\n  set query(query: string) {\n    this.setAttribute('query', query)\n  }\n\n  get ownerInput(): HTMLInputElement | null {\n    const el = this.ownerDocument.getElementById(this.getAttribute('data-owner-input') || '')\n    return el instanceof HTMLInputElement ? el : null\n  }\n\n  connectedCallback(): void {\n    this.handleEvent()\n    this.ownerInput?.addEventListener('input', this)\n    this.#observer = new MutationObserver(() => this.handleEvent())\n  }\n\n  handleEvent(): void {\n    if (this.#timer) cancelAnimationFrame(this.#timer)\n    this.#timer = requestAnimationFrame(() => this.mark())\n  }\n\n  disconnectedCallback(): void {\n    this.ownerInput?.removeEventListener('input', this)\n    this.#observer.disconnect()\n  }\n\n  mark() {\n    const text = this.textContent || ''\n    const query = this.query\n    if (text === this.#lastText && query === this.#lastQuery) return\n    this.#lastText = text\n    this.#lastQuery = query\n    this.#observer.disconnect()\n    let lastPosition = 0\n    const frag = document.createDocumentFragment()\n    for (const i of (this.positions || defaultPositions)(query, text)) {\n      if (Number(i) !== i || i < lastPosition || i > text.length) continue\n      const slice = text.slice(lastPosition, i)\n      if (slice !== '') {\n        frag.appendChild(document.createTextNode(text.slice(lastPosition, i)))\n      }\n      lastPosition = i + 1\n      const mark = document.createElement('mark')\n      mark.textContent = text[i]\n      frag.appendChild(mark)\n    }\n    frag.appendChild(document.createTextNode(text.slice(lastPosition)))\n    this.replaceChildren(frag)\n    this.#observer.observe(this, {\n      attributes: true,\n      childList: true,\n      subtree: true\n    })\n  }\n}\n\ndeclare global {\n  interface Window {\n    MarkedTextElement: typeof MarkedTextElement\n  }\n}\n\nexport default MarkedTextElement\n\nif (!window.customElements.get('marked-text')) {\n  window.MarkedTextElement = MarkedTextElement\n  window.customElements.define('marked-text', MarkedTextElement)\n}\n","import {controller, target, targets} from '@github/catalyst'\n\n@controller\nclass GitCloneHelpElement extends HTMLElement {\n  @target helpField: HTMLInputElement\n  @targets helpTexts: HTMLElement[]\n  @targets cloneURLButtons: HTMLElement[]\n\n  updateURL(event: Event) {\n    const switcher = event.currentTarget as HTMLElement\n\n    const url = switcher.getAttribute('data-url') || ''\n\n    this.helpField.value = url\n\n    if (switcher.matches('.js-git-protocol-clone-url')) {\n      for (const el of this.helpTexts) {\n        el.textContent = url\n      }\n    }\n\n    for (const button of this.cloneURLButtons) {\n      button.classList.remove('selected')\n    }\n    switcher.classList.add('selected')\n  }\n}\n","import {validate} from './behaviors/html-validation'\n\ninterface PasswordOptions {\n  minimumCharacterCount: number\n  passphraseLength: number\n}\n\ninterface Result {\n  valid: boolean\n  hasMinimumCharacterCount: boolean\n  hasMinimumPassphraseLength: boolean\n  hasLowerCase: boolean\n  hasNumber: boolean\n}\n\nclass PasswordStrengthElement extends HTMLElement {\n  connectedCallback() {\n    this.addEventListener('input', onInput)\n  }\n\n  disconnectedCallback() {\n    this.removeEventListener('input', onInput)\n  }\n}\n\nif (!window.customElements.get('password-strength')) {\n  window.PasswordStrengthElement = PasswordStrengthElement\n  window.customElements.define('password-strength', PasswordStrengthElement)\n}\n\ndeclare global {\n  interface Window {\n    PasswordStrengthElement: typeof PasswordStrengthElement\n  }\n}\n\nfunction onInput(event: Event) {\n  const passwordStrength = event.currentTarget\n  if (!(passwordStrength instanceof PasswordStrengthElement)) return\n  const passwordInput = event.target\n  if (!(passwordInput instanceof HTMLInputElement)) return\n  const form = passwordInput.form\n  if (!(form instanceof HTMLFormElement)) return\n\n  const result = validatePassword(passwordInput.value, {\n    minimumCharacterCount: Number(passwordStrength.getAttribute('minimum-character-count')),\n    passphraseLength: Number(passwordStrength.getAttribute('passphrase-length'))\n  })\n\n  if (result.valid) {\n    passwordInput.setCustomValidity('')\n    const errorHint = passwordStrength.querySelector('dl.form-group')\n    if (errorHint) {\n      errorHint.classList.remove('errored')\n      errorHint.classList.add('successed')\n    }\n  } else {\n    passwordInput.setCustomValidity(passwordStrength.getAttribute('invalid-message') || 'Invalid')\n  }\n\n  highlightPasswordStrengthExplainer(passwordStrength, result)\n  validate(form)\n}\n\nfunction validatePassword(password: string, options: PasswordOptions): Result {\n  const result = {\n    valid: false,\n    hasMinimumCharacterCount: password.length >= options.minimumCharacterCount,\n    hasMinimumPassphraseLength: options.passphraseLength !== 0 && password.length >= options.passphraseLength,\n    hasLowerCase: /[a-z]/.test(password),\n    hasNumber: /\\d/.test(password)\n  }\n  result.valid =\n    result.hasMinimumPassphraseLength || (result.hasMinimumCharacterCount && result.hasLowerCase && result.hasNumber)\n  return result\n}\n\nfunction highlightPasswordStrengthExplainer(element: HTMLElement, result: Result) {\n  const moreThanNCharactersEl = element.querySelector('[data-more-than-n-chars]')\n  const minCharsEl = element.querySelector<HTMLElement>('[data-min-chars]')!\n  const numberReqEl = element.querySelector<HTMLElement>('[data-number-requirement]')!\n  const letterReqEl = element.querySelector<HTMLElement>('[data-letter-requirement]')!\n  const errorClasses =\n    element\n      .getAttribute('error-class')\n      ?.split(' ')\n      .filter(t => t.length > 0) || []\n  const passClasses =\n    element\n      .getAttribute('pass-class')\n      ?.split(' ')\n      .filter(t => t.length > 0) || []\n\n  for (const part of [moreThanNCharactersEl, minCharsEl, numberReqEl, letterReqEl]) {\n    part?.classList.remove(...errorClasses, ...passClasses)\n  }\n\n  if (result.hasMinimumPassphraseLength && moreThanNCharactersEl) {\n    moreThanNCharactersEl.classList.add(...passClasses)\n  } else if (result.valid) {\n    minCharsEl.classList.add(...passClasses)\n    numberReqEl.classList.add(...passClasses)\n    letterReqEl.classList.add(...passClasses)\n  } else {\n    const charTextClasses = result.hasMinimumCharacterCount ? passClasses : errorClasses\n    const numberTextClasses = result.hasNumber ? passClasses : errorClasses\n    const caseTextClasses = result.hasLowerCase ? passClasses : errorClasses\n\n    moreThanNCharactersEl?.classList.add(...errorClasses)\n    minCharsEl.classList.add(...charTextClasses)\n    numberReqEl.classList.add(...numberTextClasses)\n    letterReqEl.classList.add(...caseTextClasses)\n  }\n}\n","/* eslint eslint-comments/no-use: off */\n\nimport './include-fragment-element-hacks'\nimport IncludeFragmentElement from '@github/include-fragment-element'\n\nclass PollIncludeFragmentElement extends IncludeFragmentElement {\n  async fetch(request: Request, ms = 1000): Promise<Response> {\n    const response = await super.fetch(request)\n\n    if (response.status === 202) {\n      await new Promise(resolve => setTimeout(resolve, ms))\n      return this.fetch(request, ms * 1.5)\n    } else {\n      return response\n    }\n  }\n}\n\nif (!window.customElements.get('poll-include-fragment')) {\n  window.PollIncludeFragmentElement = PollIncludeFragmentElement\n  window.customElements.define('poll-include-fragment', PollIncludeFragmentElement)\n}\n\ndeclare global {\n  interface Window {\n    PollIncludeFragmentElement: typeof PollIncludeFragmentElement\n  }\n}\n","import {RelativeTimeElement} from '@github/time-elements'\n\n// <precise-time-ago> generates an always relative time-ago with short\n// descriptions like \"1h 15m 30s.\" It updates every second, which is useful for\n// showing elapsed times when precision is important, like for CI. For better\n// performance, prefer <time-ago format=\"micro\"> when precision to the second\n// is not needed.\n//\n// Example usage:\n// <precise-time-ago datetime=\"2012-04-01T16:30:00-08:00\"></precise-time-ago>\n\nclass PreciseTimeAgoElement extends RelativeTimeElement {\n  // Adapted from https://git.io/fjloW to update every second\n  connectedCallback() {\n    nowElements.push(this)\n\n    if (!updateNowElementsId) {\n      updateNowElements()\n      updateNowElementsId = window.setInterval(updateNowElements, 1000)\n    }\n  }\n\n  // Copied from https://git.io/fjlAl to access module-scoped variables\n  disconnectedCallback() {\n    const ix = nowElements.indexOf(this)\n    if (ix !== -1) {\n      nowElements.splice(ix, 1)\n    }\n\n    if (!nowElements.length) {\n      window.clearInterval(updateNowElementsId)\n      updateNowElementsId = undefined\n    }\n  }\n\n  getFormattedDate() {\n    const timeAgoDate = this.date\n    if (!timeAgoDate) return\n\n    const ms = new Date().getTime() - timeAgoDate.getTime()\n    const sec = Math.floor(ms / 1000)\n    const min = Math.floor(sec / 60)\n    const hr = Math.floor(min / 60)\n    const day = Math.floor(hr / 24)\n\n    const remainderSec = sec - min * 60\n    const remainderMin = min - hr * 60\n    const remainderHr = hr - day * 24\n\n    if (min < 1) {\n      return this.applyPrecision([`${sec}s`])\n    } else if (hr < 1) {\n      return this.applyPrecision([`${min}m`, `${remainderSec}s`])\n    } else if (day < 1) {\n      return this.applyPrecision([`${hr}h`, `${remainderMin}m`, `${remainderSec}s`])\n    } else {\n      return this.applyPrecision([`${day}d`, `${remainderHr}h`, `${remainderMin}m`, `${remainderSec}s`])\n    }\n  }\n\n  applyPrecision(units: string[]) {\n    const precision = Number(this.getAttribute('data-precision') || units.length)\n    return units.slice(0, precision).join(' ')\n  }\n}\n\n// https://git.io/fjlo4.\nconst nowElements: PreciseTimeAgoElement[] = []\n\n// https://git.io/fjloB.\nlet updateNowElementsId: number | undefined\n\n// https://git.io/fjloR\nfunction updateNowElements() {\n  for (const element of nowElements) {\n    element.textContent = element.getFormattedDate() || ''\n  }\n}\n\nif (!window.customElements.get('precise-time-ago')) {\n  window.PreciseTimeAgoElement = PreciseTimeAgoElement\n  window.customElements.define('precise-time-ago', PreciseTimeAgoElement)\n}\n\ndeclare global {\n  interface Window {\n    PreciseTimeAgoElement: typeof PreciseTimeAgoElement\n  }\n}\n","/*\nThis was pulled in from github/text-expander-element to make iterating and testing easier.\nSee https://github.com/github/ui-platform/issues/88\n*/\ntype Keyword = {\n  word: string\n  position: number\n  beginningOfLine: boolean\n}\n\nconst boundary = /\\s|\\(|\\[/\n\n// Extracts a keyword from the source text, backtracking from the cursor position.\nexport default function keyword(text: string, key: string, cursor: number): Keyword | void {\n  // Activation key not found in front of the cursor.\n  const keyIndex = text.lastIndexOf(key, cursor - 1)\n  if (keyIndex === -1) return\n\n  // Space between the cursor and previous activation key.\n  const spaceIndex = text.lastIndexOf(' ', cursor - 1)\n  if (spaceIndex > keyIndex) return\n\n  // Activation key must occur at word boundary.\n  const pre = text[keyIndex - 1]\n  if (pre && !boundary.test(pre)) return\n\n  // Extract matched keyword.\n  const word = text.substring(keyIndex + key.length, cursor)\n  return {word, position: keyIndex + key.length, beginningOfLine: isBeginningOfLine(pre)}\n}\n\nconst isBeginningOfLine = (character: string): boolean => {\n  // When slash is the first character in the text area, the previous character is undefined\n  return character === undefined || /\\n/.test(character)\n}\n","/*\nThis was pulled in from github/text-expander-element to make iterating and testing easier.\nSee https://github.com/github/ui-platform/issues/88\n*/\nconst properties = ['position:absolute;', 'overflow:auto;', 'word-wrap:break-word;', 'top:0px;', 'left:-9999px;']\n\n// Copy CSS properties from text field to div that would affect the cursor position.\nconst propertyNamesToCopy = [\n  'box-sizing',\n  'font-family',\n  'font-size',\n  'font-style',\n  'font-variant',\n  'font-weight',\n  'height',\n  'letter-spacing',\n  'line-height',\n  'max-height',\n  'min-height',\n  'padding-bottom',\n  'padding-left',\n  'padding-right',\n  'padding-top',\n  'border-bottom',\n  'border-left',\n  'border-right',\n  'border-top',\n  'text-decoration',\n  'text-indent',\n  'text-transform',\n  'width',\n  'word-spacing'\n]\n\n// Map from text field element to its mirror.\nconst mirrorMap = new WeakMap()\n\n// Builds offscreen div that mirrors the text field.\n//\n// textField - A HTMLInputElement or HTMLTextAreaElement element\n// markerPosition - Optional Number to position a cursor marker at\n//                  (defaults to the end of the text)\n//\n// Returns an Element attached to the DOM. It is the callers\n// responsibility to cleanup and remove the element after they are\n// finished with their measurements.\nexport default function textFieldMirror(\n  textField: HTMLInputElement | HTMLTextAreaElement,\n  markerPosition: number | null\n): {mirror: HTMLElement; marker: HTMLElement} {\n  const nodeName = textField.nodeName.toLowerCase()\n  if (nodeName !== 'textarea' && nodeName !== 'input') {\n    throw new Error('expected textField to a textarea or input')\n  }\n\n  let mirror = mirrorMap.get(textField)\n  if (mirror && mirror.parentElement === textField.parentElement) {\n    mirror.innerHTML = ''\n  } else {\n    mirror = document.createElement('div')\n    mirrorMap.set(textField, mirror)\n    const style = window.getComputedStyle(textField)\n    const props = properties.slice(0)\n    if (nodeName === 'textarea') {\n      props.push('white-space:pre-wrap;')\n    } else {\n      props.push('white-space:nowrap;')\n    }\n    for (let i = 0, len = propertyNamesToCopy.length; i < len; i++) {\n      const name = propertyNamesToCopy[i]\n      props.push(`${name}:${style.getPropertyValue(name)};`)\n    }\n    mirror.style.cssText = props.join(' ')\n  }\n\n  const marker = document.createElement('span')\n  marker.style.cssText = 'position: absolute;'\n  marker.innerHTML = '&nbsp;'\n\n  let before\n  let after\n  if (typeof markerPosition === 'number') {\n    let text = textField.value.substring(0, markerPosition)\n    if (text) {\n      before = document.createTextNode(text)\n    }\n    text = textField.value.substring(markerPosition)\n    if (text) {\n      after = document.createTextNode(text)\n    }\n  } else {\n    const text = textField.value\n    if (text) {\n      before = document.createTextNode(text)\n    }\n  }\n\n  if (before) {\n    mirror.appendChild(before)\n  }\n\n  mirror.appendChild(marker)\n\n  if (after) {\n    mirror.appendChild(after)\n  }\n\n  if (!mirror.parentElement) {\n    if (!textField.parentElement) {\n      throw new Error('textField must have a parentElement to mirror')\n    }\n    textField.parentElement.insertBefore(mirror, textField)\n  }\n\n  mirror.scrollTop = textField.scrollTop\n  mirror.scrollLeft = textField.scrollLeft\n\n  return {mirror, marker}\n}\n","/*\nThis was pulled in from github/text-expander-element to make iterating and testing easier.\nSee https://github.com/github/ui-platform/issues/88\n*/\nimport textFieldMirror from './text-field-mirror'\n\n// Get offset position of cursor in a `textField` field. The offset is the\n// number of pixels from the top left of the `textField`. Useful for\n// positioning a popup near the insertion point.\n//\n// const {top, left} = textFieldSelectionPosition(textarea)\n//\n// Measures offset position of cursor in text field.\n//\n// field - A HTMLTextAreaElement or HTMLInputElement\n// index - Number index into textField.value (default: textField.selectionEnd)\n//\n// Returns object with {top, left} properties.\nexport default function textFieldSelectionPosition(\n  field: HTMLInputElement | HTMLTextAreaElement,\n  index: number | null = field.selectionEnd\n): {top: number; left: number} {\n  const {mirror, marker} = textFieldMirror(field, index)\n\n  const mirrorRect = mirror.getBoundingClientRect()\n  const markerRect = marker.getBoundingClientRect()\n\n  setTimeout(() => {\n    mirror.remove()\n  }, 5000)\n\n  return {\n    top: markerRect.top - mirrorRect.top,\n    left: markerRect.left - mirrorRect.left\n  }\n}\n","/*\nThis was pulled in from github/text-expander-element to make iterating and testing easier.\nSee https://github.com/github/ui-platform/issues/88\n*/\nimport Combobox from '@github/combobox-nav'\nimport keyword from './keyword'\nimport textFieldSelectionPosition from './text-field-selection-position'\n\ntype Match = {\n  text: string\n  key: string\n  position: number\n  beginningOfLine: boolean\n}\n\ntype Result = {\n  fragment: HTMLElement\n  matched: boolean\n}\n\nconst states = new WeakMap()\n\nclass SlashCommandExpander {\n  expander: SlashCommandExpanderElement\n  input: HTMLInputElement | HTMLTextAreaElement\n  menu: HTMLElement | null\n  oninput: (event: Event) => void\n  onkeydown: (event: KeyboardEvent) => void\n  onpaste: (event: Event) => void\n  oncommit: (event: Event) => void\n  onblur: (event: Event) => void\n  onmousedown: (event: Event) => void\n  combobox: Combobox | null\n  match: Match | null\n  justPasted: boolean\n  interactingWithMenu: boolean\n\n  constructor(expander: SlashCommandExpanderElement, input: HTMLInputElement | HTMLTextAreaElement) {\n    this.expander = expander\n    this.input = input\n    this.combobox = null\n    this.menu = null\n    this.match = null\n    this.justPasted = false\n    this.oninput = this.onInput.bind(this)\n    this.onpaste = this.onPaste.bind(this)\n    this.onkeydown = this.onKeydown.bind(this)\n    this.oncommit = this.onCommit.bind(this)\n    this.onmousedown = this.onMousedown.bind(this)\n    this.onblur = this.onBlur.bind(this)\n    this.interactingWithMenu = false\n    input.addEventListener('paste', this.onpaste)\n    input.addEventListener('input', this.oninput)\n    ;(input as HTMLElement).addEventListener('keydown', this.onkeydown)\n    input.addEventListener('blur', this.onblur)\n  }\n\n  destroy() {\n    this.input.removeEventListener('paste', this.onpaste)\n    this.input.removeEventListener('input', this.oninput)\n    ;(this.input as HTMLElement).removeEventListener('keydown', this.onkeydown)\n    this.input.removeEventListener('blur', this.onblur)\n  }\n\n  activate(match: Match, menu: HTMLElement) {\n    if (this.input !== document.activeElement) return\n    this.setMenu(match, menu)\n  }\n\n  deactivate(): boolean {\n    const menu = this.menu\n    const combobox = this.combobox\n    if (!menu || !combobox) return false\n    this.menu = null\n    this.combobox = null\n\n    menu.removeEventListener('combobox-commit', this.oncommit)\n    menu.removeEventListener('mousedown', this.onmousedown)\n    combobox.destroy()\n    menu.remove()\n\n    return true\n  }\n\n  setMenu(match: Match, menu: HTMLElement) {\n    this.deactivate()\n    this.menu = menu\n\n    if (!menu.id) menu.id = `text-expander-${Math.floor(Math.random() * 100000).toString()}`\n    this.expander.append(menu)\n\n    const menuItems = menu.querySelector<HTMLElement>('.js-slash-command-menu-items')\n\n    if (menuItems) {\n      this.combobox = new Combobox(this.input, menuItems)\n    } else {\n      this.combobox = new Combobox(this.input, menu)\n    }\n\n    const {top, left} = textFieldSelectionPosition(this.input, match.position)\n    const topMargin = parseInt(window.getComputedStyle(this.input).fontSize)\n\n    menu.style.top = `${top + topMargin}px`\n    menu.style.left = `${left}px`\n\n    this.combobox.start()\n    menu.addEventListener('combobox-commit', this.oncommit)\n    menu.addEventListener('mousedown', this.onmousedown)\n\n    // Focus first menu item.\n    this.combobox.navigate(1)\n  }\n\n  setValue(value: string | null) {\n    if (value === null || value === undefined) return\n\n    const match = this.match\n    if (!match) return\n\n    const beginning = this.input.value.substring(0, match.position - match.key.length)\n    const remaining = this.input.value.substring(match.position + match.text.length)\n\n    let {cursor, value: insertValue} = this.replaceCursorMark(value)\n    insertValue = insertValue?.length === 0 ? insertValue : `${insertValue} `\n\n    this.input.value = beginning + insertValue + remaining\n\n    this.deactivate()\n    this.input.focus()\n\n    cursor = beginning.length + (cursor || insertValue.length)\n    this.input.selectionStart = cursor\n    this.input.selectionEnd = cursor\n  }\n\n  // Take a value and replace occurrences of %cursor%.\n  //\n  // Returns object with two keys:\n  // - cursor: holds index of cursor mark location\n  // - value: Given value with the cursor marks removed.\n  replaceCursorMark(value: string) {\n    const cursorPattern = /%cursor%/gm\n\n    const cursorFlagMatch = cursorPattern.exec(value)\n    if (cursorFlagMatch) {\n      return {\n        cursor: cursorFlagMatch.index,\n        value: value.replace(cursorPattern, '')\n      }\n    } else {\n      return {\n        cursor: null,\n        value\n      }\n    }\n  }\n\n  onCommit({target}: Event) {\n    const item = target\n    if (!(item instanceof HTMLElement)) return\n    if (!this.combobox) return\n\n    const match = this.match\n    if (!match) return\n\n    const detail = {item, key: match.key, value: null}\n    const canceled = !this.expander.dispatchEvent(new CustomEvent('text-expander-value', {cancelable: true, detail}))\n\n    if (canceled) return\n    if (detail.value) this.setValue(detail.value)\n  }\n\n  onBlur() {\n    if (this.interactingWithMenu) {\n      this.interactingWithMenu = false\n      return\n    }\n\n    this.deactivate()\n  }\n\n  onPaste() {\n    this.justPasted = true\n  }\n\n  async delay(milliseconds: number) {\n    return new Promise(resolve => setTimeout(resolve, milliseconds))\n  }\n\n  async onInput() {\n    if (this.justPasted) {\n      this.justPasted = false\n      return\n    }\n\n    const match = this.findMatch()\n    if (match) {\n      this.match = match\n      await this.delay(this.appropriateDelay(this.match))\n\n      // Text was changed while waiting for delay\n      if (this.match !== match) return\n      const menu = await this.notifyProviders(match)\n\n      // Text was cleared while waiting on async providers.\n      if (!this.match) return\n\n      if (menu) {\n        this.activate(match, menu)\n      } else {\n        this.deactivate()\n      }\n    } else {\n      this.match = null\n      this.deactivate()\n    }\n  }\n\n  // How long should we wait before displaying the slash command menu?\n  appropriateDelay(match: Match): number {\n    if (match.beginningOfLine) {\n      return 0\n    } else if (match.text !== '') {\n      return 0\n    } else {\n      // When something is typing at 50 WPM, they won't see the prompt.\n      // 50 WPM = 250 CPM = 4 characters per second\n      // 1000ms / 4 = 250ms per character\n      return 250\n    }\n  }\n\n  findMatch(): Match | void {\n    const cursor = this.input.selectionEnd\n    const text = this.input.value\n    for (const key of this.expander.keys) {\n      const found = keyword(text, key, cursor!)\n      if (found) {\n        return {text: found.word, key, position: found.position, beginningOfLine: found.beginningOfLine}\n      }\n    }\n  }\n\n  async notifyProviders(match: Match): Promise<HTMLElement | void> {\n    const providers: Array<Promise<Result> | Result> = []\n    const provide = (result: Promise<Result> | Result) => providers.push(result)\n    const canceled = !this.expander.dispatchEvent(\n      new CustomEvent('text-expander-change', {cancelable: true, detail: {provide, text: match.text, key: match.key}})\n    )\n    if (canceled) return\n\n    const all = await Promise.all(providers)\n    const fragments = all.filter(x => x.matched).map(x => x.fragment)\n    return fragments[0]\n  }\n\n  onMousedown() {\n    this.interactingWithMenu = true\n  }\n\n  onKeydown(event: KeyboardEvent) {\n    // TODO: Refactor to use data-hotkey\n    /* eslint eslint-comments/no-use: off */\n    /* eslint-disable no-restricted-syntax */\n    if (event.key !== 'Escape') return\n    if (this.deactivate()) {\n      event.stopImmediatePropagation()\n      event.preventDefault()\n    }\n    /* eslint-enable no-restricted-syntax */\n  }\n}\n\nexport default class SlashCommandExpanderElement extends HTMLElement {\n  get keys(): string[] {\n    const keys = this.getAttribute('keys')\n    return keys ? keys.split(' ') : []\n  }\n\n  connectedCallback() {\n    /* eslint-disable-next-line custom-elements/no-dom-traversal-in-connectedcallback */\n    const input = this.querySelector('input[type=\"text\"], textarea')\n    if (!(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement)) return\n    const state = new SlashCommandExpander(this, input)\n    states.set(this, state)\n  }\n\n  disconnectedCallback() {\n    const state = states.get(this)\n    if (!state) return\n    state.destroy()\n    states.delete(this)\n  }\n\n  setValue(value: string) {\n    const state = states.get(this)\n    if (!state) return\n    state.setValue(value)\n  }\n\n  setMenu(menu: HTMLElement, interactionExpected = false) {\n    const state = states.get(this)\n    if (!state) return\n    if (!state.match) return\n    if (interactionExpected) {\n      state.interactingWithMenu = true\n    }\n    state.setMenu(state.match, menu)\n  }\n\n  closeMenu() {\n    const state = states.get(this)\n    if (!state) return\n    state.setValue('')\n  }\n\n  isLoading() {\n    const loadingMenu = this.getElementsByClassName('js-slash-command-expander-loading')[0] as HTMLElement\n\n    if (loadingMenu) {\n      const loadingMenuClone = loadingMenu.cloneNode(true) as HTMLElement\n      // eslint-disable-next-line github/no-d-none\n      loadingMenuClone.classList.remove('d-none')\n      this.setMenu(loadingMenuClone)\n    }\n  }\n\n  showError() {\n    const errorMenu = this.getElementsByClassName('js-slash-command-expander-error')[0] as HTMLElement\n\n    if (errorMenu) {\n      const errorMenuClone = errorMenu.cloneNode(true) as HTMLElement\n      // eslint-disable-next-line github/no-d-none\n      errorMenuClone.classList.remove('d-none')\n      this.setMenu(errorMenuClone)\n    }\n  }\n}\n","/*\nThis was pulled in from github/text-expander-element to make iterating and testing easier.\nSee https://github.com/github/ui-platform/issues/88\n*/\n\nimport SlashCommandExpanderElement from './slash-command-expander-element'\nexport {SlashCommandExpanderElement as default}\n\ndeclare global {\n  interface Window {\n    SlashCommandExpanderElement: typeof SlashCommandExpanderElement\n  }\n}\n\nif (!window.customElements.get('slash-command-expander')) {\n  window.SlashCommandExpanderElement = SlashCommandExpanderElement\n  window.customElements.define('slash-command-expander', SlashCommandExpanderElement)\n}\n","// Global handler for AJAX loading indicators.\n//\n// Only enabled on new style `data-remote` requests.\n//\n// Examples\n//\n//   .loading-spinner { display: none; }\n//   form.loading .loading-spinner { display: block; }\n//\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('deprecatedAjaxSend', '[data-remote]', function (event) {\n  if (event.currentTarget !== event.target) {\n    return\n  }\n  if (event.defaultPrevented) {\n    return\n  }\n  event.currentTarget.classList.add('loading')\n})\n\n// Clear any errors when the request is tried again\non('deprecatedAjaxComplete', '[data-remote]', function (event) {\n  if (event.currentTarget !== event.target) {\n    return\n  }\n  event.currentTarget.classList.remove('loading')\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\n\n// Dashboard event stream ajax pagination\nremoteForm('form.js-ajax-pagination, .js-ajax-pagination form', async function (form, wants) {\n  const container = form.closest<HTMLElement>('.js-ajax-pagination')!\n  let response\n  try {\n    response = await wants.html()\n  } catch (err) {\n    if (err.response && err.response.status === 404) {\n      container.remove()\n      return\n    } else {\n      throw err\n    }\n  }\n  container.replaceWith(response.html)\n  fire(form, 'page:loaded')\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {sendEvent} from '../hydro-analytics'\n\nconst GENERIC_CLICK_EVENT_NAME = 'analytics.click'\n\non('click', '[data-analytics-event]', event => {\n  const element = event.currentTarget\n\n  const analyticsEvent = element.getAttribute('data-analytics-event')\n  if (!analyticsEvent) return\n\n  const analyticsEventAttributes = JSON.parse(analyticsEvent)\n\n  sendEvent(GENERIC_CLICK_EVENT_NAME, analyticsEventAttributes)\n})\n","import {announce} from '../aria-live'\n\ndocument.addEventListener('pjax:start', function () {\n  // eslint-disable-next-line i18n-text/no-en\n  announce('Loading page')\n})\n\ndocument.addEventListener('pjax:error', function () {\n  // eslint-disable-next-line i18n-text/no-en\n  announce('Loading failed')\n})\n\ndocument.addEventListener('pjax:end', function () {\n  // eslint-disable-next-line i18n-text/no-en\n  announce('Loading complete')\n})\n","// Common behaviors associated with <auto-check>\n\nimport {announceFromElement} from '../aria-live'\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {validate} from '../behaviors/html-validation'\n\nconst notes = new WeakMap()\n\nobserve('auto-check', function (el) {\n  if (el.classList.contains('js-prevent-default-behavior')) return\n\n  const input = el.querySelector('input')\n  if (!input) return\n\n  const container = input.closest('.form-group') || el\n  const form = input.form\n\n  let id: string | null\n  function generateId() {\n    if (!id) id = `input-check-${(Math.random() * 10000).toFixed(0)}`\n    return id\n  }\n  const ariaDescribedby = input.getAttribute('aria-describedby')\n\n  input.addEventListener('focusout:delay', () => {\n    input.setAttribute('aria-describedby', [id, ariaDescribedby].join(' '))\n  })\n\n  const note = container.querySelector('p.note')\n  if (note) {\n    if (!note.id) note.id = generateId()\n    notes.set(note, note.innerHTML)\n  }\n\n  el.addEventListener('loadstart', () => {\n    reset(input, container)\n    container.classList.add('is-loading')\n    input.classList.add('is-autocheck-loading')\n\n    validate(form!)\n  })\n\n  el.addEventListener('loadend', () => {\n    container.classList.remove('is-loading')\n    input.classList.remove('is-autocheck-loading')\n  })\n\n  input.addEventListener('auto-check-success', async (event: Event) => {\n    input.classList.add('is-autocheck-successful')\n    container.classList.add('successed')\n\n    validate(form!)\n\n    const {response} = (event as CustomEvent).detail\n    if (!response) return\n\n    const message = await response.text()\n    if (!message) return\n\n    if (note instanceof HTMLElement) {\n      note.innerHTML = message\n      announceFromElement(note)\n    } else {\n      const isOk = response.status === 200\n      const tagName = container.tagName === 'DL' ? 'dd' : 'div'\n      const element = document.createElement(tagName)\n      element.id = generateId()\n      element.classList.add(isOk ? 'success' : 'warning')\n      element.innerHTML = message\n      container.append(element)\n      container.classList.add(isOk ? 'successed' : 'warn')\n      announceFromElement(element)\n      if (isOk) element.hidden = document.activeElement !== input\n    }\n\n    fire(input, 'auto-check-message-updated')\n  })\n\n  input.addEventListener('auto-check-error', async event => {\n    input.classList.add('is-autocheck-errored')\n    container.classList.add('errored')\n\n    validate(form!)\n\n    const {response} = (event as CustomEvent).detail\n    if (!response) return\n\n    const message = await response.text()\n\n    if (note instanceof HTMLElement) {\n      // eslint-disable-next-line i18n-text/no-en\n      note.innerHTML = message || 'Something went wrong'\n      announceFromElement(note)\n    } else {\n      const tagName = container.tagName === 'DL' ? 'dd' : 'div'\n      const error = document.createElement(tagName)\n      error.id = generateId()\n      error.classList.add('error')\n      // eslint-disable-next-line i18n-text/no-en\n      error.innerHTML = message || 'Something went wrong'\n      container.append(error)\n      announceFromElement(error)\n    }\n  })\n\n  input.addEventListener('input', () => {\n    input.removeAttribute('aria-describedby')\n    if (!input.value) reset(input, container)\n  })\n\n  input.addEventListener('blur', () => {\n    const successMessage = container.querySelector<HTMLElement>('.success')\n    if (successMessage) successMessage.hidden = true\n  })\n\n  input.addEventListener('focus', () => {\n    const successMessage = container.querySelector<HTMLElement>('.success')\n    if (successMessage) successMessage.hidden = false\n  })\n\n  form!.addEventListener('reset', () => {\n    reset(input, container)\n  })\n})\n\n// Reset the autocheck state.\nfunction reset(input: HTMLInputElement, container: Element) {\n  container.classList.remove('is-loading', 'successed', 'errored', 'warn')\n  input.classList.remove('is-autocheck-loading', 'is-autocheck-successful', 'is-autocheck-errored')\n\n  const note = container.querySelector('p.note')\n  if (note) {\n    const content = notes.get(note)\n    if (content) note.innerHTML = content\n  }\n\n  if (container.tagName === 'DL') {\n    container.querySelector('dd.error')?.remove()\n    container.querySelector('dd.warning')?.remove()\n    container.querySelector('dd.success')?.remove()\n  } else {\n    container.querySelector('div.error')?.remove()\n    container.querySelector('div.warning')?.remove()\n    container.querySelector('div.success')?.remove()\n  }\n}\n","// Common behaviors associated with <auto-complete>\n\nimport AutocompleteElement from '@github/auto-complete-element'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Display spinner during query server fetch.\nobserve('auto-complete', function (el) {\n  el.addEventListener('loadstart', () => el.classList.add('is-auto-complete-loading'))\n  el.addEventListener('loadend', () => el.classList.remove('is-auto-complete-loading'))\n})\n\nobserve('auto-complete', {constructor: AutocompleteElement, initialize: toggleSubmitButton})\n\non('auto-complete-change', 'auto-complete', function (event) {\n  toggleSubmitButton(event.currentTarget as AutocompleteElement)\n})\n\n// TODO Upstream `required` attribute to <auto-complete> so it can\n// participate in data-disable-invalid form validation.\n//\n// Toggle the submit button disabled/enabled based on the completer.\nfunction toggleSubmitButton(completer: AutocompleteElement) {\n  const form = completer.closest('form')\n  if (!form) return\n  const button = form.querySelector('.js-auto-complete-button')\n  if (!(button instanceof HTMLButtonElement)) return\n  button.disabled = !completer.value\n}\n","// Autosearch form\n//\n// Automatically replaces the contents of a container against a search field\n// in the search form.\n//\n// Note: Using `data-throttled-autosubmit` means that the form will autosubmit\n// on input with a bit of throttle so that we don't send unnessesary requests\n// to the server. See `app/assets/modules/github/behaviors/autosubmit.js`.\n//\n// Markup:\n//\n// `data-autosearch-results-container` - The ID of the container to update with results\n//\n// <form action=\"/search\" data-autosearch-results-container=\"search-results\">\n//   <input type=\"search\" placeholder=\"Find something\" data-throttled-autosubmit>\n//   <div id=\"search-results\">\n//     This content will get replaced when the input changes\n//   </div>\n// </form>\n//\nimport {combineGetFormSearchParams} from '../form'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {parseHTML} from '../parse-html'\nimport {replaceState} from '../history'\n\nlet previousController: AbortController | null = null\non('submit', '[data-autosearch-results-container]', async function (event) {\n  const form = event.currentTarget\n  if (!(form instanceof HTMLFormElement)) return\n  event.preventDefault()\n\n  previousController?.abort()\n  form.classList.add('is-sending')\n  const url = new URL(form.action, window.location.origin)\n  const method = form.method\n  const formData = new FormData(form)\n  const serialized = combineGetFormSearchParams(url, formData)\n  let body = null\n  if (method === 'get') {\n    url.search = serialized\n  } else {\n    body = formData\n  }\n  const {signal} = (previousController = new AbortController())\n  const request = new Request(url.toString(), {\n    method,\n    body,\n    signal,\n    headers: {Accept: 'text/html', 'X-Requested-With': 'XMLHttpRequest'}\n  })\n  let response\n  try {\n    response = await fetch(request)\n  } catch {\n    // Ignore network errors\n  }\n  form.classList.remove('is-sending')\n  if (!response || !response.ok || signal.aborted) return\n  const id = form.getAttribute('data-autosearch-results-container')\n  const resultsContainer = id ? document.getElementById(id) : null\n  if (resultsContainer) {\n    resultsContainer.innerHTML = ''\n    resultsContainer.appendChild(parseHTML(document, await response.text()))\n  }\n  replaceState(null, '', `?${serialized}`)\n})\n","// Click to select clone urls\n\nimport {microtask} from '../eventloop-tasks'\nimport {onFocus} from '../onfocus'\n\nonFocus('input[data-autoselect], textarea[data-autoselect]', async function (input) {\n  await microtask()\n  ;(input as HTMLInputElement | HTMLTextAreaElement).select()\n})\n","// Form AutoSubmit Behavior\n//\n// Automatically submits form when one of its fields change.\n//\n// Examples\n//\n//   <form action=\"/subscribe\" data-autosubmit>\n//     <input type=radio name=state value=1> Subscribe\n//     <input type=radio name=state value=0> Unsubscribe\n//   </form>\n\nimport {debounce} from '@github/mini-throttle'\nimport {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {requestSubmit} from '../form'\n\non('change', 'form[data-autosubmit]', function (event) {\n  const target = event.currentTarget\n  requestSubmit(target as HTMLFormElement)\n})\n\non('change', 'input[data-autosubmit], select[data-autosubmit]', submit)\n\n// Submit a form from a change event.\nfunction submit(event: Event) {\n  const input = event.target\n  if (!(input instanceof HTMLInputElement) && !(input instanceof HTMLSelectElement)) return\n\n  const form = input.form\n  requestSubmit(form!)\n}\n\nconst debouncedSubmit = debounce(submit, 300)\n\nobserve('input[data-throttled-autosubmit]', {\n  subscribe: el => fromEvent(el, 'input', debouncedSubmit)\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Sets the text of the avatar reset button depending on whether or not the\n// user has a gravatar associated with their GitHub account.\nasync function detectGravatar(el: Element) {\n  const gravitarUrl = el.getAttribute('data-url') || ''\n  const hasGravitar = await fetchGravatarInfo(gravitarUrl)\n\n  if (hasGravitar) {\n    const gravatarText = el.getAttribute('data-gravatar-text')\n    if (gravatarText != null) {\n      el.textContent = gravatarText\n    }\n  }\n}\n\nobserve('.js-detect-gravatar', function (el) {\n  detectGravatar(el)\n})\n\n// Fetch the gravitarUrl, and check the `has_gravatar` property from the returning JSON.\nasync function fetchGravatarInfo(gravitarUrl: string): Promise<boolean> {\n  const url = gravitarUrl\n  if (!url) return false\n\n  try {\n    const response = await fetch(url, {headers: {Accept: 'application/json'}})\n    if (!response.ok) return false\n    const data = (await response.json()) as {has_gravatar: boolean}\n    return data.has_gravatar\n  } catch {\n    return false\n  }\n}\n","// Batch Deferred Content Behavior\n//\n// Automatically fetches content for multiple placeholders with a single request.\n// Placeholders are represented as <batch-deferred-content>'s so that per-placeholder arguments can be\n// passed along to the backend for rendering. Once the response is received, each placeholder\n// will be replaced with it's relevant content.\n//\n// Batching is handled by an autoflushing queue. Once an upper limit (default 30) of placeholders\n// are found, or new placeholders stop being added to the queue, after a timeout (default 50ms),\n// a single request will be made to fetch the content for those items.\n//\n// Example Markup\n//\n//   <batch-deferred-content data-url=\"/my/batched/content/endpoint\">\n//     <input data-csrf type=\"hidden\" value=\"AUTHN_TOKEN\">\n//     <input data-targets=\"batch-deferred-content.inputs\" type=\"hidden\" name=\"repo_id\" value=\"42\">\n//     <input data-targets=\"batch-deferred-content.inputs\" type=\"hidden\" name=\"commit_oid\" value=\"abcdef0\">\n//   </batch-deferred-content>\n//   \n//   <batch-deferred-content data-url=\"/my/batched/content/endpoint\">\n//     <input data-csrf type=\"hidden\" value=\"AUTHN_TOKEN\">\n//     <input data-targets=\"batch-deferred-content.inputs\" type=\"hidden\" name=\"repo_id\" value=\"88\">\n//     <input data-targets=\"batch-deferred-content.inputs\" type=\"hidden\" name=\"commit_oid\" value=\"f000001\">\n//   </batch-deferred-content>\n//\n// Example Request\n//\n//   POST /my/batched/content/endpoint\n//   BODY {\n//     authenticity_token: \"AUTH_TOKEN\",\n//     items: {\n//       item-0: {repo_id: 42, commit_oid: \"abcdef0\"},\n//       item-1: {repo_id: 88, commit_oid: \"f000001\"},\n//     }\n//   }\n//\n// Example Response\n//\n//   Content-Type: application/json\n//   BODY {\n//     item-0: \"<div>Some markup</div>\",\n//     item-1: \"<div>More markup</div>\",\n//   }\n\nimport {attr, controller, targets} from '@github/catalyst'\nimport {parseHTML} from '../parse-html'\n\nclass AutoFlushingQueue<T = HTMLElement> {\n  timeout: number\n  limit: number\n  elements: T[] = []\n  timer: number | null = null\n  callbacks: Array<(elementsToFlush: T[]) => Promise<void>> = []\n  csrf: string | null = null\n\n  constructor(timeout = 50, limit = 30) {\n    this.timeout = timeout // flush timeout in milliseconds\n    this.limit = limit // max number of elements before autoflushing\n  }\n\n  push(element: T): void {\n    if (this.timer) {\n      window.clearTimeout(this.timer)\n      this.timer = null\n    }\n    if (element instanceof HTMLElement) {\n      const csrfInput = element.querySelector<HTMLInputElement>('[data-csrf]')\n      if (csrfInput !== null) {\n        this.csrf = csrfInput.value\n      }\n    }\n    if (this.elements.length >= this.limit) {\n      this.flush()\n    }\n\n    this.elements.push(element)\n    this.timer = window.setTimeout(() => {\n      this.flush()\n    }, this.timeout)\n  }\n\n  onFlush(callback: (elementsToFlush: T[]) => Promise<void>): void {\n    this.callbacks.push(callback)\n  }\n\n  private async flush(): Promise<void> {\n    const elementsToFlush = this.elements.splice(0, this.limit)\n    if (elementsToFlush.length === 0) return\n\n    await Promise.all(this.callbacks.map(callback => callback(elementsToFlush)))\n  }\n}\n\nasync function fetchContents(url: string, formData: FormData): Promise<Map<string, string>> {\n  const response = await fetch(url, {\n    method: 'POST',\n    body: formData,\n    headers: {\n      Accept: 'application/json',\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n\n  if (response.ok) {\n    const json = await response.json()\n    const map = new Map<string, string>()\n    for (const key in json) {\n      map.set(key, json[key])\n    }\n    return map\n  } else {\n    return new Map()\n  }\n}\n\nconst queues: Map<string, AutoFlushingQueue<BatchDeferredContentElement>> = new Map()\n\n@controller\nclass BatchDeferredContentElement extends HTMLElement {\n  @attr url = ''\n  @targets inputs: HTMLInputElement[]\n\n  connectedCallback() {\n    this.queue.push(this)\n  }\n\n  get queue(): AutoFlushingQueue<BatchDeferredContentElement> {\n    let q = queues.get(this.url)\n    if (q) {\n      return q\n    } else {\n      q = this.buildAutoFlushingQueue()\n      queues.set(this.url, q)\n      return q\n    }\n  }\n\n  private buildAutoFlushingQueue() {\n    const autoFlushingQueue = new AutoFlushingQueue<BatchDeferredContentElement>()\n    autoFlushingQueue.onFlush(async elements => {\n      const elementsByKey: Map<string, BatchDeferredContentElement> = new Map()\n      const consolidatedData = new FormData()\n\n      // set CSRF token if available\n      if (autoFlushingQueue.csrf !== null) {\n        // eslint-disable-next-line github/authenticity-token\n        consolidatedData.set('authenticity_token', autoFlushingQueue.csrf)\n      }\n\n      for (const index in elements) {\n        const batchElement = elements[index]\n        const key = `item-${index}`\n        elementsByKey.set(key, batchElement)\n\n        for (const input of batchElement.inputs) {\n          consolidatedData.append(`items[${key}][${input.name}]`, input.value)\n        }\n      }\n\n      consolidatedData.set('_method', 'GET')\n\n      const contentsMap = await fetchContents(this.url, consolidatedData)\n      for (const [key, content] of contentsMap.entries()) {\n        const batchElement = elementsByKey.get(key)!\n        batchElement.replaceWith(parseHTML(document, content))\n      }\n    })\n\n    return autoFlushingQueue\n  }\n}\n","import pjax, {getState} from './pjax'\nimport {addThrottledInputEventListener} from '../throttled-input'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {replaceState} from '../history'\nimport visible from '../visible'\n\ninterface UserPlan {\n  free: boolean\n  is_enterprise_cloud_trial: boolean\n  seats: number\n  no_additional_seats: boolean\n  selectors: string[]\n  url: string\n}\n\nlet previousController: AbortController | null = null\non('click', '.js-org-signup-duration-change', event => {\n  event.preventDefault()\n  const el = event.currentTarget\n  const newDuration = el.getAttribute('data-plan-duration')!\n\n  updateDurationFields(newDuration)\n  updateSeatFieldURLs(newDuration)\n  for (const seatsField of document.querySelectorAll<HTMLInputElement>('.js-seat-field')) {\n    updateTotals(seatsField)\n  }\n  toggleDurationUnitPrices()\n})\n\non('change', '.js-org-signup-duration-toggle', function ({currentTarget}) {\n  const container = document.getElementById('js-pjax-container')!\n  const url = new URL(currentTarget.getAttribute('data-url')!, window.location.origin)\n\n  pjax({\n    url: url.toString(),\n    container\n  })\n})\n\nasync function updateTotals(el: HTMLInputElement | HTMLSelectElement) {\n  const itemKey = el.getAttribute('data-item-name') || 'items'\n  const itemRawCount = el.value\n  const url = new URL(el.getAttribute('data-url')!, window.location.origin)\n  const params = new URLSearchParams(url.search.slice(1))\n  const planDuration = params.get('plan_duration') || el.getAttribute('data-plan-duration')\n  const itemMinimum = parseInt(el.getAttribute('data-item-minimum')!) || 0\n  const itemMaximum = parseInt(el.getAttribute('data-item-maximum')!) || planDuration === 'year' ? 100 : 300\n  const itemCount = parseInt(el.getAttribute('data-item-count')!) || 0\n  const itemDelta = Math.max(itemMinimum, parseInt(itemRawCount) || 0)\n  const contactUs = itemDelta > itemMaximum\n\n  const downgradeButton = document.querySelector('.js-downgrade-button')\n  const downgradeDisabledMessage = document.getElementById('downgrade-disabled-message')\n  if (downgradeButton instanceof HTMLButtonElement) {\n    downgradeButton.disabled = itemDelta === itemCount\n  }\n\n  if (downgradeDisabledMessage instanceof HTMLElement && downgradeButton instanceof HTMLButtonElement) {\n    downgradeDisabledMessage.hidden = !downgradeButton.disabled\n  }\n\n  params.append(itemKey, itemDelta.toString())\n\n  const transformInput = document.querySelector('.js-transform-user')\n  if (transformInput) params.append('transform_user', '1')\n\n  url.search = params.toString()\n\n  previousController?.abort()\n  const {signal} = (previousController = new AbortController())\n  let data: UserPlan | null = null\n  try {\n    const response = await fetch(url.toString(), {signal, headers: {Accept: 'application/json'}})\n    if (!response.ok) return\n    data = (await response.json()) as UserPlan\n  } catch {\n    // ignore network errors\n  }\n  if (signal.aborted) return\n  if (!data) return\n\n  const contact = document.querySelector('.js-contact-us')\n  /* eslint-disable-next-line github/no-d-none */\n  if (contact) contact.classList.toggle('d-none', !contactUs)\n\n  const paymentSummary = document.querySelector('.js-payment-summary')\n  /* eslint-disable-next-line github/no-d-none */\n  if (paymentSummary) paymentSummary.classList.toggle('d-none', contactUs)\n\n  const submit = document.querySelector('.js-submit-billing')\n  if (submit instanceof HTMLElement) submit.hidden = contactUs\n\n  const billing = document.querySelector('.js-billing-section')\n  if (billing) billing.classList.toggle('has-removed-contents', data.free || data.is_enterprise_cloud_trial)\n\n  const upgrade = document.querySelector('.js-upgrade-info')\n  /* eslint-disable-next-line github/no-d-none */\n  if (upgrade) upgrade.classList.toggle('d-none', itemDelta <= 0)\n\n  const downgrade = document.querySelector('.js-downgrade-info')\n  /* eslint-disable-next-line github/no-d-none */\n  if (downgrade) downgrade.classList.toggle('d-none', itemDelta >= 0)\n\n  const extraSeats = document.querySelector('.js-extra-seats-line-item')\n  /* eslint-disable-next-line github/no-d-none */\n  if (extraSeats) extraSeats.classList.toggle('d-none', data.no_additional_seats)\n\n  const seatField = document.querySelector('.js-seat-field')\n  if (seatField) updateSeatFields(itemRawCount)\n\n  const minimumSeatsTooltip = document.querySelector('.js-minimum-seats-disclaimer')\n  if (minimumSeatsTooltip) {\n    minimumSeatsTooltip.classList.toggle('tooltipped', data.seats === 5)\n    minimumSeatsTooltip.classList.toggle('tooltipped-nw', data.seats === 5)\n  }\n\n  const ref = data.selectors\n  for (const selector in ref) {\n    for (const element of document.querySelectorAll(selector)) {\n      element.innerHTML = ref[selector]\n    }\n  }\n  replaceState(getState(), '', data.url)\n}\n\nfunction toggleDurationUnitPrices() {\n  for (const unitPrice of document.querySelectorAll<HTMLElement>('.js-unit-price')) {\n    unitPrice.hidden = !unitPrice.hidden\n  }\n}\n\nfunction updateDurationFields(newDuration: string) {\n  const oldDuration = newDuration === 'year' ? 'month' : 'year'\n  for (const planDurationText of document.querySelectorAll('.js-plan-duration-text')) {\n    planDurationText.innerHTML = newDuration\n  }\n\n  for (const planDurationAdjective of document.querySelectorAll('.unstyled-available-plan-duration-adjective')) {\n    planDurationAdjective.innerHTML = `${newDuration}ly`\n  }\n\n  for (const durationLink of document.querySelectorAll('.js-org-signup-duration-change')) {\n    durationLink.setAttribute('data-plan-duration', oldDuration)\n  }\n  const planDurationInput = <HTMLInputElement>document.getElementById('signup-plan-duration')\n  if (planDurationInput) {\n    planDurationInput.value = newDuration\n  }\n}\n\nfunction updateSeatFields(numberOfSeats: string) {\n  for (const el of document.querySelectorAll<HTMLInputElement>('.js-seat-field')) {\n    const maxSeatForPlan = el.getAttribute('data-item-max-seats')!\n    const popover = el?.parentNode?.querySelector<HTMLElement>('.Popover')\n\n    if (maxSeatForPlan && maxSeatForPlan.length) {\n      if (parseInt(numberOfSeats, 10) > parseInt(maxSeatForPlan, 10)) {\n        el.classList.add('color-border-danger-emphasis')\n        popover?.removeAttribute('hidden')\n      } else {\n        el.classList.remove('color-border-danger-emphasis')\n        popover?.setAttribute('hidden', 'true')\n        el.value = numberOfSeats\n      }\n    } else {\n      el.value = numberOfSeats\n    }\n  }\n}\n\nfunction updateSeatFieldURLs(newDuration: string) {\n  for (const el of document.querySelectorAll<HTMLInputElement>('.js-seat-field')) {\n    const url = new URL(el.getAttribute('data-url')!, window.location.origin)\n    const params = new URLSearchParams(url.search.slice(1))\n    params.delete('plan_duration')\n    params.append('plan_duration', newDuration)\n    url.search = params.toString()\n    el.setAttribute('data-url', url.toString())\n  }\n}\n\nobserve('.js-addon-purchase-field', {\n  constructor: HTMLInputElement,\n  add(el) {\n    if (visible(el)) updateTotals(el)\n\n    addThrottledInputEventListener(el, function () {\n      updateTotals(el)\n    })\n  }\n})\n\nobserve('.js-addon-downgrade-field', {\n  constructor: HTMLSelectElement,\n  add(el) {\n    if (visible(el)) updateTotals(el)\n\n    el.addEventListener('change', function () {\n      updateTotals(el)\n    })\n  }\n})\n\nfunction handleOrgChange(event: Event) {\n  const addonField = document.querySelector('.js-addon-purchase-field')\n  const selectedRadio = (event.target as Element).querySelector('input:checked')\n\n  if (addonField instanceof HTMLInputElement && selectedRadio instanceof HTMLInputElement) {\n    const newUrl = selectedRadio.getAttribute('data-upgrade-url')\n\n    if (newUrl) {\n      addonField.setAttribute('data-url', newUrl)\n      addonField.value = '0'\n      updateTotals(addonField)\n    }\n  }\n}\n\non('details-menu-selected', '.js-organization-container', handleOrgChange, {capture: true})\n","import {onInput} from '../onfocus'\n\nonInput('.js-csv-filter-field', function (event) {\n  const query = (event.target as HTMLInputElement).value.toLowerCase()\n  for (const row of document.querySelectorAll('.js-csv-data tbody tr')) {\n    if (!(row instanceof HTMLElement)) continue\n    if (!row.textContent) continue\n    row.hidden = !!query && !row.textContent.toLowerCase().includes(query)\n  }\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Flip tooltip direction of child elements if an item gets .is-stuck\n// so tooltips are still visible when the user scrolls down a blob and\n// the button bar sticks to the top\nobserve('.js-blob-header.is-stuck', {\n  add(el) {\n    flipTooltip(el)\n  },\n  remove(el) {\n    flipTooltip(el, true)\n  }\n})\n\nfunction flipTooltip(element: Element, inverse = false) {\n  const pairs = {\n    'tooltipped-nw': 'tooltipped-sw',\n    'tooltipped-n': 'tooltipped-s',\n    'tooltipped-ne': 'tooltipped-se'\n  }\n\n  for (const [key, value] of Object.entries(pairs)) {\n    const from = inverse ? value : key\n    const to = inverse ? key : value\n    for (const el of element.querySelectorAll(`.${from}`)) {\n      el.classList.replace(from, to)\n    }\n  }\n}\n","interface BlobOffset {\n  // Line number\n  // Lines start at 1.\n  line: number\n\n  // Optional column number.\n  // Like lines, columns are 1-indexed.\n  column: number | null\n}\n\nexport interface BlobRange {\n  // Starting offset of range.\n  start: BlobOffset\n\n  // End offset of range.\n  // End offset may be the same as the start. This indicates a collapsed range.\n  // Should always be initialized to a value that is equal or greater than the\n  // start range such the range is always in ascending order. Reversed ranges\n  // have undefined behavior.\n  end: BlobOffset\n}\n\n// Inverse of `formatBlobRange`.\n//\n// Examples\n//\n//   parseBlobRange(\"#L3\")\n//   // => {start: {line: 3}}\n//\n//   parseBlobRange(\"L3-L5\")\n//   // => {start: {line: 3}, end: {line: 5}}\n//\n//   parseBlobRange(\"\")\n//   // => null\nexport function parseBlobRange(str: string): BlobRange | undefined {\n  const lines = str.match(/#?(?:L)(\\d+)((?:C)(\\d+))?/g)\n  if (!lines) {\n    return\n  } else if (lines.length === 1) {\n    const offset = parseBlobOffset(lines[0])\n    if (!offset) return\n    return Object.freeze({start: offset, end: offset})\n  } else if (lines.length === 2) {\n    const startOffset = parseBlobOffset(lines[0])\n    const endOffset = parseBlobOffset(lines[1])\n    if (!startOffset || !endOffset) return\n\n    return ascendingBlobRange(\n      Object.freeze({\n        start: startOffset,\n        end: endOffset\n      })\n    )\n  } else {\n    return\n  }\n}\n\n// Inverse of `parseBlobRange`.\n//\n// Examples\n//\n//   formatBlobRange({start: {line: 3}})\n//   // => \"L3\"\n//\n//   formatBlobRange({start: {line: 3}, end: {line: 5}})\n//   // => \"L3-L5\"\n//\n//   formatBlobRange({start: {line: 3, column: 1}, end: {line: 5, column: 5}})\n//   // => \"L3C1-L5C5\"\nexport function formatBlobRange(blobRange: BlobRange): string {\n  const {start, end} = ascendingBlobRange(blobRange)\n\n  if (start.column != null && end.column != null) {\n    return `L${start.line}C${start.column}-L${end.line}C${end.column}`\n  } else if (start.line === end.line) {\n    return `L${start.line}`\n  } else {\n    return `L${start.line}-L${end.line}`\n  }\n}\n\n// Returns a String containing the file prefix with trailing dash.\n//\n// Examples\n//\n//   parseAnchorPrefix(\"#file-zshrc-L3\")\n//   // => \"file-zshrc-\"\n//\n//   parseAnchorPrefix(\"file-zshrc-L3-L5\")\n//   // => \"file-zshrc-\"\n//\n//   parseAnchorPrefix(\"\")\n//   // => \"\"\nfunction parseAnchorPrefix(str: string): string {\n  const match = str.match(/(file-.+?-)L\\d+?/i)\n  return match ? match[1] : ''\n}\n\nexport type AnchorInfo = {\n  blobRange: BlobRange\n  anchorPrefix: string\n}\n\n// Examples\n//\n//   parseFileAnchor(\"#file-zshrc-L3\")\n//   // => { blobRange: {start: {line: 3}}, anchorPrefix: \"file-zshrc-\" }\n//\n//   parseFileAnchor(\"file-zshrc-L3-L5\")\n//   // => { blobRange: {start: {line: 3}, end: {line: 5}}, anchorPrefix: \"file-zshrc-\" }\n//\n//   parseFileAnchor(\"\")\n//   // => { blobRange: null, anchorPrefix: undefined }\nexport function parseFileAnchor(str: string): AnchorInfo {\n  const blobRange = parseBlobRange(str)!\n  const anchorPrefix = parseAnchorPrefix(str)\n  return {blobRange, anchorPrefix}\n}\n\n// Formats line number range pair as an anchor String.\n//\n// Examples\n//\n//   formatBlobRangeAnchor({blobRange: {start: {line: 3}}, anchorPrefix: \"\"})\n//   // => \"#L3\"\n//\n//   formatBlobRangeAnchor({blobRange: {start: {line: 3}}, anchorPrefix: \"file-zshrc-\"})\n//   // => \"#file-zshrc-L3\"\n//\n//   formatBlobRangeAnchor({blobRange: {start: {line: 3}, end: {line: 5}}, anchorPrefix: \"\"})\n//   // => \"#L3-L5\"\n//\n//   formatBlobRangeAnchor({blobRange: {start: {line: 3, column: 1}, end: {line: 5, column: 5}}, anchorPrefix: \"\"})\n//   // => \"#L3C1-L5C5\"\n//\n//   formatBlobRangeAnchor({blobRange: {start: {line: 3}, end: {line: 5}}, anchorPrefix: \"file-zshrc-\"})\n//   // => \"#file-zshrc-L3-L5\"\n//\n//   formatBlobRangeAnchor({blobRange: null, anchorPrefix: \"\"})\n//   // => \"#\"\n//\n//   formatBlobRangeAnchor({blobRange: null, anchorPrefix: \"file-zshrc-\"})\n//   // => \"#\"\nexport function formatBlobRangeAnchor({anchorPrefix, blobRange}: AnchorInfo): string {\n  if (!blobRange) return '#'\n  return `#${anchorPrefix}${formatBlobRange(blobRange)}`\n}\n\nfunction parseBlobOffset(str: string): BlobOffset | null {\n  const lineMatch = str.match(/L(\\d+)/)\n  const columnMatch = str.match(/C(\\d+)/)\n  if (lineMatch) {\n    return Object.freeze({\n      line: parseInt(lineMatch[1]),\n      column: columnMatch ? parseInt(columnMatch[1]) : null\n    })\n  } else {\n    return null\n  }\n}\n\nexport function DOMRangeFromBlob(\n  blobRange: BlobRange,\n  getLineElement: (line: number) => Node | null\n): Range | undefined {\n  const [startContainer, _startOffset] = findRangeOffset(blobRange.start, true, getLineElement)\n  const [endContainer, _endOffset] = findRangeOffset(blobRange.end, false, getLineElement)\n  if (!startContainer || !endContainer) return\n\n  // Treat -1 as full line selection\n  let startOffset = _startOffset\n  let endOffset = _endOffset\n  if (startOffset === -1) startOffset = 0\n  if (endOffset === -1) endOffset = endContainer.childNodes.length\n  if (!startContainer.ownerDocument) throw new Error(`DOMRange needs to be inside document`)\n\n  const range = startContainer.ownerDocument.createRange()\n  range.setStart(startContainer, startOffset)\n  range.setEnd(endContainer, endOffset)\n  return range\n}\n\nfunction findRangeOffset(\n  offset: BlobOffset,\n  lookAhead: boolean,\n  getLineElement: (n: number) => Node | null\n): [Node | null, number] {\n  const error: [null, number] = [null, 0]\n\n  const lineElement = getLineElement(offset.line)\n  if (!lineElement) return error\n\n  if (offset.column == null) {\n    return [lineElement, -1]\n  }\n\n  let column = offset.column - 1\n\n  const textNodes = getAllTextNodes(lineElement)\n  for (let i = 0; i < textNodes.length; i++) {\n    const textNode = textNodes[i]\n\n    // TODO: length might be buggy with emoji\n    const nextC = column - (textNode.textContent || '').length\n\n    if (nextC === 0) {\n      const nextTextNode = textNodes[i + 1]\n      if (lookAhead && nextTextNode) {\n        return [nextTextNode, 0]\n      } else {\n        return [textNode, column]\n      }\n    } else if (nextC < 0) {\n      return [textNode, column]\n    }\n\n    column = nextC\n  }\n\n  return error\n}\n\n// Get a flat list of text nodes in depth first order.\nfunction getAllTextNodes(el: Node): Node[] {\n  if (el.nodeType === Node.TEXT_NODE) {\n    return [el]\n  }\n  if (!el.childNodes || !el.childNodes.length) return []\n  let list: Node[] = []\n  for (const node of el.childNodes) {\n    list = list.concat(getAllTextNodes(node))\n  }\n  return list\n}\n\n// Sorts range start and end offsets to be in ascending order.\nfunction ascendingBlobRange(range: BlobRange): BlobRange {\n  const offsets = [range.start, range.end]\n  offsets.sort(compareBlobOffsets)\n\n  if (offsets[0] === range.start && offsets[1] === range.end) {\n    return range\n  } else {\n    return Object.freeze({\n      start: offsets[0],\n      end: offsets[1]\n    })\n  }\n}\n\n// Compare line offsets. May be used with Array.sort\nfunction compareBlobOffsets(a: BlobOffset, b: BlobOffset): number {\n  if (a.line === b.line && a.column === b.column) {\n    return 0\n  } else if (a.line === b.line && typeof a.column === 'number' && typeof b.column === 'number') {\n    return a.column - b.column\n  } else {\n    return a.line - b.line\n  }\n}\n","// More robust version of Range.surroundContents().\nexport function surroundContents(range: Range, newNode: Node) {\n  newNode.appendChild(range.extractContents())\n  range.insertNode(newNode)\n}\n","import {DOMRangeFromBlob, formatBlobRangeAnchor, parseBlobRange, parseFileAnchor} from '../blob-anchor'\nimport type {AnchorInfo} from '../blob-anchor'\nimport ClipboardCopyElement from '@github/clipboard-copy-element'\nimport {TemplateInstance} from '@github/template-parts'\nimport hashChange from './hash-change'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {sendEvent} from '../hydro-analytics'\nimport {surroundContents} from '../range'\n\nlet skipNextScrollTo = false\n\nfunction queryLineElement(anchorPrefix: string, line: number) {\n  return document.querySelector(`#${anchorPrefix}LC${line}`)\n}\n\n// Highlight a line or range of lines.\nfunction highlightLines({blobRange, anchorPrefix}: AnchorInfo): void {\n  const lineElements = document.querySelectorAll('.js-file-line')\n\n  if (lineElements.length === 0) return\n  clearHighlights()\n\n  if (!blobRange) return\n\n  if (blobRange.start.column === null || blobRange.end.column === null) {\n    for (let i = blobRange.start.line; i <= blobRange.end.line; i += 1) {\n      const line = queryLineElement(anchorPrefix, i)\n      if (line) line.classList.add('highlighted')\n    }\n  } else if (\n    blobRange.start.line === blobRange.end.line &&\n    blobRange.start.column != null &&\n    blobRange.end.column != null\n  ) {\n    const range = DOMRangeFromBlob(blobRange, line => queryLineElement(anchorPrefix, line))\n\n    if (range) {\n      const span = document.createElement('span')\n      span.classList.add('highlighted')\n      surroundContents(range, span)\n    }\n  } else {\n    // TODO column highlights across multiple lines\n  }\n}\n\n// Clear all highlighted lines and ranges.\nfunction clearHighlights() {\n  for (const el of document.querySelectorAll('.js-file-line.highlighted')) {\n    el.classList.remove('highlighted')\n  }\n\n  for (const el of document.querySelectorAll('.js-file-line .highlighted')) {\n    const lineEl = el.closest<HTMLElement>('.js-file-line')!\n    el.replaceWith(...el.childNodes)\n    lineEl.normalize()\n  }\n}\n\n// Highlight and scroll to the lines in the current location hash.\nfunction scrollLinesIntoView(): void {\n  const anchorInfo = parseFileAnchor(window.location.hash)\n\n  highlightLines(anchorInfo)\n  showOrHideLineActions()\n\n  const {blobRange, anchorPrefix} = anchorInfo\n\n  const line = blobRange && queryLineElement(anchorPrefix, blobRange.start.line)\n\n  if (!skipNextScrollTo && line) {\n    line.scrollIntoView()\n    const container = line.closest<HTMLElement>('.blob-wrapper, .js-blob-wrapper')!\n    container.scrollLeft = 0\n  }\n\n  skipNextScrollTo = false\n}\n\n// Update highlighted lines when the page loads and\n// anytime the hash changes.\nhashChange(function () {\n  if (document.querySelector('.js-file-line-container')) {\n    setTimeout(scrollLinesIntoView, 0)\n    const hash = window.location.hash\n    for (const element of document.querySelectorAll('.js-update-url-with-hash')) {\n      if (element instanceof HTMLAnchorElement) {\n        element.hash = hash\n      } else if (element instanceof HTMLFormElement) {\n        const newAction = new URL(element.action, window.location.origin)\n        newAction.hash = hash\n        element.action = newAction.toString()\n      }\n    }\n  }\n})\n\nfunction setCopyLines(lines: NodeListOf<HTMLElement>): void {\n  const lineTextArray: string[] = []\n  for (const line of lines) {\n    lineTextArray.push(line.textContent!)\n  }\n  const button = document.getElementById('js-copy-lines')\n  if (button instanceof ClipboardCopyElement) {\n    // eslint-disable-next-line i18n-text/no-en\n    button.textContent = `Copy ${lines.length === 1 ? 'line' : 'lines'}`\n    button.value = lineTextArray.join('\\n')\n    const gaText = `Blob, copyLines, numLines:${lines.length.toString()}`\n    button.setAttribute('data-ga-click', gaText)\n  }\n}\n\nfunction setPermalink(numLines: number): string | undefined {\n  const permalinkContainer = document.querySelector('.js-permalink-shortcut')\n  if (permalinkContainer instanceof HTMLAnchorElement) {\n    const url = `${permalinkContainer.href}${window.location.hash}`\n    const button = document.getElementById('js-copy-permalink')\n    if (button instanceof ClipboardCopyElement) {\n      button.value = url\n      const gaText = `Blob, copyPermalink, numLines:${numLines.toString()}`\n      button.setAttribute('data-ga-click', gaText)\n    }\n    return url\n  }\n}\n\nfunction setOpenIssueLink(permalink: string, numLines: number) {\n  const newIssueLink = document.getElementById('js-new-issue')\n  if (newIssueLink instanceof HTMLAnchorElement) {\n    if (!newIssueLink.href) return\n    const newIssueUrl = new URL(newIssueLink.href, window.location.origin)\n    const params = new URLSearchParams(newIssueUrl.search)\n    params.set('permalink', permalink)\n    newIssueUrl.search = params.toString()\n    newIssueLink.href = newIssueUrl.toString()\n    newIssueLink.setAttribute('data-ga-click', `Blob, newIssue, numLines:${numLines.toString()}`)\n  }\n}\n\nfunction setOpenDiscussionLink(permalink: string, numLines: number) {\n  const newDiscussionLink = document.getElementById('js-new-discussion')\n  if (!(newDiscussionLink instanceof HTMLAnchorElement) || !newDiscussionLink?.href) return\n  const newDiscussionUrl = new URL(newDiscussionLink.href, window.location.origin)\n  const params = new URLSearchParams(newDiscussionUrl.search)\n  params.set('permalink', permalink)\n  newDiscussionUrl.search = params.toString()\n  newDiscussionLink.href = newDiscussionUrl.toString()\n  newDiscussionLink.setAttribute('data-ga-click', `Blob, newDiscussion, numLines:${numLines.toString()}`)\n}\n\nfunction setViewGitBlame(numLines: number): void {\n  const button = document.getElementById('js-view-git-blame')\n  if (!button) return\n  button.setAttribute('data-ga-click', `Blob, viewGitBlame, numLines:${numLines.toString()}`)\n}\n\nfunction showOrHideLineActions(): void {\n  const actions = document.querySelector<HTMLElement>('.js-file-line-actions')\n  if (!actions) return\n\n  const lines = document.querySelectorAll<HTMLElement>('.js-file-line.highlighted')\n  const firstSelected = lines[0]\n\n  if (firstSelected) {\n    setCopyLines(lines)\n    setViewGitBlame(lines.length)\n    const permalink = setPermalink(lines.length)\n    if (permalink) setOpenIssueLink(permalink, lines.length)\n    if (permalink) setOpenDiscussionLink(permalink, lines.length)\n\n    actions.style.top = `${firstSelected.offsetTop - 2}px`\n    /* eslint-disable-next-line github/no-d-none */\n    actions.classList.remove('d-none')\n  } else {\n    /* eslint-disable-next-line github/no-d-none */\n    actions.classList.add('d-none')\n  }\n}\n\n// Prevent scroll position from changing after setting location.hash.\n//\n// callback - Function to preserve scroll position after.\nfunction preserveLineNumberScrollPosition(callback: () => void): void {\n  const scrollTop = window.scrollY\n  skipNextScrollTo = true\n  callback()\n  window.scrollTo(0, scrollTop)\n}\n\n// Clicking line numbers highlights the line\non('click', '.js-line-number', function (event) {\n  const anchorInfo = parseFileAnchor(event.currentTarget.id)\n\n  const {blobRange} = anchorInfo\n\n  const currentLines = parseBlobRange(window.location.hash)\n  if (currentLines && event.shiftKey) {\n    anchorInfo.blobRange = {\n      start: currentLines.start,\n      end: blobRange.end\n    }\n  }\n\n  preserveLineNumberScrollPosition(() => {\n    window.location.hash = formatBlobRangeAnchor(anchorInfo)\n  })\n})\n\n// \"Jump to Line\" modal\non('submit', '.js-jump-to-line-form', function (event) {\n  const field = event.currentTarget.querySelector<HTMLInputElement>('.js-jump-to-line-field')!\n  // Regex removes all characters except integers and dashes (for multi-line case)\n  const strippedField = field.value.replace(/[^\\d-]/g, '')\n  const lineNums = strippedField\n    .split('-')\n    .map(s => parseInt(s, 10))\n    .filter(n => n > 0)\n    .sort((a, b) => a - b)\n  if (lineNums.length) window.location.hash = `L${lineNums.join('-L')}`\n\n  event.preventDefault()\n})\n\nobserve('.js-check-bidi', alertOnBidiCharacter)\n\n// There are 9 unicode codepoints in two contiguous blocks that act as\n// bidi (bidirectional) control characters which can obscure malicious code:\n// +-----------+----------------------------------+\n// | codepoint | Control character name           |\n// +-----------+----------------------------------+\n// |  \\u202A   | LEFT-TO-RIGHT EMBEDDING (LRE)    |\n// |  \\u202B   | RIGHT-TO-LEFT EMBEDDING (RLE)    |\n// |  \\u202C   | POP DIRECTIONAL FORMATTING (PDF) |\n// |  \\u202D   | LEFT-TO-RIGHT OVERRIDE (LRO)     |\n// |  \\u202E   | RIGHT-TO-LEFT OVERRIDE (RLO)     |\n// |        [ ... ].                              |\n// |  \\u2066   | LEFT-TO-RIGHT ISOLATE (LRI)      |\n// |  \\u2067   | RIGHT-TO-LEFT ISOLATE (RLI)      |\n// |  \\u2068   | FIRST STRONG ISOLATE (FSI)       |\n// |  \\u2069   | POP DIRECTIONAL ISOLATE (PDI)    |\n// +-----------+----------------------------------+\nconst bidiRegex = /[\\u202A-\\u202E]|[\\u2066-\\u2069]/\nconst bidiReplacementMap: {[char: string]: string} = {\n  '\\u202A': 'U+202A', // LEFT-TO-RIGHT EMBEDDING\n  '\\u202B': 'U+202B', // RIGHT-TO-LEFT EMBEDDING\n  '\\u202C': 'U+202C', // POP DIRECTIONAL FORMATTING\n  '\\u202D': 'U+202D', // LEFT-TO-RIGHT OVERRIDE\n  '\\u202E': 'U+202E', // RIGHT-TO-LEFT OVERRIDE\n  '\\u2066': 'U+2066', // LEFT-TO-RIGHT ISOLATE\n  '\\u2067': 'U+2067', // RIGHT-TO-LEFT ISOLATE\n  '\\u2068': 'U+2068', // FIRST STRONG ISOLATE\n  '\\u2069': 'U+2069' // POP DIRECTIONAL ISOLATE\n}\n\n// Function to recursively search elements for child text nodes,\n// find bidi characters and optionally replace them with their unicode\n// character codes. If we are not replacing characters, we will return\n// early when we find the first bidi character.\n//\n// _revealedCharacterTemplate - Template to use when replacing characters, if null we will skip characer replacement\n//\n// Returns true if a bidi character is found, false if no bidi character was found\nfunction checkNodeForBidiCharacters(el: Node, _revealedCharacterTemplate: HTMLTemplateElement | null): boolean {\n  if (el.nodeType === Node.TEXT_NODE) return checkTextNodeForBidiCharacters(el, _revealedCharacterTemplate)\n  if (!el.childNodes || !el.childNodes.length) return false\n\n  let foundBidiCharacter = false\n  for (const node of el.childNodes) {\n    foundBidiCharacter ||= checkNodeForBidiCharacters(node, _revealedCharacterTemplate)\n    // If we found a bidi character and we are not replacing characters stop searching\n    if (foundBidiCharacter && !_revealedCharacterTemplate) break\n  }\n  return foundBidiCharacter\n}\n\nfunction checkTextNodeForBidiCharacters(el: Node, _revealedCharacterTemplate: HTMLTemplateElement | null): boolean {\n  // search for bidi characters and optionally replace\n  let foundBidiCharacter = false\n  if (el.nodeValue) {\n    for (let i = el.nodeValue.length - 1; i >= 0; i--) {\n      const char = el.nodeValue.charAt(i)\n      if (bidiReplacementMap[char]) {\n        foundBidiCharacter = true\n        // If we are not replacing characters, we can break early to avoid searching the entire node\n        if (!_revealedCharacterTemplate) break\n        const revealedCharacterInstance = new TemplateInstance(_revealedCharacterTemplate, {\n          revealedCharacter: bidiReplacementMap[char]\n        })\n        // Delete the hidden character and replace it with the revealed character\n        const r = new Range()\n        r.setStart(el, i)\n        r.setEnd(el, i + 1)\n        r.deleteContents()\n        r.insertNode(revealedCharacterInstance)\n      }\n    }\n  }\n  return foundBidiCharacter\n}\n\n// Search for bidi Unicode characters, which can obscure malicious code,\n// within blob/diff elements, and display an alert if they are present.\n// This is run after the content is displayed, so it won't impact the page TTI.\n// The container should provide 2 templates: .js-file-alert-template and .js-line-alert-template.\nexport function alertOnBidiCharacter(container: Element) {\n  let result = false\n  const start = performance.now()\n  const blobText = container.textContent || ''\n\n  // Quick check for bidi characters, it may return false positive if the occurrence\n  // is on a comment or other random content inside the blob container.\n  if (bidiRegex.test(blobText)) {\n    // .js-file-line covers blob and csv rendering,\n    // .blob-code-inner covers diff rendering, more specific with .diff-table to avoid being checked twice in blob.\n    const contentElements = container.querySelectorAll<HTMLElement>(\n      '.diff-table .blob-code-inner, .js-file-line-container .js-file-line, .js-suggested-changes-blob .blob-code-inner'\n    )\n\n    const lineAlertTemplate = document.querySelector<HTMLTemplateElement>('.js-line-alert-template')\n    const revealedCharTemplate = document.querySelector<HTMLTemplateElement>('.js-revealed-character-template')\n\n    // This is not an array, so we use a loop to check elements\n    for (const element of contentElements) {\n      if (checkNodeForBidiCharacters(element, revealedCharTemplate)) {\n        result = true\n\n        if (lineAlertTemplate) {\n          const lineAlertElement = new TemplateInstance(lineAlertTemplate, {})\n\n          // By default, alerts are included after the offending element,\n          // then we use CSS to display it properly. This is so to not break table layouts.\n          // But for CSV we need to render before, otherwise the alert jumps to the next line,\n          // so to avoid an even uglier CSS placement, we use .before() for it.\n          if (container.getAttribute('data-line-alert') === 'before') {\n            element.before(lineAlertElement)\n          } else {\n            element.after(lineAlertElement)\n          }\n        }\n      }\n    }\n  }\n\n  const duration = performance.now() - start\n  const context = {durationMs: duration.toString(), result: result.toString()}\n\n  sendEvent('blob_js_check_bidi_character', context)\n\n  if (result) {\n    // Searching the template in the whole document, to prevent duplicating it on each container (each file/comment in a PR)\n    const fileAlertTemplate = document.querySelector<HTMLTemplateElement>('.js-file-alert-template')\n    if (fileAlertTemplate) {\n      // Create a URL to reload the current page with the opposing hidden character parameter\n      const revealButtonUrl = new URL(window.location.href, window.location.origin)\n      revealButtonUrl.searchParams.get('h') === '1'\n        ? revealButtonUrl.searchParams.delete('h')\n        : revealButtonUrl.searchParams.set('h', '1')\n\n      const fileAlertElement = new TemplateInstance(fileAlertTemplate, {revealButtonHref: revealButtonUrl.href})\n      container.prepend(fileAlertElement)\n    }\n  }\n\n  // Remove the attribute to avoid checking again and duplicating the alert on pjax navigation\n  container.classList.remove('js-check-bidi')\n}\n\nclass CodeListingLine {\n  lineElement: Element\n  numberElement: Element\n\n  constructor(lineElement: Element, numberElement: Element) {\n    this.lineElement = lineElement\n    this.numberElement = numberElement\n  }\n\n  // Find a DOM Range for a given character range in a blob line.\n  range(startOffset: number, endOffset: number): Range | null {\n    startOffset = isNaN(startOffset) ? 0 : startOffset\n    endOffset = isNaN(endOffset) ? 0 : endOffset\n\n    let startNode: ChildNode | null = null\n    let startNodeIndex = 0\n    let endNodeIndex = 0\n    for (const [nodeIndex, textNode] of this.lineElement.childNodes.entries()) {\n      const length = (textNode.textContent || '').length\n      if (length > startOffset && !startNode) {\n        startNode = textNode\n        startNodeIndex = nodeIndex\n      }\n      if (length >= endOffset) {\n        endNodeIndex = nodeIndex\n        break\n      }\n\n      startOffset -= length\n      endOffset -= length\n    }\n\n    const range = document.createRange()\n    if (startNodeIndex === endNodeIndex) {\n      // The entire range is contained in a single element,\n      // so we want a character range within that element's text node.\n\n      while (startNode && startNode.nodeName !== '#text') {\n        startNode = startNode.childNodes[0]\n      }\n\n      if (!startNode) {\n        return null\n      }\n\n      range.setStart(startNode, startOffset)\n      range.setEnd(startNode, endOffset)\n    } else {\n      // The range spans multiple elements,\n      // so we want an element range covering all of them.\n\n      range.setStart(this.lineElement, startNodeIndex)\n      range.setEnd(this.lineElement, endNodeIndex + 1)\n    }\n\n    return range\n  }\n}\n\nclass CodeListing {\n  container: Element\n\n  constructor(container: Element) {\n    this.container = container\n  }\n\n  findLine(lineNum: number | string | null): CodeListingLine | null {\n    if (!lineNum) {\n      return null\n    }\n\n    // Find the coresponding line number element. For diffs this will\n    // always be the right side line number.\n    const lineNumElement = this.container.querySelector<HTMLElement>(`.js-blob-rnum[data-line-number='${lineNum}']`)\n    if (!lineNumElement) {\n      return null\n    }\n\n    // Find the code wrapper immediatly after the line number. For diffs\n    // this ensures we're always annotating the right-hand side.\n    let lineElement = lineNumElement.nextElementSibling\n    if (!lineElement || !lineElement.classList.contains('js-file-line')) {\n      return null\n    }\n\n    // For PR diffs, some interaction markup may exist within the line element\n    // (e.g. comment button). This skips over those if they exist.\n    lineElement = lineElement.querySelector<HTMLElement>('.js-code-nav-pass') || lineElement\n\n    return new CodeListingLine(lineElement, lineNumElement)\n  }\n}\n\nconst annotatedErrors: WeakMap<HTMLElement, boolean> = new WeakMap()\nfunction annotateCodeownersErrors(errorsContainer: Element) {\n  const fileContainer = errorsContainer.closest('.js-blob-code-container, .js-file-content')\n  const tooltipTemplate = errorsContainer.querySelector<HTMLTemplateElement>('.js-codeowners-error-tooltip-template')\n  const lineAlertTemplate = errorsContainer.querySelector<HTMLTemplateElement>(\n    '.js-codeowners-error-line-alert-template'\n  )\n  if (!fileContainer || !tooltipTemplate || !lineAlertTemplate) {\n    return\n  }\n\n  const errors = errorsContainer.querySelectorAll<HTMLElement>('.js-codeowners-error')\n  const listing = new CodeListing(fileContainer)\n\n  for (const error of errors) {\n    if (annotatedErrors.get(error)) {\n      continue\n    }\n\n    const lineNum = error.getAttribute('data-line')\n    const kind = error.getAttribute('data-kind')\n    const suggestion = error.getAttribute('data-suggestion')\n    const startOffset = parseInt(error.getAttribute('data-start-offset') || '', 10)\n    const endOffset = parseInt(error.getAttribute('data-end-offset') || '', 10)\n\n    const line = listing.findLine(lineNum)\n    const range = line?.range(startOffset, endOffset)\n\n    if (!line || !range) {\n      continue\n    }\n\n    let message = kind\n    if (suggestion) {\n      message += `: ${suggestion}`\n    }\n\n    // Our highlight and tooltip styles both use the `::after`\n    // pseudo element, so we have to apply them to different elements.\n    const highlight = document.createElement('SPAN')\n    highlight.className = 'error-highlight'\n    range.surroundContents(highlight)\n\n    const tooltip = new TemplateInstance(tooltipTemplate, {message}).firstElementChild\n    range.surroundContents(tooltip!)\n\n    const lineAlertElement = new TemplateInstance(lineAlertTemplate, {})\n    line.numberElement.appendChild(lineAlertElement)\n\n    annotatedErrors.set(error, true)\n  }\n}\nobserve('.js-codeowners-errors', annotateCodeownersErrors)\non('expander:expanded', '.js-file', function (event: Event) {\n  if (!event.target || !(event.target instanceof HTMLElement)) {\n    return\n  }\n\n  const errorsContainer = event.target.querySelector<HTMLElement>('.js-codeowners-errors')\n  if (!errorsContainer) {\n    return\n  }\n\n  annotateCodeownersErrors(errorsContainer)\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nfunction changeSelection(event: Event) {\n  const input = event.target as HTMLElement\n  const container = input?.closest<HTMLDetailsElement>('.js-branch-protection-integration-select')\n  const currentSelection = container?.querySelector<HTMLElement>('.js-branch-protection-integration-select-current')\n  const item = input?.closest<HTMLElement>('.js-branch-protection-integration-select-item')\n  const label = item?.querySelector<HTMLElement>('.js-branch-protection-integration-select-label')\n  if (currentSelection && label && container) {\n    currentSelection.innerHTML = label.innerHTML\n    container.open = false\n  }\n}\n\non('change', '.js-branch-protection-integration-select-input', changeSelection)\n","// Bulk actions\n//\n// Provides a way to update bulk actions buttons/menus from a fetched url\n// when check boxes are updated.\n//\n//     <div class=\"js-bulk-actions-container\" data-bulk-actions-url=\"/bulk/actions/url\" data-bulk-actions-parameter=\"member_ids\">\n//       <div class=\"js-bulk-actions\">\n//         <!-- buttons/menus to be updated -->\n//       </div>\n//\n//       <div class=\"js-bulk-actions-item\" data-bulk-actions-id=\"1\">\n//         <input type=\"checkbox\" class=\"js-bulk-actions-toggle\">\n//       </div>\n//     </div>\n//\n// If [data-bulk-actions-parameter] is not assigned, `input.js-bulk-actions-toggle`'s name and value will be used instead.\n//\n//     <div class=\"js-bulk-actions-container\" data-bulk-actions-url=\"/bulk/actions/url\">\n//       <div class=\"js-bulk-actions\">\n//         <!-- buttons/menus to be updated -->\n//       </div>\n//\n//       <input type=\"checkbox\" name=\"member_ids[]\" value=\"1\" class=\"js-bulk-actions-toggle\">\n//     </div>\n//\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {debounce} from '@github/mini-throttle'\n\n// Get the bulk-actions-url from the container.\nfunction bulkUrl(container: Element): string {\n  const url = new URL(container.getAttribute('data-bulk-actions-url')!, window.location.origin)\n  const params = new URLSearchParams(url.search.slice(1))\n  const name = container.getAttribute('data-bulk-actions-parameter')\n  const checkedItems = Array.from(container.querySelectorAll<HTMLInputElement>('.js-bulk-actions-toggle:checked'))\n  if (name) {\n    const ids = checkedItems\n      .map(el => el.closest<HTMLElement>('.js-bulk-actions-item')!.getAttribute('data-bulk-actions-id')!)\n      .sort()\n    for (const id of ids) {\n      params.append(`${name}[]`, id)\n    }\n  } else {\n    for (const input of checkedItems.sort((a, b) => (a.value > b.value ? 1 : -1))) {\n      params.append(input.name, input.value)\n    }\n  }\n\n  url.search = params.toString()\n  return url.toString()\n}\n\nlet previousController: AbortController | null = null\n// Update the bulk actions container with new HTML fetched from the server.\nasync function updateBulkActions(event: Event) {\n  const container = event.target\n  if (!(container instanceof HTMLElement)) return\n  const actionsContainer = container.querySelector<HTMLElement>('.js-bulk-actions')!\n  const isItemSelected = !!container.querySelector('.js-bulk-actions-toggle:checked')\n\n  previousController?.abort()\n  const {signal} = (previousController = new AbortController())\n  let html = ''\n  try {\n    // TODO: Drop `X-Requested-With` header once controllers are cleaned up of `request.xhr?`\n    const response = await fetch(bulkUrl(container), {signal, headers: {'X-Requested-With': 'XMLHttpRequest'}})\n    if (!response.ok) return\n    html = await response.text()\n  } catch {\n    // Ignore network errors\n  }\n  if (signal.aborted) return\n  if (!html) return\n\n  if (!isItemSelected) {\n    actionsContainer.innerHTML = html\n    toggleMembershipTabs(container)\n  } else {\n    toggleMembershipTabs(container)\n    actionsContainer.innerHTML = html\n  }\n\n  fire(container, 'bulk-actions:updated')\n}\n\n// Toggle the membership tabs based on the amount of checked bulk-actions.\nfunction toggleMembershipTabs(container: HTMLElement) {\n  const membershipTabs = document.querySelector('.js-membership-tabs')\n  if (membershipTabs) {\n    const checked = container.querySelectorAll('.js-bulk-actions-toggle:checked')\n    /* eslint-disable-next-line github/no-d-none */\n    membershipTabs.classList.toggle('d-none', checked.length > 0)\n  }\n}\n\non('change', '.js-bulk-actions-toggle', function (event) {\n  const toggle = event.currentTarget\n  const container = toggle.closest<HTMLElement>('.js-bulk-actions-container')!\n  fire(container, 'bulk-actions:update')\n})\n\non('bulk-actions:update', '.js-bulk-actions-container', debounce(updateBulkActions, 100))\n","import {loaded} from '../document-ready'\nimport {sendStats} from '../stats'\n\ntype Ok<T> = {kind: 'ok'; value: T | null}\ntype Err<E> = {kind: 'err'; value: E}\ntype Result<T, E> = Ok<T> | Err<E>\n\nfunction getLocalJSON<T>(key: string): Result<T, Error> {\n  try {\n    const text = window.localStorage.getItem(key)\n    return {kind: 'ok', value: text ? JSON.parse(text) : null}\n  } catch (e) {\n    return {kind: 'err', value: e}\n  }\n}\n\nfunction setLocalJSON<T>(key: string, value: T): Result<null, Error> {\n  try {\n    window.localStorage.setItem(key, JSON.stringify(value))\n    return {kind: 'ok', value: null}\n  } catch (e) {\n    return {kind: 'err', value: e}\n  }\n}\n\nfunction gatherBundleURLs() {\n  const urls: {[key: string]: string} = {}\n  for (const script of document.getElementsByTagName('script')) {\n    const match = script.src.match(/\\/([\\w-]+)-[0-9a-f]{8,}\\.js$/)\n    if (match) urls[`${match[1]}.js`] = script.src\n  }\n  for (const link of document.getElementsByTagName('link')) {\n    const match = link.href.match(/\\/([\\w-]+)-[0-9a-f]{8,}\\.css$/)\n    if (match) urls[`${match[1]}.css`] = link.href\n  }\n  return urls\n}\n\ntype Bundles = Record<string, string>\n\nfunction report() {\n  const urls = gatherBundleURLs()\n  const read = getLocalJSON<Bundles>('bundle-urls')\n  if (read.kind === 'err') {\n    setLocalJSON('bundle-urls', urls)\n    return\n  }\n  const previousURLs = read.value || {}\n  const downloadedBundles = Object.keys(urls).filter(bundle => previousURLs[bundle] !== urls[bundle])\n  if (downloadedBundles.length) {\n    const write = setLocalJSON('bundle-urls', {...previousURLs, ...urls})\n    if (write.kind === 'ok') {\n      sendStats({downloadedBundles})\n    }\n  }\n}\n\n;(async () => {\n  await loaded\n  window.requestIdleCallback(report)\n})()\n","// Behaviors complementing buttons or minibuttons\n//\n// See also\n//   primer/buttons.scss\n//\n\nimport {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nfunction cancelEvent(event: Event) {\n  event.preventDefault()\n  event.stopPropagation()\n}\n\n// Prevent minibutton click if target is disabled\nobserve('a.btn.disabled', {\n  subscribe: el => fromEvent(el, 'click', cancelEvent)\n})\n","import {deleteCookie, getCookies} from '../cookies'\n\n// This module detects a logout that has just occurred and clears browser data\n// for the origin that might contain sensitive things such as localstorage.\n\n// Set by lib/github/authentication/logout_result.rb on logout\nexport const JustLoggedOutCookieName = 'logout-was-successful'\n\nfunction clearData() {\n  for (const storage of [sessionStorage, localStorage]) {\n    try {\n      storage.clear()\n    } catch {\n      // ignore failure to clear\n    }\n  }\n}\n\nexport function clearDataIfJustLoggedOut() {\n  if (getCookies(JustLoggedOutCookieName).length > 0) {\n    clearData()\n    deleteCookie(JustLoggedOutCookieName)\n  }\n}\n\nclearDataIfJustLoggedOut()\n","import {announceFromElement} from '../aria-live'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nconst duration = 2000\n\non('clipboard-copy', '[data-copy-feedback]', event => {\n  const clipboardCopyElement = event.currentTarget\n  const message = clipboardCopyElement.getAttribute('data-copy-feedback')!\n  const originalLabel = clipboardCopyElement.getAttribute('aria-label')\n  const direction = clipboardCopyElement.getAttribute('data-tooltip-direction') || 's'\n\n  clipboardCopyElement.setAttribute('aria-label', message)\n  clipboardCopyElement.classList.add('tooltipped', `tooltipped-${direction}`)\n  if (!(clipboardCopyElement instanceof HTMLElement)) return\n  announceFromElement(clipboardCopyElement)\n\n  setTimeout(() => {\n    if (originalLabel) {\n      clipboardCopyElement.setAttribute('aria-label', originalLabel)\n    } else {\n      clipboardCopyElement.removeAttribute('aria-label')\n    }\n    clipboardCopyElement.classList.remove('tooltipped', `tooltipped-${direction}`)\n  }, duration)\n})\n\nfunction timerCallback(currentTarget: HTMLElement) {\n  clipboardCopyElementTimers.delete(currentTarget)\n  toggleCopyButton(currentTarget)\n}\n\n// Toggle a copy button.\nfunction toggleCopyButton(button: HTMLElement) {\n  const copyIcon = button.querySelector('.js-clipboard-copy-icon')\n  const checkIcon = button.querySelector('.js-clipboard-check-icon')\n\n  button.classList.toggle('ClipboardButton--success')\n\n  if (copyIcon) {\n    /* eslint-disable-next-line github/no-d-none */\n    copyIcon.classList.toggle('d-none')\n  }\n  if (checkIcon) {\n    if (checkIcon.classList.contains('d-sm-none')) {\n      checkIcon.classList.toggle('d-sm-none')\n    } else {\n      /* eslint-disable-next-line github/no-d-none */\n      checkIcon.classList.toggle('d-none')\n    }\n  }\n}\n\nconst clipboardCopyElementTimers = new WeakMap<HTMLElement, number>()\n\non('clipboard-copy', '.js-clipboard-copy:not([data-view-component])', function ({currentTarget}) {\n  if (!(currentTarget instanceof HTMLElement)) return\n\n  const currentTimeout = clipboardCopyElementTimers.get(currentTarget)\n  if (currentTimeout) {\n    clearTimeout(currentTimeout)\n  } else {\n    toggleCopyButton(currentTarget)\n  }\n\n  clipboardCopyElementTimers.set(currentTarget, window.setTimeout(timerCallback, duration, currentTarget))\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// When a code nav response returns precise and search-based backends,\n// we allow the user to retry their code nav query with the alternative\n// backend.  This observe block is responsible for handling the retry\n// logic,  making the async fetch request,  and updating the\n// code nav modal with the new response.\non('click', '.js-code-nav-retry', async function (event) {\n  // Ignore clicks with modifier keys\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) return\n  /* eslint-enable no-restricted-syntax */\n\n  const popover = document.querySelector<HTMLElement>('.js-tagsearch-popover')\n  if (!popover) return\n\n  const popoverContent = popover.querySelector<HTMLElement>('.js-tagsearch-popover-content')\n  if (!popoverContent) return\n\n  // Because the definitions endpoint is responsible for rendering\n  // the code nav modal's tabs and content,  a different dom element\n  // target is required for overwriting the html returned from the fetch.\n  let updateTarget: HTMLElement | null\n  const target = event.currentTarget as HTMLElement\n  const codeNavKind = target.getAttribute('data-code-nav-kind')\n  if (codeNavKind === 'definitions') {\n    updateTarget = popover.querySelector<HTMLElement>('.js-tagsearch-popover-content')\n  } else {\n    updateTarget = popover.querySelector<HTMLElement>('.js-code-nav-references')\n  }\n  if (!updateTarget) return\n\n  const retryUrl = target.getAttribute('data-code-nav-url')\n  if (!retryUrl) return\n\n  const codeNavUrl = new URL(retryUrl, window.location.origin)\n  try {\n    const response = await fetch(codeNavUrl.toString(), {\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    })\n    if (!response.ok) {\n      return\n    }\n    const html = await response.text()\n    if (!html) return\n\n    updateTarget.innerHTML = html\n  } catch {\n    return\n  }\n\n  // Because a user has to scroll to trigger this retry behavior,\n  // the code nav modal's scroll will need to be reset.\n  popoverContent.scrollTop = 0\n})\n\nobserve('.js-code-nav-container', {\n  constructor: HTMLElement,\n  subscribe(file) {\n    const repoContainer = file\n    const popover = document.querySelector('.js-tagsearch-popover') as HTMLElement\n    if (!(popover instanceof HTMLElement))\n      return {\n        unsubscribe() {\n          // Used as a no operation placeholder for unsubscribing if there is no popover.\n        }\n      }\n    const popoverContent = popover.querySelector<HTMLElement>('.js-tagsearch-popover-content')!\n    const popoverHTML = new WeakMap()\n    const wrapCache = new WeakMap()\n\n    let activeToken: Element | undefined\n\n    // initialize requires both `popover` and `activeToken` to be defined.\n    initialize()\n\n    // The code nav modal is sticky in the PR view.  When a user navigates to a location from the modal,\n    // and uses the 'back' button,  the code nav modal is still present,  and the active token (click target)\n    // retains the CSS classes added to it by the `onMouseOver()` event listener.\n    // This function ensures regardless of the user's previous navigation actions that the code nav modal is\n    // always reset to hidden on a new blob view, and any previous active token classes are removed from their elements.\n    function initialize() {\n      hidePopover()\n      for (const el of document.getElementsByClassName('pl-token')) {\n        el.classList.remove('pl-token', 'active')\n      }\n    }\n\n    async function onMouseMove(event: MouseEvent) {\n      const range = matchFromPoint(/\\w+[!?]?/g, event.clientX, event.clientY)\n      if (!range) return\n\n      const rangeElement = range.commonAncestorContainer.parentElement!\n      for (const className of rangeElement.classList) {\n        if (['pl-token', 'pl-c', 'pl-s', 'pl-k'].includes(className)) return\n      }\n\n      if (rangeElement.closest('.js-skip-tagsearch')) {\n        return\n      }\n\n      const text = range.toString()\n      if (!text || text.match(/\\n|\\s|[();&.=\",]/)) return\n\n      let didCheckText = wrapCache.get(rangeElement)\n      if (!didCheckText) {\n        didCheckText = new Set()\n        wrapCache.set(rangeElement, didCheckText)\n      }\n      if (didCheckText.has(text)) return\n      didCheckText.add(text)\n\n      const fileContainer = rangeElement.closest('.js-tagsearch-file')\n      if (!fileContainer) return\n\n      const path = fileContainer.getAttribute('data-tagsearch-path') || ''\n      let lang = fileContainer.getAttribute('data-tagsearch-lang') || ''\n\n      // Handle Ruby embedded in ERB templates\n      if (lang === 'HTML+ERB') {\n        if (rangeElement.closest('.pl-sre')) {\n          lang = 'Ruby'\n        } else {\n          return\n        }\n      }\n\n      if (file.classList.contains('js-code-block-container')) {\n        lang = getCodeBlockLanguage(rangeElement) || ''\n        // Ignore any requests where the range element is not in a code block\n        // with a supported language\n        if (!lang) return\n      }\n\n      const pos = getRowAndColumn(range)\n      const html = await fetchPopoverContents(popover, text, lang, pos, path)\n      if (!html) return\n\n      const wrapper = document.createElement('span')\n      wrapper.classList.add('pl-token')\n      wrapper.addEventListener('click', onClick)\n\n      const temp = document.createElement('span')\n      temp.innerHTML = html\n      const details = temp.firstElementChild\n      if (!details) return\n\n      const dataHydroClick = details.getAttribute('data-hydro-click')\n      const dataHydroClickHMAC = details.getAttribute('data-hydro-click-hmac')\n      if (dataHydroClickHMAC && dataHydroClick) {\n        wrapper.setAttribute('data-hydro-click', dataHydroClick)\n        wrapper.setAttribute('data-hydro-click-hmac', dataHydroClickHMAC)\n      }\n\n      popoverHTML.set(wrapper, html)\n      range.surroundContents(wrapper)\n    }\n\n    // Ensure popover list is reset to the top.\n    function resetScrollTop() {\n      popoverContent.scrollTop = 0\n    }\n\n    function onClick(event: MouseEvent) {\n      // Ignore clicks with modifier keys\n      // TODO: Refactor to use data-hotkey\n      /* eslint eslint-comments/no-use: off */\n      /* eslint-disable no-restricted-syntax */\n      if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) return\n      /* eslint-enable no-restricted-syntax */\n\n      const target = event.currentTarget as HTMLElement\n\n      if (target === activeToken) {\n        hidePopover()\n      } else {\n        populatePopover(target)\n        showPopover()\n      }\n\n      event.preventDefault()\n    }\n\n    function populatePopover(token: HTMLElement) {\n      if (activeToken) activeToken.classList.remove('active')\n      activeToken = token\n      activeToken.classList.add('active')\n\n      popoverContent.innerHTML = popoverHTML.get(token) || ''\n\n      positionPopover(token)\n    }\n\n    function positionPopover(token: HTMLElement) {\n      const cRect = repoContainer.getClientRects()[0]\n      const rect = token.getClientRects()[0]\n      popover.style.position = 'absolute'\n      popover.style.zIndex = '2'\n      if (repoContainer.classList.contains('position-relative')) {\n        popover.style.top = `${rect.bottom - cRect.top + 7}px`\n        popover.style.left = `${rect.left - cRect.left - 10}px`\n      } else {\n        popover.style.top = `${window.scrollY + rect.bottom}px`\n        popover.style.left = `${window.scrollX + rect.left}px`\n      }\n    }\n\n    function showPopover() {\n      if (!popover.hidden) {\n        // When existing popover is active and user clicks on different symbol, we need to still reset the navigation tabs and scrollTop for the popover's new contents.\n        resetScrollTop()\n        return\n      }\n      popover.hidden = false\n\n      // Setting a scrollTop value only succeeds if the HTML element is visible.\n      resetScrollTop()\n\n      document.addEventListener('click', onDocumentClick)\n      document.addEventListener('keyup', onKeyup)\n      /* eslint-disable-next-line github/prefer-observers */\n      window.addEventListener('resize', onResize)\n    }\n\n    function hidePopover() {\n      if (popover.hidden) return\n      popover.hidden = true\n\n      if (activeToken) activeToken.classList.remove('active')\n      activeToken = undefined\n\n      document.removeEventListener('click', onDocumentClick)\n      document.removeEventListener('keyup', onKeyup)\n      window.removeEventListener('resize', onResize)\n    }\n\n    function onResize() {\n      if (!(activeToken instanceof HTMLElement)) return\n      positionPopover(activeToken)\n    }\n\n    function onDocumentClick(event: MouseEvent) {\n      const {target} = event\n      if (!(target instanceof Node)) return\n\n      if (!popover.contains(target) && !activeToken!.contains(target)) {\n        hidePopover()\n      }\n    }\n\n    function onKeyup(event: KeyboardEvent) {\n      // TODO: Refactor to use data-hotkey\n      /* eslint eslint-comments/no-use: off */\n      /* eslint-disable no-restricted-syntax */\n      switch (event.key) {\n        case 'Escape':\n          hidePopover()\n          break\n      }\n      /* eslint-enable no-restricted-syntax */\n    }\n\n    file.addEventListener('mousemove', onMouseMove)\n\n    return {\n      unsubscribe() {\n        file.removeEventListener('mousemove', onMouseMove)\n      }\n    }\n  }\n})\n\nasync function fetchPopoverContents(\n  popover: HTMLElement,\n  text: string,\n  lang: string,\n  pos: [number, number],\n  path: string\n): Promise<string> {\n  const urlStr = popover.getAttribute('data-tagsearch-url')\n  if (!urlStr) return ''\n  const ref = popover.getAttribute('data-tagsearch-ref')\n  if (!ref) return ''\n  let codeNavContext = popover.getAttribute('data-tagsearch-code-nav-context')\n  if (!codeNavContext) {\n    codeNavContext = 'UNKNOWN_VIEW'\n  }\n\n  const url = new URL(urlStr, window.location.origin)\n  const params = new URLSearchParams()\n  params.set('q', text)\n  params.set('blob_path', path)\n  params.set('ref', ref)\n  params.set('language', lang)\n  params.set('row', pos[0].toString())\n  params.set('col', pos[1].toString())\n  params.set('code_nav_context', codeNavContext)\n  url.search = params.toString()\n\n  try {\n    const response = await fetch(url.toString(), {\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    })\n    if (!response.ok) {\n      return ''\n    }\n    const html = await response.text()\n\n    // Ignore responses with no definitions\n    if (/js-tagsearch-no-definitions/.test(html)) return ''\n\n    return html\n  } catch {\n    return ''\n  }\n}\n\ninterface CaretPosition {\n  offsetNode: Node\n  offset: number\n}\ndeclare global {\n  interface Document {\n    caretPositionFromPoint(x: number, y: number): CaretPosition | null\n  }\n}\n\n// Returns matching text range given screen offsets.\n//\n// Examples\n//\n//   // Find nearest word under mouse cursor\n//   matchFromPoint(/\\w+/g, event.clientX, event.clientY)\n//\n// Returns Range or null if nothing matches position.\nfunction matchFromPoint(regexp: RegExp, x: number, y: number): Range | undefined | null {\n  let textNode: Node | undefined\n  let offset: number | undefined\n\n  if (document.caretPositionFromPoint) {\n    const caret = document.caretPositionFromPoint(x, y)\n    if (caret) {\n      textNode = caret.offsetNode\n      offset = caret.offset\n    }\n  } else if (document.caretRangeFromPoint) {\n    const range = document.caretRangeFromPoint(x, y)\n    if (range) {\n      textNode = range.startContainer\n      offset = range.startOffset\n    }\n  }\n\n  if (!textNode || typeof offset !== 'number' || textNode.nodeType !== Node.TEXT_NODE) return\n\n  const text = textNode.textContent\n  if (!text) return null\n\n  const match = findNearestMatch(text, regexp, offset)\n  if (!match) return null\n\n  const matchedRange = document.createRange()\n  matchedRange.setStart(textNode, match[1])\n  matchedRange.setEnd(textNode, match[2])\n\n  return matchedRange\n}\n\n// Find nearest match in string given a starting offset.\n//\n// Similar to String#scan, but only returns one result around the given offset.\n//\n// Examples\n//\n//   findNearestMatch(\"The quick brown fox jumps over the lazy dog\", /\\w+/g, 1)\n//   // [\"The\", 0, 3]\n//\n//   findNearestMatch(\"The quick brown fox jumps over the lazy dog\", /\\w+/g, 18)\n//   [\"fox\", 16, 19]\n//\n// Return matching string, start and end offsets. Otherwise returns null for no match.\nexport function findNearestMatch(str: string, regexp: RegExp, offset: number): [string, number, number] | null {\n  let m\n  while ((m = regexp.exec(str))) {\n    const len = m.index + m[0].length\n    if (m.index <= offset && offset < len) {\n      return [m[0], m.index, len]\n    }\n  }\n  return null\n}\n\n// Get the language name of the embedded code block that the given element is\n// located in. This will be used for files such as Markdown that can contain\n// nested code blocks in multiple languages.\n//\n// Return language name or null\nfunction getCodeBlockLanguage(element: Element): string | null {\n  // FIXME Use js- class or data attributes for the language lookup/mappings\n  const codeBlockElement = element.closest('.highlight')\n  if (codeBlockElement) {\n    for (const className of codeBlockElement.classList) {\n      switch (className) {\n        case 'highlight-source-go':\n          return 'Go'\n        case 'highlight-source-js':\n          return 'JavaScript'\n        case 'highlight-source-python':\n          return 'Python'\n        case 'highlight-source-ruby':\n          return 'Ruby'\n        case 'highlight-source-ts':\n          return 'TypeScript'\n      }\n    }\n  }\n\n  return null\n}\n\n// Returns a zero-indexed position of the range in utf16 code units.\nexport function getRowAndColumn(range: Range): [number, number] {\n  let node = range.startContainer\n  let offset = range.startOffset\n  let passParent = false\n  for (;;) {\n    let prev = node.previousSibling\n    while (!passParent && prev) {\n      // Diff views include additional DOM elements like comments and buttons that\n      // don't appear in the DOM for regular blob views. HTML Comment and Button nodes\n      // should not be included when calculating the offset (or column position). We only\n      // want to count text that appears in the repository, so that the resulting column position\n      // will align with the column position indexed by the code-navigation service for the symbol\n      // under the user's cursor.\n      if (!['#comment', 'BUTTON'].includes(prev.nodeName)) {\n        offset += (prev.textContent || '').length\n      }\n      prev = prev.previousSibling\n    }\n    const parent = node.parentElement\n    if (parent) {\n      if (parent.classList.contains('js-code-nav-pass')) {\n        // Compared with the standard blob view, the DOM structure in diff views is slightly different.\n        // To make sure we don't over count the offset for the clicked symbol, some DOM elements'\n        // text content should not be considered when calculating the symbol's column offset.\n        // This conditional signals to not count any additional offsets until the parent DOM\n        // element containing the symbol's line number is found.\n        passParent = true\n      } else if (parent.classList.contains('js-file-line')) {\n        const lineNumber = parent.previousElementSibling!\n        if (!lineNumber.classList.contains('js-code-nav-line-number')) {\n          throw new Error('invariant')\n        }\n        const row = parseInt(lineNumber.getAttribute('data-line-number') || '1', 10)\n        return [row - 1, offset]\n      }\n      node = parent\n    } else {\n      return [0, 0]\n    }\n  }\n}\n","// Commenting: AJAX form submission\n//\n// Markup\n//\n//     <form class=\"js-new-comment-form\">\n//       <div class=\"js-comment-form-error\" hidden>\n//       </div>\n//\n//       <textarea class=\"js-comment-field\"></textarea>\n//\n//       <button type=\"submit\">\n//         Comment\n//       </button>\n//     </form>\n//\n// Primer Validation example:\n// see: https://primer.style/css/components/forms#form-group-validation\n//\n//   <form class=\"js-new-comment-form\">\n//     <div class=\"form-group js-remove-error-state-on-click\">\n//       <textarea class=\"js-comment-field\" aria-describedby=\"body-input-validation\",\n//       </textarea>\n//\n//       <p class=\"note error js-comment-form-error\" id=\"body-input-validation\" hidden></p>\n//\n//       <button type=\"submit\">\n//         Comment\n//       </button>\n//     </div>\n//   </form>\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport type {ErrorWithResponse} from '@github/remote-form'\nimport {changeValue} from '../../form'\nimport {remoteForm} from '@github/remote-form'\nimport {replaceContent} from '../../updatable-content'\n\n// Hide any comment errors on retry.\nfunction clearFormError(form: Element) {\n  const formError = form.querySelector('.js-comment-form-error')\n  if (formError instanceof HTMLElement) {\n    formError.hidden = true\n  }\n}\n\n// Remove error state when Primer Form Validation enabled field is clicked on\non('click', '.errored.js-remove-error-state-on-click', function ({currentTarget}) {\n  currentTarget.classList.remove('errored')\n})\n\n// Reset form after AJAX request is successful\nremoteForm('.js-new-comment-form', async function (form, wants) {\n  let response\n  clearFormError(form)\n  try {\n    response = await wants.json()\n  } catch (error) {\n    handleFormError(form, error)\n  }\n\n  if (!response) {\n    return\n  }\n\n  form.reset()\n  for (const field of form.querySelectorAll<HTMLInputElement>('.js-resettable-field')) {\n    changeValue(field, field.getAttribute('data-reset-value') || '')\n  }\n  const writeTab = form.querySelector('.js-write-tab')\n  if (writeTab instanceof HTMLElement) {\n    writeTab.click()\n  }\n  const ref = response.json.updateContent\n\n  for (const selector in ref) {\n    const html = ref[selector]\n    const el = document.querySelector(selector)\n    if (el instanceof HTMLElement) {\n      replaceContent(el, html)\n    } else {\n      // eslint-disable-next-line no-console\n      console.warn(`couldn't find ${selector} for immediate update`)\n    }\n  }\n\n  fire(form, 'comment:success')\n})\n\n// Show comment error if ajax request fails.\nfunction handleFormError(form: Element, error: ErrorWithResponse) {\n  // eslint-disable-next-line i18n-text/no-en\n  let message = \"You can't comment at this time\"\n  if (error.response && error.response.status === 422) {\n    const data = error.response.json\n    if (data.errors) {\n      if (Array.isArray(data.errors)) {\n        message += `  your comment ${data.errors.join(', ')}`\n      } else {\n        message = data.errors\n      }\n    }\n  }\n\n  message += '. '\n\n  const formError = form.querySelector('.js-comment-form-error')\n  if (formError instanceof HTMLElement) {\n    formError.textContent = message\n    formError.hidden = false\n\n    const formGroupValidationFormWrapper = formError.closest('div.form-group.js-remove-error-state-on-click')\n\n    if (formGroupValidationFormWrapper) {\n      formGroupValidationFormWrapper.classList.add('errored')\n    }\n  }\n}\n","// Commenting: Close button\n//\n// When comment fields also have a \"Close\" button, update the copy of the\n// button when text is present to indicate that the form will both post a\n// comment and close the discussion.\n//\n// Markup\n//\n//     <form>\n//       <textarea class=\"js-comment-field\"></textarea>\n//       <div>\n//         <button type=\"submit\">Comment</button>\n//         <button type=\"submit\" class=\"js-comment-and-button\"\n//           data-comment-text=\"Close with comment\">\n//           Close\n//         </button>\n//       </div>\n//     </form>\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nconst setButtonText = (button: HTMLButtonElement, hasValue: boolean) => {\n  const spanText = button.querySelector('.js-form-action-text')\n  const textTarget = spanText ? spanText : button\n  textTarget.textContent = hasValue\n    ? button.getAttribute('data-comment-text')!\n    : textTarget.getAttribute('data-default-action-text')!\n}\n\nconst createInputHandler = (button: HTMLButtonElement): ((event: Event) => void) => {\n  let previousHasValue: string\n\n  // Handle input.\n  return (event: Event) => {\n    const target = event.currentTarget\n    const newValue = (target as HTMLInputElement).value.trim()\n\n    if (newValue !== previousHasValue) {\n      previousHasValue = newValue\n      setButtonText(button, Boolean(newValue))\n    }\n  }\n}\n\nobserve('.js-comment-and-button', {\n  constructor: HTMLButtonElement,\n  initialize(button) {\n    const commentField = button.form!.querySelector<HTMLElement>('.js-comment-field')!\n    const handleInput = createInputHandler(button)\n\n    return {\n      add() {\n        commentField.addEventListener('input', handleInput)\n        commentField.addEventListener('change', handleInput)\n      },\n      remove() {\n        commentField.removeEventListener('input', handleInput)\n        commentField.removeEventListener('change', handleInput)\n      }\n    }\n  }\n})\n","// Commenting: Focus CSS hacks\n//\n// Bubbles js-comment-field focus state up to js-write-bucket.\n//\n// So we can have a focused ring around the drag and drop section.\n//\n// TODO: `focused` class should be `is-focused`\n\nimport {onFocus} from '../../onfocus'\n\n// Sync focused class.\nfunction toggleFocus(el: Element, focused: boolean) {\n  const container = el.closest('.js-write-bucket')\n  if (container) {\n    container.classList.toggle('focused', focused)\n  }\n}\n\n// Clean up focused class on blur.\nfunction blurred(event: Event) {\n  const el = event.currentTarget\n  if (el instanceof Element) {\n    toggleFocus(el, false)\n  }\n}\n\nonFocus('.js-comment-field', function (el) {\n  toggleFocus(el, true)\n  el.addEventListener('blur', blurred, {once: true})\n})\n","// Scan an ArrayBuffer as PNG, yielding each chunk along the way.\n//\n// Example:\n//\n//   scanner = new PNGScanner buffer\n//   scanner.scan (chunkType, chunkLength) ->\n//     if chunkType is \"IHDR\"\n//       imageWidth = @readLong()\n//       imageHeight = @readLong()\n//\n// The callback will get called for each PNG chunk as described in\n// http://www.w3.org/TR/PNG/#11Chunks. During the callback, the scanner will be\n// positioned on the start of chunk's data portion, where individual values are\n// accessible with:\n//\n// - readChar(): reads 1-byte value (uint8)\n// - readShort(): reads 2-byte value (uint16)\n// - readLong(): reads 4-byte value (uint32)\n// - readString(length): reads <length> ASCII characters as a string\n// - advance(bytes): skips <bytes> bytes forward\n//\n// Scanning will end if the callback returns `false` at any point.\n\nconst PNG_HEADER = 0x89504e47\nconst CRC_WIDTH = 4\n\nexport default class PNGScanner {\n  dataview: DataView\n  pos: number\n\n  static fromFile(file: Blob): Promise<PNGScanner> {\n    return new Promise(function (resolve, reject) {\n      const reader = new FileReader()\n      reader.onload = function () {\n        resolve(new PNGScanner(reader.result as ArrayBuffer))\n      }\n      reader.onerror = function () {\n        reject(reader.error)\n      }\n      reader.readAsArrayBuffer(file)\n    })\n  }\n\n  constructor(buffer: ArrayBuffer) {\n    this.dataview = new DataView(buffer)\n    this.pos = 0\n  }\n\n  advance(bytes: number) {\n    this.pos += bytes\n  }\n\n  readInt(bytes: 1 | 2 | 4) {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    const self = this\n\n    // I want the do { } syntax *so* bad.\n    const value = (function () {\n      switch (bytes) {\n        case 1:\n          return self.dataview.getUint8(self.pos)\n        case 2:\n          return self.dataview.getUint16(self.pos)\n        case 4:\n          return self.dataview.getUint32(self.pos)\n        default:\n          // I shouldn't need this, but flow can't figure out that all values of bytes are handled by the above switch\n          throw new Error('bytes parameter must be 1, 2 or 4')\n      }\n    })()\n    this.advance(bytes)\n    return value\n  }\n\n  readChar() {\n    return this.readInt(1)\n  }\n\n  readShort() {\n    return this.readInt(2)\n  }\n\n  readLong() {\n    return this.readInt(4)\n  }\n\n  readString(length: number): string {\n    const buf = []\n    for (let i = 0; i < length; i++) {\n      buf.push(String.fromCharCode(this.readChar()))\n    }\n    return buf.join('')\n  }\n\n  scan(fn: (this: PNGScanner, type: string, len: number) => boolean) {\n    if (this.readLong() !== PNG_HEADER) {\n      throw new Error('invalid PNG')\n    }\n\n    this.advance(4)\n\n    for (;;) {\n      const len = this.readLong()\n      const type = this.readString(4)\n      const resumeAt = this.pos + len + CRC_WIDTH\n      if (fn.call(this, type, len) === false || type === 'IEND') {\n        break\n      }\n      this.pos = resumeAt\n    }\n  }\n}\n","import PNGScanner from './png-scanner'\n\nconst METERS_PER_INCH = 0.0254\n\nexport type ImageDimensions = {\n  width: number\n  height: number\n  ppi: number\n}\n\n// Returns a Promise that resolves with an object indicating:\n//\n// - width: image width in pixels\n// - height: image height in pixels\n// - ppi: pixels-per-inch count (optional)\n//\n// Only PNG file uploads are supported at the moment. All other types will\n// resolve with an empty metadata object.\nexport default async function imageDimensions(file: File): Promise<ImageDimensions | null> {\n  if (file.type !== 'image/png') {\n    return null\n  }\n  const slice = file.slice(0, 10240, file.type)\n  const scanner = await PNGScanner.fromFile(slice)\n  const meta = {\n    width: 0,\n    height: 0,\n    ppi: 1\n  }\n\n  scanner.scan(function (type) {\n    switch (type) {\n      case 'IHDR': {\n        /* eslint-disable-next-line @typescript-eslint/no-invalid-this */\n        meta.width = this.readLong()\n        /* eslint-disable-next-line @typescript-eslint/no-invalid-this */\n        meta.height = this.readLong()\n        return true\n      }\n      case 'pHYs': {\n        /* eslint-disable-next-line @typescript-eslint/no-invalid-this */\n        const ppuX = this.readLong()\n        /* eslint-disable-next-line @typescript-eslint/no-invalid-this */\n        const ppuY = this.readLong()\n        /* eslint-disable-next-line @typescript-eslint/no-invalid-this */\n        const unit = this.readChar()\n        let inchesRatio\n        if (unit === 1) {\n          inchesRatio = METERS_PER_INCH\n        }\n        if (inchesRatio) {\n          meta.ppi = Math.round(((ppuX + ppuY) / 2) * inchesRatio)\n        }\n        return false\n      }\n      case 'IDAT': {\n        return false\n      }\n    }\n\n    return true\n  })\n\n  return meta\n}\n","import type {CaretCoordinates} from '@koddsson/textarea-caret'\nimport getCaretCoordinates from '@koddsson/textarea-caret'\n\ntype CaretCache = Map<number, CaretPosition>\nconst inputCache = new WeakMap<HTMLElement, CaretCache>()\n\n/**\n * Bundles together the caret coordinates and the caret's\n * index within a given textarea\n */\nclass CaretPosition {\n  index: number\n  coords: CaretCoordinates\n  textArea: HTMLTextAreaElement\n\n  constructor(index: number, coords: CaretCoordinates, textArea: HTMLTextAreaElement) {\n    this.index = index\n    this.coords = coords\n    this.textArea = textArea\n  }\n\n  get top() {\n    return this.coords.top\n  }\n\n  get left() {\n    return this.coords.left\n  }\n\n  get height() {\n    return this.coords.height\n  }\n\n  currentChar(lookBack = 1) {\n    return this.textArea.value.substring(this.index - lookBack, this.index)\n  }\n  /**\n   * Compare the line of the y coordinates to the caret.\n   * Returns -1 if y is on a previous line\n   * Returns 1 if y is on a subsequent line\n   * Returns 0 if y is on the same line\n   */\n  checkLine(y: number): -1 | 0 | 1 {\n    if (y < this.coords.top) {\n      return -1\n    }\n\n    if (y > this.coords.top + this.coords.height) {\n      return 1\n    }\n\n    return 0\n  }\n\n  /**\n   * The absolute horizontal distance between the x position and the\n   * caret's x position.\n   */\n  xDistance(x: number): number {\n    return Math.abs(this.left - x)\n  }\n}\n\n/**\n * Get the cached x/y coordinates for the given caret index and textarea.\n */\nfunction fetchCaretCoords(textArea: HTMLTextAreaElement, caretIndex: number): CaretPosition {\n  let caretCache\n  if (inputCache.has(textArea)) {\n    caretCache = inputCache.get(textArea)!\n  } else {\n    caretCache = new Map()\n    inputCache.set(textArea, caretCache)\n  }\n\n  if (caretCache.has(caretIndex)) {\n    return caretCache.get(caretIndex)\n  } else {\n    // calling getCaretCoordinates(textArea, caretIndex, {debug: true})\n    // will append a div to the document showing you where `textarea-caret` thinks the caret is\n    const coords = new CaretPosition(caretIndex, getCaretCoordinates(textArea, caretIndex), textArea)\n    caretCache.set(caretIndex, coords)\n    return coords\n  }\n}\n\n/**\n * This function recursively searches for the caret index that corresponds to the given coordinates.\n * We keep track of the number of iterations purely for logging to the console during\n * this PR.\n */\nconst binaryCursorSearch = (\n  textArea: HTMLTextAreaElement,\n  lower: number,\n  upper: number,\n  mouseX: number,\n  mouseY: number,\n  iterations: number\n): number => {\n  if (upper === lower) {\n    return upper\n  }\n\n  /**\n   * Out of our final candidates, eliminate any that aren't on the same line as the mouse position.\n   * Pick the one that's closest in the x direction.\n   *\n   * If _none_ of the candidates are on the same line, bail and arbitrarily return the upper bound\n   */\n  const bestPosition = (candidates: CaretPosition[]): number => {\n    const sameLineCandidates = candidates\n      .filter(c => c.checkLine(mouseY) === 0)\n      .sort((a, b) => (a.xDistance(mouseX) > b.xDistance(mouseX) ? 1 : -1))\n    if (sameLineCandidates.length === 0) {\n      return upper\n    } else {\n      return sameLineCandidates[0].index\n    }\n  }\n  // if we're down to two or three positions check them all\n  if (upper - lower === 1) {\n    const l = fetchCaretCoords(textArea, lower)\n    const u = fetchCaretCoords(textArea, upper)\n    return bestPosition([l, u])\n  }\n\n  if (upper - lower === 2) {\n    const l = fetchCaretCoords(textArea, lower)\n    const m = fetchCaretCoords(textArea, upper - 1)\n    const u = fetchCaretCoords(textArea, upper)\n\n    return bestPosition([l, m, u])\n  }\n\n  // The new midpoint is halfway between the upper and lower bounds\n  // If that ends up being the same as the upper or lower, it means we've descended\n  // all the way to the bottom of our search tree. We don't backtrack.\n  const mid = Math.floor((upper + lower) / 2)\n  if (mid === lower || mid === upper) {\n    return mid\n  }\n  const midCoords = fetchCaretCoords(textArea, mid)\n\n  // If the midpoint caret position is below the mouse coordinates, we need to search\n  // farther along in the textarea\n  if (mouseY > midCoords.top + midCoords.height) {\n    return binaryCursorSearch(textArea, mid + 1, upper, mouseX, mouseY, iterations + 1)\n  }\n\n  // If the midpoint caret position is above the mouse coordinates, we need to search\n  // behind the current midpoint in the textarea\n  if (mouseY < midCoords.top) {\n    return binaryCursorSearch(textArea, lower, mid - 1, mouseX, mouseY, iterations + 1)\n  }\n\n  // if we're within a few pixels, avoid further searching\n  const ETA = 3\n  if (midCoords.xDistance(mouseX) < ETA) {\n    return mid\n  }\n\n  // if mid is on the same line as the cursor, we need to check the x position\n  if (midCoords.left < mouseX) {\n    // if iterating further will cause us to change lines, stop here\n    if (fetchCaretCoords(textArea, mid + 1).checkLine(mouseY) !== 0) {\n      return mid\n    }\n    return binaryCursorSearch(textArea, mid + 1, upper, mouseX, mouseY, iterations + 1)\n  }\n\n  if (midCoords.left > mouseX) {\n    // if iterating further will cause us to change lines, stop here\n    if (fetchCaretCoords(textArea, mid - 1).checkLine(mouseY) !== 0) {\n      return mid\n    }\n\n    return binaryCursorSearch(textArea, lower, mid - 1, mouseX, mouseY, iterations + 1)\n  }\n\n  return mid\n}\n\n/**\n * The driver function for the binary search.\n */\nconst findCursorPosition = (textArea: HTMLTextAreaElement, x: number, y: number): number => {\n  const startIndex = 0\n  const endIndex = textArea.value.length - 1\n  const iterations = 0\n  return binaryCursorSearch(textArea, startIndex, endIndex, x, y, iterations)\n}\n\n/**\n * Assigns the final cursor position after finding it\n */\nfunction setCursorPosition(textarea: HTMLTextAreaElement, x: number, y: number) {\n  const newPosition = findCursorPosition(textarea, x, y)\n\n  textarea.setSelectionRange(newPosition, newPosition)\n}\n\n/**\n * Sets the caret in a textarea based on a DragEvent within that textarea.\n * Unfortunately there's no html api to do that directly (x/y -> caret). This function uses an iterative\n * approach to find the caret position from the x/y coordinates of the drag event.\n *\n * Under the hood we use the [textarea-caret npm package](https://www.npmjs.com/package/textarea-caret)\n * to find the x/y coordinates of the caret based on the caret index, and feed those results into a binary search.\n *\n * We use a cache to speed up the search, which is reinitialized when the user drags over the textarea for the first time.\n */\nexport function updateCaret(textArea: HTMLTextAreaElement, dragEvent: DragEvent) {\n  const rect = textArea.getBoundingClientRect()\n  // We want to clear the cache when the user first drags an attachment into the textarea.\n  // It's better to have to recalculate too much than to have a stale cache with wrong results.\n  if (dragEvent.type === 'dragenter') {\n    inputCache.delete(textArea)\n  }\n\n  const x = dragEvent.clientX - rect.left\n  const y = dragEvent.clientY - rect.top + textArea.scrollTop\n  setCursorPosition(textArea, x, y)\n}\n","import {insertText, replaceSelection, replaceText} from '../../text'\nimport {\n  installHTML,\n  installImageLink,\n  installLink,\n  installTable,\n  installText,\n  uninstallHTML,\n  uninstallImageLink,\n  uninstallLink,\n  uninstallTable,\n  uninstallText\n} from '@github/paste-markdown'\nimport type {Attachment} from '@github/file-attachment-element'\nimport type {ImageDimensions} from '../../image-dimensions'\nimport {getCodeEditor} from '../../code-editor'\nimport imageDimensions from '../../image-dimensions'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {updateCaret} from './caret-placement'\n\nobserve('.js-paste-markdown', {\n  constructor: HTMLElement,\n  add(el) {\n    installTable(el)\n    installImageLink(el)\n    installLink(el)\n    installText(el)\n    installHTML(el)\n  },\n  remove(el) {\n    uninstallTable(el)\n    uninstallImageLink(el)\n    uninstallLink(el)\n    uninstallText(el)\n    uninstallHTML(el)\n  }\n})\n\nconst attachmentPlaceholders = new WeakMap<Attachment, string>()\n\n/**\n * Caches the attachment's placeholder text as it was inserted into the `<textarea>` element.\n * This is intended to make removing the placeholder later easier. The sole reason we're doing all\n * of this is because `insertText` sometimes adds a `\\n` before the inserted text, and sometimes doesn't.\n * Rather than adding more logic to figure out what happened, we memoize the result.\n *\n * This is exported so we can use it in testing\n */\nexport function cachePlaceholder(attachment: Attachment, placeholder: string) {\n  attachmentPlaceholders.set(attachment, placeholder)\n}\n\n/**\n *  Gets the cached placeholder for the attachment. Falls back to calculating the replacement text\n *  if there is no entry. The worst case outcome here is that we leave an extra newline character\n *  in the textarea.\n *\n *  This function is only exported for testing purposes\n */\nexport function getPlaceholder(attachment: Attachment): string {\n  return attachmentPlaceholders.get(attachment) || replacementText(attachment)\n}\n\n// Based off `isImage` from @github/file-attachment-element\n// Eventually, we should upstream this\nfunction isVideo(attachment: Attachment): boolean {\n  return ['video/mp4', 'video/quicktime'].includes(attachment.file.type)\n}\n\nfunction parameterizeName(name: string): string {\n  return name\n    .replace(/[[\\]\\\\\"<>&]/g, '.') // Convert unwanted chars to separator\n    .replace(/\\.{2,}/g, '.') // No more than 1 separator in a row\n    .replace(/^\\.|\\.$/gi, '') // Remove leading/trailing separator\n}\n\n// Returns an uploading status message while the file is uploading. The\n// placeholder will be replaced with a URL to the image once the upload\n// is complete.\nfunction placeholderText(attachment: Attachment): string {\n  // Video uploads do not include braces around the text\n  if (isVideo(attachment)) return `\\nUploading ${attachment.file.name}\\n`\n\n  const prefix = attachment.isImage() ? '!' : ''\n  return `${prefix}[Uploading ${attachment.file.name}]()`\n}\n\n// Strips non-word characters from a file name so it's safe to use in a\n// markdown image alt tag without needing to be escaped.\nfunction altText(name: string): string {\n  return parameterizeName(name)\n    .replace(/\\.[^.]+$/, '') // Strip file extension\n    .replace(/\\./g, ' ') // Bring back some white space\n}\n\nconst RETINA_PPI = 72 * 2\n\nfunction disableSubmit(event: CustomEvent & {currentTarget: Element}) {\n  const closestForm = (event.target as HTMLElement).closest('form')!\n  const submitButton = closestForm.querySelector<HTMLButtonElement>('.btn-primary')!\n  submitButton.disabled = true\n}\n\nfunction enableSubmit(event: CustomEvent & {currentTarget: Element}) {\n  const closestForm = (event.target as HTMLElement).closest('form')!\n  const submitButton = closestForm.querySelector<HTMLButtonElement>('.btn-primary')!\n  submitButton.disabled = false\n}\n\ntype CustomEventPayload = CustomEvent & {currentTarget: Element}\n\n/**\n * This function is only exported to make async testing easier\n */\nexport async function onUploadCompleted(event: CustomEventPayload) {\n  const {attachment} = event.detail\n  const target = event.currentTarget\n  let tagText\n  if (attachment.isImage()) {\n    tagText = await imageTag(attachment)\n  } else if (isVideo(attachment)) {\n    tagText = videoMarkdown(attachment)\n  } else {\n    tagText = mdLink(attachment)\n  }\n  // note at this point event.currentTarget is possibly null\n  // see https://developer.mozilla.org/en-US/docs/Web/API/Event/currentTarget\n  setValidityAndLinkText('', tagText, event, target)\n}\n\nfunction mdLink(attachment: Attachment): string {\n  return `[${attachment.file.name}](${attachment.href})`\n}\n\nfunction videoMarkdown(attachment: Attachment): string {\n  return `\\n${attachment.href!}\\n`\n}\n\nasync function imageTag(attachment: Attachment): Promise<string> {\n  const dimensions = await imageSize(attachment.file)\n  const alt = altText(attachment.file.name)\n  const src = attachment.href\n  if (dimensions.ppi === RETINA_PPI) {\n    const width = Math.round(dimensions.width / 2)\n    // eslint-disable-next-line github/unescaped-html-literal\n    return `<img width=\"${width}\" alt=\"${alt}\" src=\"${src}\">`\n  }\n  return `![${alt}](${src})`\n}\n\nasync function imageSize(file: File): Promise<ImageDimensions> {\n  const empty = {width: 0, height: 0, ppi: 0}\n  try {\n    return (await imageDimensions(file)) ?? empty\n  } catch {\n    return empty\n  }\n}\n\n/**\n * When swapping out the placeholder for an image or video, we need\n * to remember to get the extra leading newline for video uploads\n */\nfunction replacementText(attachment: Attachment) {\n  const placeholder = placeholderText(attachment)\n  if (isVideo(attachment)) {\n    return `\\n${placeholder}\\n`\n  } else {\n    return `${placeholder}\\n`\n  }\n}\n\n/**\n * Make the textarea valid and remove the placeholder. The submit button will\n * get enabled outside this function.\n */\nfunction removeFailedUpload(event: CustomEventPayload) {\n  const field = event.currentTarget.querySelector<HTMLTextAreaElement>('.js-comment-field')\n  const textToRemove = getPlaceholder(event.detail.attachment)\n  if (field) {\n    // Regular editor\n    field.setCustomValidity('')\n    replaceText(field, textToRemove, '')\n  } else {\n    // CodeMirror (code editor)\n    const editor = getCodeEditor(event.currentTarget.querySelector<HTMLTextAreaElement>('.js-code-editor')!)!.editor!\n\n    const cursor = editor.getSearchCursor(textToRemove)\n    cursor.findNext()\n    cursor.replace('')\n  }\n}\n\n/**\n *  Updates text inserted in editor for dropped assets, be it a regular editor\n *  (textarea) or a code editor (CodeMirror) editing a Markdown file\n *\n *  If validity is 'uploading', inserts \"[Uploading asset-name](...)\" at cursor,\n *  otherwise replace that placeholder with href\n *\n *  target is only required if event.currentTarget is lost (e.g., after await)\n */\n\nfunction setValidityAndLinkText(\n  validity: 'uploading' | '',\n  tagText: string,\n  event: CustomEventPayload,\n  target?: EventTarget & Element\n) {\n  const field = (target || event.currentTarget).querySelector<HTMLTextAreaElement>('.js-comment-field')!\n  const fileUploadLoadingText = (target || event.currentTarget).querySelector<HTMLSpanElement>(\n    '.js-file-upload-loading-text'\n  )!\n  const placeholder = placeholderText(event.detail.attachment)\n  const {batch} = event.detail\n\n  if (field) {\n    const selectedText = field.value.substring(field.selectionStart, field.selectionEnd)\n    // Regular text editor\n    if (validity === 'uploading') {\n      let insertedPlaceholder\n      if (selectedText.length) {\n        insertedPlaceholder = replaceSelection(field, selectedText, placeholder)\n      } else {\n        insertedPlaceholder = insertText(field, placeholder, {appendNewline: true})\n      }\n      // If things go wrong, the most reliable way we can remove the placeholder\n      // for an attachment is to cache it.  This is mostly so we don't have to\n      // try to figure out if `insertText` added a leading newline into the\n      // textarea\n      attachmentPlaceholders.set(event.detail.attachment, insertedPlaceholder)\n    } else {\n      replaceText(field, placeholder, tagText)\n    }\n    batch.isFinished() ? enableSubmit(event) : disableSubmit(event)\n  } else {\n    // CodeMirror (code editor)\n    const editor = getCodeEditor(\n      (target || event.currentTarget).querySelector<HTMLTextAreaElement>('.js-code-editor')!\n    )!.editor!\n\n    if (validity === 'uploading') {\n      if (editor.getSelection().length) {\n        // replace selected text with placeholder\n        editor.replaceSelection(placeholder)\n      } else {\n        // insert placeholder at cursor\n        const cursor = editor.getCursor()\n        const toReplace = replacementText(event.detail.attachment)\n        editor.replaceRange(toReplace, cursor)\n      }\n    } else {\n      const cursor = editor.getSearchCursor(placeholder)\n      cursor.findNext()\n      cursor.replace(tagText)\n    }\n    batch.isFinished() ? enableSubmit(event) : disableSubmit(event)\n  }\n  if (fileUploadLoadingText) {\n    const fileUploadMessage = fileUploadLoadingText.getAttribute('data-file-upload-message')\n    fileUploadLoadingText.textContent = `${fileUploadMessage} (${batch.uploaded() + 1}/${batch.size})`\n  }\n}\n\non('upload:setup', '.js-upload-markdown-image', function (event) {\n  setValidityAndLinkText('uploading', '', event)\n})\n\non('upload:complete', '.js-upload-markdown-image', onUploadCompleted)\n\non('upload:error', '.js-upload-markdown-image', function (event) {\n  removeFailedUpload(event)\n  const {batch} = event.detail\n  batch.isFinished() ? enableSubmit(event) : disableSubmit(event)\n})\n\nfunction updateCursor(event: DragEvent) {\n  // The file-attachment-element bubbles up dragover and dragenter events after preventing their default\n  // behavior. We want to manually position the cursor in the textarea so that it reflects where the user\n  // will drop the file.\n  event.stopPropagation()\n\n  const attachmentElement = event.currentTarget as HTMLElement\n\n  if (!attachmentElement) return\n\n  const textArea = attachmentElement.querySelector<HTMLTextAreaElement>('.js-comment-field')\n  if (textArea) {\n    updateCaret(textArea, event)\n  } else {\n    const editor = getCodeEditor(attachmentElement.querySelector<HTMLTextAreaElement>('.js-code-editor')!)?.editor\n    if (editor) {\n      const c = editor.coordsChar({left: event.pageX, top: event.pageY})\n      editor.setCursor(c)\n    }\n  }\n}\n\n/**\n * This function isn't used in production, it's only for keeping a fast feedback looop in dev/troubleshooting.\n * To use in dev mode, add\n * ```\n * on('click', 'textarea', debugUpdateCaret)\n * ```\n * to this file and uncomment the `console.log`\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst debugUpdateCaret = (event: MouseEvent) => {\n  const textArea = event.currentTarget as HTMLTextAreaElement\n  const rect = textArea.getBoundingClientRect()\n  const x = event.clientX - rect.left\n  const y = event.clientY - rect.top + textArea.scrollTop\n  // eslint-disable-next-line no-console\n  console.log({\n    x,\n    y,\n    cursor: textArea.selectionStart,\n    t: textArea.value.substring(textArea.selectionStart - 10, textArea.selectionStart)\n  })\n  const d = new DragEvent('dragenter', {clientX: event.clientX, clientY: event.clientY})\n  updateCaret(textArea, d)\n}\n\non('dragenter', 'file-attachment', updateCursor)\n\non('dragover', 'file-attachment', updateCursor)\n\non('upload:invalid', '.js-upload-markdown-image', function (event) {\n  removeFailedUpload(event)\n  const {batch} = event.detail\n  batch.isFinished() ? enableSubmit(event) : disableSubmit(event)\n})\n","// Commenting: Write and Preview tabs\n//\n// Markup\n//\n//     <form class=\"js-new-comment-form\">\n//       <div class=\"js-previewable-comment-form write-selected\"\n//           data-preview-url=\"/preview\">\n//\n//         <ul>\n//           <li><a href=\"#\" class=\"js-write-tab selected\">Write</a></li>\n//           <li><a href=\"#\" class=\"js-preview-tab\">Preview</a></li>\n//         </ul>\n//\n//         <textarea class=\"js-comment-field\"></textarea>\n//\n//       </div>\n//     </form>\n//\n// TODO: Everything should be using js- prefixed classes\n// TODO: Remove all static copy\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport TabContainerElement from '@github/tab-container-element'\nimport memoize from '@github/memoize'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {onKey} from '../../onfocus'\n\n// Finds the CSRF token value in a `js-data-preview-url-csrf` hidden input\n// element in the preview div. If we don't find a token for the preview\n// div, find the CSRF token value in the hidden `authenticity_token` form\n// input to be used in the parent form submission (i.e. the form that this is\n// previewing).\n//\n// Returns the CSRF token String.\nfunction token(container: Element): string {\n  const dataToken = container.querySelector('.js-data-preview-url-csrf')\n  // eslint-disable-next-line github/authenticity-token\n  const formTokenRef = container.closest<HTMLFormElement>('form')!.elements.namedItem('authenticity_token')\n  if (dataToken instanceof HTMLInputElement) {\n    return dataToken.value\n  } else if (formTokenRef instanceof HTMLInputElement) {\n    return formTokenRef.value\n  } else {\n    throw new Error('Comment preview authenticity token not found')\n  }\n}\n\n// Bidirectionally switches between \"Write\" and \"Preview\" tabs.\nfunction activateTab(tab: Element): HTMLElement {\n  const container = tab.closest<HTMLElement>('.js-previewable-comment-form')!\n  const isPreview = tab.classList.contains('js-preview-tab')\n  if (isPreview) {\n    const writeContent = container.querySelector<HTMLElement>('.js-write-bucket')!\n    const previewBody = container.querySelector<HTMLElement>('.js-preview-body')!\n    if (writeContent.clientHeight > 0) {\n      previewBody.style.minHeight = `${writeContent.clientHeight}px`\n    }\n  }\n  container.classList.toggle('preview-selected', isPreview)\n  container.classList.toggle('write-selected', !isPreview)\n  const currentSelectedTabs = container.querySelector<HTMLElement>(\n    '.tabnav-tab.selected, .tabnav-tab[aria-selected=\"true\"]'\n  )!\n  currentSelectedTabs.setAttribute('aria-selected', 'false')\n  currentSelectedTabs.classList.remove('selected')\n  tab.classList.add('selected')\n  tab.setAttribute('aria-selected', 'true')\n  const writeTab = container.querySelector<HTMLElement>('.js-write-tab')!\n  if (isPreview) {\n    // On Apple devices, the Meta (Cmd)+Shift plane is in lower case. So\n    // Cmd+Shift+p is correct, while `Control+P` is also correct.\n    writeTab.setAttribute('data-hotkey', 'Control+P,Meta+Shift+p')\n  } else {\n    writeTab.removeAttribute('data-hotkey')\n  }\n  return container\n}\n\non('click', '.js-write-tab', function (event) {\n  const target = event.currentTarget\n  const commentForm = target.closest<HTMLElement>('.js-previewable-comment-form')!\n  // <tab-container> changes are handled in the `tab-container-change` event handler\n  if (commentForm instanceof TabContainerElement) {\n    setTimeout(() => {\n      commentForm.querySelector<HTMLElement>('.js-comment-field')!.focus()\n    })\n    return\n  }\n\n  const container = activateTab(target)\n  fire(commentForm, 'preview:toggle:off')\n  const pollForm = commentForm.querySelector('.js-discussion-poll-form-component')\n  if (pollForm) {\n    fire(pollForm, 'poll-preview:toggle:off')\n  }\n  setTimeout(() => {\n    container.querySelector<HTMLElement>('.js-comment-field')!.focus()\n  })\n  const toolbar = commentForm.querySelector('markdown-toolbar')\n  if (toolbar instanceof HTMLElement) {\n    toolbar.hidden = false\n  }\n})\n\non('click', '.js-preview-tab', function (event) {\n  const target = event.currentTarget\n  const commentForm = target.closest<HTMLElement>('.js-previewable-comment-form')!\n  // <tab-container> changes are handled in the `tab-container-change` event handler\n  if (commentForm instanceof TabContainerElement) return\n\n  const container = activateTab(target)\n  fire(commentForm, 'preview:toggle:on')\n\n  setTimeout(() => {\n    renderPreview(container)\n  })\n  const toolbar = commentForm.querySelector('markdown-toolbar')\n  if (toolbar instanceof HTMLElement) {\n    toolbar.hidden = true\n  }\n  event.stopPropagation()\n  event.preventDefault()\n})\n\non('tab-container-change', '.js-previewable-comment-form', function (event) {\n  const relatedTarget = event.detail.relatedTarget\n  const isPreviewPanel = relatedTarget && relatedTarget.classList.contains('js-preview-panel')\n  const container = event.currentTarget\n  const writeTab = container.querySelector<HTMLElement>('.js-write-tab')!\n\n  if (isPreviewPanel) {\n    const writeContent = container.querySelector<HTMLElement>('.js-write-bucket')!\n    const previewBody = container.querySelector<HTMLElement>('.js-preview-body')!\n    const skipSizing = previewBody.hasAttribute('data-skip-sizing')\n\n    if (!skipSizing && writeContent.clientHeight > 0) {\n      previewBody.style.minHeight = `${writeContent.clientHeight}px`\n    }\n\n    writeTab.setAttribute('data-hotkey', 'Control+P,Meta+Shift+p')\n    renderPreview(container)\n    const toolbar = container.querySelector('markdown-toolbar')\n    if (toolbar instanceof HTMLElement) {\n      toolbar.hidden = true\n    }\n  } else {\n    writeTab.removeAttribute('data-hotkey')\n    const toolbar = container.querySelector('markdown-toolbar')\n    if (toolbar instanceof HTMLElement) {\n      toolbar.hidden = false\n    }\n\n    const pollForm = document.querySelector('.js-discussion-poll-form-component')\n    if (pollForm) {\n      fire(pollForm, 'poll-preview:toggle:off')\n    }\n  }\n\n  container.classList.toggle('preview-selected', isPreviewPanel)\n  container.classList.toggle('write-selected', !isPreviewPanel)\n})\n\n// Allow triggering preview rendering from outside code\n// TODO Replace event with exported module function.\non('preview:render', '.js-previewable-comment-form', function (event) {\n  const previewTab = (event.target as Element).querySelector<HTMLElement>('.js-preview-tab')!\n  const container = activateTab(previewTab)\n  setTimeout(() => {\n    renderPreview(container)\n    const toolbar = container.querySelector('markdown-toolbar')\n    if (toolbar instanceof HTMLElement) {\n      toolbar.hidden = true\n    }\n  })\n})\n\nfunction previewForm(container: Element): FormData {\n  const text = container.querySelector<HTMLTextAreaElement>('.js-comment-field')!.value\n  const path = container.querySelector<HTMLInputElement>('.js-path')?.value\n  const lineNumber = container.querySelector<HTMLInputElement>('.js-line-number')?.value\n  const startLineNumber = container.querySelector<HTMLInputElement>('.js-start-line-number')?.value\n  const side = container.querySelector<HTMLInputElement>('.js-side')?.value\n  const startSide = container.querySelector<HTMLInputElement>('.js-start-side')?.value\n  const startCommitOid = container.querySelector<HTMLInputElement>('.js-start-commit-oid')?.value\n  const endCommitOid = container.querySelector<HTMLInputElement>('.js-end-commit-oid')?.value\n  const baseCommitOid = container.querySelector<HTMLInputElement>('.js-base-commit-oid')?.value\n  const commentId = container.querySelector<HTMLInputElement>('.js-comment-id')?.value\n\n  const form = new FormData()\n  form.append('text', text)\n  // eslint-disable-next-line github/authenticity-token\n  form.append('authenticity_token', token(container))\n  if (path) form.append('path', path)\n  if (lineNumber) form.append('line_number', lineNumber)\n  if (startLineNumber) form.append('start_line_number', startLineNumber)\n  if (side) form.append('side', side)\n  if (startSide) form.append('start_side', startSide)\n  if (startCommitOid) form.append('start_commit_oid', startCommitOid)\n  if (endCommitOid) form.append('end_commit_oid', endCommitOid)\n  if (baseCommitOid) form.append('base_commit_oid', baseCommitOid)\n  if (commentId) form.append('comment_id', commentId)\n  return form\n}\n\nfunction fetchPreview(container: Element): Promise<string> {\n  const url = container.getAttribute('data-preview-url')!\n  const data = previewForm(container)\n  fire(container, 'preview:setup', {data})\n  return cachedFetch(url, data)\n}\n\nconst cachedFetch = memoize(uncachedFetch, {hash})\nlet previousController: AbortController | null = null\nasync function uncachedFetch(url: string, body: FormData): Promise<string> {\n  previousController?.abort()\n  const {signal} = (previousController = new AbortController())\n  const response = await fetch(url, {method: 'post', body, signal})\n  if (!response.ok) throw new Error('something went wrong')\n  return response.text()\n}\n\nfunction hash(url: string, body: FormData): string {\n  const params = [...body.entries()].toString()\n  return `${url}:${params}`\n}\n\nasync function renderPreview(container: Element) {\n  const commentBody = container.querySelector<HTMLElement>('.comment-body')!\n\n  // eslint-disable-next-line github/unescaped-html-literal\n  commentBody.innerHTML = '<p>Loading preview&hellip;</p>'\n  try {\n    const html = await fetchPreview(container)\n    // eslint-disable-next-line github/unescaped-html-literal\n    commentBody.innerHTML = html || '<p>Nothing to preview</p>'\n    // Alert listeners that content has been fetched and written to the dom\n    fire(container, 'preview:rendered')\n  } catch (error) {\n    if (error.name !== 'AbortError') {\n      // eslint-disable-next-line github/unescaped-html-literal\n      commentBody.innerHTML = '<p>Error rendering preview</p>'\n    }\n  }\n}\n\nobserve('.js-preview-tab', function (tab) {\n  tab.addEventListener('mouseenter', async () => {\n    const container = tab.closest<HTMLElement>('.js-previewable-comment-form')!\n    try {\n      await fetchPreview(container)\n    } catch (error) {\n      // Ignore fetch errors on silent prefetch\n    }\n  })\n})\n\nonKey('keydown', '.js-comment-field', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  const field = event.target as HTMLInputElement\n\n  // On Apple devices, the Meta (Cmd)+Shift plane is in lower case. So\n  // normalising the key toUpperCase is necessary\n  if ((event.ctrlKey || event.metaKey) && event.shiftKey && event.key.toUpperCase() === 'P') {\n    const container = field.closest<HTMLElement>('.js-previewable-comment-form')!\n    if (container.classList.contains('write-selected')) {\n      if (container instanceof TabContainerElement) {\n        container.querySelector<HTMLElement>('.js-preview-tab')!.click()\n      } else {\n        // eslint-disable-next-line github/no-blur\n        field.blur()\n        container.dispatchEvent(\n          new CustomEvent('preview:render', {\n            bubbles: true,\n            cancelable: false\n          })\n        )\n      }\n      event.preventDefault()\n      event.stopImmediatePropagation()\n    }\n  }\n  /* eslint-enable no-restricted-syntax */\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {onKey} from '../../onfocus'\n\n// This regex matches a comment containing only \"-1\", \"+1\", \":-\", \":-1\", \":+\", or \":+1\"\nconst plusOneMarker = /^(\\+1|-1|:\\+1?|:-1?)$/\n\n// Checks to see if a comment is a reaction like comment.\nconst isReactionLikeComment = (text: string): boolean => {\n  let matched = false\n  for (const line of text.split('\\n')) {\n    const l = line.trim()\n    if (!l || l.startsWith('>')) continue\n    // If a line has matched previously, but this one doesnt,\n    // it means the line has more than just a reaction - so return false\n    if (matched && plusOneMarker.test(l) === false) {\n      return false\n    }\n    if (!matched && plusOneMarker.test(l)) {\n      matched = true\n    }\n  }\n  return matched\n}\n\non('focusout', '#new_comment_field', function (event) {\n  const newCommentTextField = event.currentTarget\n\n  const suggestion = newCommentTextField.closest('.js-reaction-suggestion')\n  if (suggestion) {\n    clearReactionSuggestion(suggestion)\n  }\n})\n\non('focusin', '#new_comment_field', function (event) {\n  toggleReactionSuggestion(event)\n})\n\nonKey('keyup', '#new_comment_field', function (event) {\n  toggleReactionSuggestion(event)\n})\n\n// Toggle reaction suggestion.\nfunction toggleReactionSuggestion(event: Event) {\n  const eventTarget = event.target as HTMLTextAreaElement\n\n  const text = eventTarget.value\n  const reactionSuggestion = eventTarget.closest('.js-reaction-suggestion')\n\n  if (!reactionSuggestion) {\n    return\n  }\n\n  if (isReactionLikeComment(text)) {\n    reactionSuggestion.classList.remove('hide-reaction-suggestion')\n    reactionSuggestion.classList.add('reaction-suggestion')\n    const suggestionText = reactionSuggestion.getAttribute('data-reaction-markup')!\n    reactionSuggestion.setAttribute('data-reaction-suggestion-message', suggestionText)\n  } else {\n    clearReactionSuggestion(reactionSuggestion)\n  }\n}\n\n// Clear reaction suggestion.\nfunction clearReactionSuggestion(reactionSuggestion: Element) {\n  reactionSuggestion.classList.remove('reaction-suggestion')\n  reactionSuggestion.classList.add('hide-reaction-suggestion')\n  reactionSuggestion.removeAttribute('data-reaction-suggestion-message')\n}\n","import {isShortcutAllowed} from './keyboard-shortcuts-helper'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Support 'c' key to open commits too\non('navigation:keydown', '.js-commits-list-item', function (event) {\n  if (!isShortcutAllowed(event.detail.originalEvent)) return\n\n  if (!(event.target instanceof Element)) return\n  if (event.detail.hotkey === 'c') {\n    event.target.querySelector<HTMLElement>('.js-navigation-open')!.click()\n  }\n})\n","import {onInput} from '../onfocus'\n\nonInput('.js-company-name-input', function (event) {\n  const field = event.target as HTMLInputElement\n\n  const form = field.form!\n\n  const corpTOSLink = form.querySelector('.js-corp-tos-link')\n  const regTOSLink = form.querySelector('.js-tos-link')\n\n  if (regTOSLink) {\n    // TODO Replace with hidden attribute so aria-hidden is not required.\n    /* eslint-disable-next-line github/no-d-none */\n    regTOSLink.classList.add('d-none')\n    regTOSLink.setAttribute('aria-hidden', 'true')\n\n    if (corpTOSLink) {\n      // TODO Replace with hidden attribute so aria-hidden is not required.\n      /* eslint-disable-next-line github/no-d-none */\n      corpTOSLink.classList.remove('d-none')\n      corpTOSLink.setAttribute('aria-hidden', 'false')\n    }\n  }\n\n  const hints = form.querySelectorAll('.js-company-name-text')\n  if (hints.length === 0) {\n    return\n  }\n\n  for (const hint of hints) {\n    if (field.value) {\n      const hasWording = hint.hasAttribute('data-wording')\n\n      if (hasWording) {\n        const wording = hint.getAttribute('data-wording')!\n        hint.textContent = ` ${wording} ${field.value}`\n      } else {\n        hint.textContent = field.value\n      }\n    } else {\n      hint.textContent = ''\n    }\n  }\n})\n","import {changeValue} from '../form'\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Update the TOS statement with company name\n//   e.g. By clicking on \"Create an organization\" below, you are agreeing to the Terms of Service and the Privacy Policy on behalf of your company, GitHub, Inc.\nobserve('.js-company-owned:not(:checked)', {\n  constructor: HTMLInputElement,\n  add(el) {\n    const form = el.form!\n    const input = form.querySelector<HTMLInputElement>('.js-company-name-input')!\n    const hint = document.querySelector<HTMLElement>('.js-company-name-text')!\n    const corpTOSLink = document.querySelector<HTMLElement>('.js-corp-tos-link')!\n    const regTOSLink = document.querySelector<HTMLElement>('.js-tos-link')!\n\n    if (input) {\n      if (el.getAttribute('data-optional')) {\n        input.removeAttribute('required')\n      }\n      changeValue(input, '')\n    }\n\n    // TODO Replace with hidden attribute so aria-hidden is not required.\n    /* eslint-disable-next-line github/no-d-none */\n    regTOSLink.classList.remove('d-none')\n    regTOSLink.setAttribute('aria-hidden', 'false')\n    /* eslint-disable-next-line github/no-d-none */\n    corpTOSLink.classList.add('d-none')\n    corpTOSLink.setAttribute('aria-hidden', 'true')\n\n    if (hint) {\n      hint.textContent = ''\n    }\n  }\n})\n\nobserve('.js-company-owned:checked', {\n  constructor: HTMLInputElement,\n  add(el) {\n    const form = el.form!\n    const input = form.querySelector('.js-company-name-input')\n\n    if (input) {\n      input.setAttribute('required', '')\n      fire(input, 'focus')\n      fire(input, 'input')\n    }\n  }\n})\n\n// Make the CorpTOS the default on the \"Business Plus\" AKA Business plan\n// TODO Replace with delegated-events\nobserve('.js-company-owned-autoselect', {\n  constructor: HTMLInputElement,\n  add(field) {\n    const planChoice = field\n\n    function autoselect() {\n      if (planChoice.checked && planChoice.form) {\n        const corpTos = planChoice.form.querySelector<HTMLInputElement>('.js-company-owned')!\n        changeValue(corpTos, true)\n      }\n    }\n\n    planChoice.addEventListener('change', autoselect)\n    autoselect()\n  }\n})\n","import {compose, fromEvent} from '../subscription'\nimport IncludeFragmentElement from '@github/include-fragment-element'\nimport hashChange from './hash-change'\nimport {loadDeferredContentByEvent} from './include-fragment'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nlet currentlyOpenedDetailsDropdown: HTMLElement | null = null\n\ndocument.addEventListener('keydown', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (!event.defaultPrevented && event.key === 'Escape' && currentlyOpenedDetailsDropdown) {\n    currentlyOpenedDetailsDropdown.removeAttribute('open')\n  }\n  /* eslint-enable no-restricted-syntax */\n})\n\n// Dismiss open <details> when activating <details> with keyboard.\nobserve('.js-dropdown-details', {\n  subscribe: el => {\n    return compose(fromEvent(el, 'toggle', closeCurrentDetailsDropdown), fromEvent(el, 'toggle', autofocus))\n  }\n})\n\nfunction autofocus({currentTarget}: Event) {\n  const target = currentTarget as HTMLElement\n  if (target.hasAttribute('open')) {\n    const element = target.querySelector<HTMLElement>('[autofocus]')\n    if (element) element.focus()\n  } else {\n    const summary = target.querySelector<HTMLElement>('summary')\n    if (summary) summary.focus()\n  }\n}\n\nfunction closeCurrentDetailsDropdown({currentTarget}: Event) {\n  const target = currentTarget as HTMLElement\n  if (target.hasAttribute('open')) {\n    if (currentlyOpenedDetailsDropdown && currentlyOpenedDetailsDropdown !== target) {\n      currentlyOpenedDetailsDropdown.removeAttribute('open')\n    }\n\n    currentlyOpenedDetailsDropdown = target\n  } else if (target === currentlyOpenedDetailsDropdown) {\n    currentlyOpenedDetailsDropdown = null\n  }\n}\n\nobserve('[data-deferred-details-content-url]:not([data-details-no-preload-on-hover])', {\n  subscribe: el => {\n    const summary = el.querySelector<HTMLElement>('summary')!\n    return fromEvent(summary, 'mouseenter', loadDeferredContentByEvent)\n  }\n})\n\nobserve('[data-deferred-details-content-url]', {\n  subscribe: el => {\n    return fromEvent(el, 'toggle', loadDeferredContentByEvent)\n  }\n})\n\n// Additonal button trigger for <details id>\non('click', '[data-toggle-for]', function (event) {\n  const id = event.currentTarget.getAttribute('data-toggle-for') || ''\n  const details = document.getElementById(id)\n  if (!details) return\n  details.hasAttribute('open') ? details.removeAttribute('open') : details.setAttribute('open', 'open')\n})\n\n// Expand collapsed outdated diff if anchor points to it\n//   /github/github/pull/123#discussion-diff-456\n//   /github/github/pull/123#discussion-r345\nhashChange(function ({target}) {\n  if (!target || target.closest('summary')) return\n\n  let node = target.parentElement\n  while (node) {\n    node = node.closest('details')\n    if (node) {\n      if (!node.hasAttribute('open')) {\n        node.setAttribute('open', '')\n      }\n      node = node.parentElement\n    }\n  }\n})\n\n// The details dialog allows users to dismiss the dialog by clicking on the\n// grayed-out background. This additional functionality prohibits dismissing\n// the dialog in this way.\non('details-dialog-close', '[data-disable-dialog-dismiss]', function (event) {\n  event.preventDefault()\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport type IncludeFragmentElement from '@github/include-fragment-element'\nimport RemoteInputElement from '@github/remote-input-element'\nimport {fromEvent} from '../subscription'\nimport {microtask} from '../eventloop-tasks'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {onKey} from '../onfocus'\n\n// Match deprecated .js-select-menu state classes.\nobserve('details.select-menu details-menu include-fragment', function (el) {\n  const details = el.closest('details')\n  if (!details) return\n  el.addEventListener('loadstart', function () {\n    details.classList.add('is-loading')\n    details.classList.remove('has-error')\n  })\n  el.addEventListener('error', function () {\n    details.classList.add('has-error')\n  })\n  el.addEventListener('loadend', function () {\n    details.classList.remove('is-loading')\n    const filter = details.querySelector('.js-filterable-field')\n    if (filter) fire(filter, 'filterable:change')\n  })\n})\n\n// Clear filter when menu closes.\nobserve('details details-menu .js-filterable-field', {\n  constructor: HTMLInputElement,\n  add(filter) {\n    const details = filter.closest<HTMLElement>('details')!\n    details.addEventListener('toggle', function () {\n      if (!details.hasAttribute('open')) {\n        filter.value = ''\n        fire(filter, 'filterable:change')\n      }\n    })\n  }\n})\n\n// Temporary fix for role=menu containing input\nobserve('details-menu[role=menu] [role=menu]', el => {\n  const menu = el.closest('details-menu[role]')\n  if (menu && menu !== el) menu.removeAttribute('role')\n})\n\n// Clear filter when menu closes.\nobserve('details details-menu remote-input input', {\n  constructor: HTMLInputElement,\n  add(filter) {\n    const details = filter.closest<HTMLElement>('details')!\n    details.addEventListener('toggle', function () {\n      if (!details.hasAttribute('open')) {\n        filter.value = ''\n      }\n    })\n  }\n})\n\n// On form reset fire change on input so details-menu can apply state changes.\nobserve('form details-menu', menu => {\n  const form = menu.closest<HTMLElement>('form')!\n  form.addEventListener('reset', () => {\n    setTimeout(() => resetMenus(form), 0)\n  })\n})\n\n// Re-fires the `change` event for checked radios in a details-menu form.\nfunction resetMenus(form: Element) {\n  const inputs = form.querySelectorAll('details-menu [role=menuitemradio] input[type=radio]:checked')\n  for (const input of inputs) {\n    fire(input, 'change')\n  }\n}\n\n/**\n * Auto trigger the first item on Enter when filterable field is focused.\n */\nonKey('keypress', 'details-menu .js-filterable-field, details-menu filter-input input', (event: KeyboardEvent) => {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (event.key === 'Enter') {\n    const input = event.currentTarget\n    const menu = (input as HTMLInputElement).closest<HTMLElement>('details-menu')!\n    const firstItem = menu.querySelector('[role^=\"menuitem\"]:not([hidden])')\n    if (firstItem instanceof HTMLElement) firstItem.click()\n    event.preventDefault()\n  }\n  /* eslint-enable no-restricted-syntax */\n})\n\n// Focus filterable field after selecting an item\non(\n  'details-menu-selected',\n  'details-menu',\n  event => {\n    const menu = event.currentTarget\n\n    const filterableField = (menu as HTMLElement).querySelector('.js-filterable-field')\n    if (filterableField instanceof HTMLInputElement && filterableField.value) filterableField.focus()\n  },\n  {capture: true}\n)\n\n// On selection, sync selectedItem.value to input[id=data-menu-input]\non(\n  'details-menu-selected',\n  '[data-menu-input]',\n  event => {\n    if (!(event.target instanceof Element)) return\n    const id = event.target.getAttribute('data-menu-input')!\n    const el = document.getElementById(id)\n    if (!(el instanceof HTMLInputElement || el instanceof HTMLTextAreaElement)) return\n    el.value = ((event as CustomEvent).detail.relatedTarget as HTMLButtonElement).value\n  },\n  {capture: true}\n)\n\n// Restore focus on the previously focused element after results have been updated\n// Otherwise return focus to input\nobserve('details-menu remote-input', {\n  constructor: RemoteInputElement,\n  initialize(el) {\n    const resultsContainer = document.getElementById(el.getAttribute('aria-owns') || '')\n    if (!resultsContainer) return\n\n    let activeElementId: string | null = null\n    el.addEventListener('load', () => {\n      if (document.activeElement && resultsContainer.contains(document.activeElement) && document.activeElement.id) {\n        activeElementId = document.activeElement.id\n      } else {\n        activeElementId = null\n      }\n    })\n\n    el.addEventListener('loadend', () => {\n      if (activeElementId) {\n        const focusEl =\n          resultsContainer.querySelector(`#${activeElementId}`) || resultsContainer.querySelector('[role^=\"menu\"]')\n        if (focusEl instanceof HTMLElement) {\n          focusEl.focus()\n        } else if (el.input) {\n          el.input.focus()\n        }\n      }\n    })\n  }\n})\n\non(\n  'details-menu-selected',\n  'details-menu[data-menu-max-options]',\n  event => {\n    const max = +event.currentTarget.getAttribute('data-menu-max-options')!\n    const checkedItems = event.currentTarget.querySelectorAll('[role=\"menuitemcheckbox\"][aria-checked=\"true\"]')\n    const atLimit = max === checkedItems.length\n    event.currentTarget.querySelector<HTMLElement>('[data-menu-max-options-warning]')!.hidden = !atLimit\n    for (const item of event.currentTarget.querySelectorAll<HTMLInputElement>('[role=\"menuitemcheckbox\"] input')) {\n      item.disabled = atLimit && !item.checked\n    }\n  },\n  {capture: true}\n)\n\n// Make js-select-menu & navigation behaviors work with detail select menus\nobserve('details > details-menu', {\n  subscribe(el) {\n    const details = el.closest<HTMLElement>('details')!\n    return fromEvent(details, 'toggle', fireMenuToggleEvent)\n  }\n})\n\n// Fire a menu:[de]activate[d] event depending on the state of the menu.\nasync function fireMenuToggleEvent({currentTarget}: Event) {\n  const details = currentTarget as HTMLElement\n  const isOpen = details.hasAttribute('open')\n  fire(details, isOpen ? 'menu:activate' : 'menu:deactivate')\n  await microtask()\n  fire(details, isOpen ? 'menu:activated' : 'menu:deactivated')\n}\n\nobserve('details > details-menu[preload]:not([src])', {\n  subscribe(el) {\n    return fromEvent(el.parentElement!, 'mouseover', function (event) {\n      const menu = event.currentTarget as HTMLElement\n      const loader = menu.querySelector<IncludeFragmentElement>('include-fragment[src]')\n      loader?.load()\n    })\n  }\n})\n","// Disable\n//\n// Disables clicked buttons with text in `data-disable-with`.\n//\n// `<input type=submit>` or `<button type=submit>`\n//\n// `data-disable-with` - Message to set `<input>` value or `<button>` innerHTML to.\n//\n//     <input type=\"submit\" data-disable-with=\"Submitting...\">\n\nimport {afterRemote} from '@github/remote-form'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nconst originalText = new WeakMap()\nconst selector = ['input[type=submit][data-disable-with]', 'button[data-disable-with]'].join(', ')\n\n// Get button text.\nfunction getButtonText(el: Element) {\n  if (el instanceof HTMLInputElement) {\n    return el.value || 'Submit'\n  } else {\n    return el.innerHTML || ''\n  }\n}\n\n// Sets a button text.\nfunction setButtonText(el: Element, text: string) {\n  if (el instanceof HTMLInputElement) {\n    el.value = text\n  } else {\n    el.innerHTML = text\n  }\n}\n\non(\n  'submit',\n  'form',\n  function (event) {\n    for (const button of event.currentTarget.querySelectorAll(selector)) {\n      originalText.set(button, getButtonText(button))\n      const disabledText = button.getAttribute('data-disable-with')\n      if (disabledText) {\n        setButtonText(button, disabledText)\n      }\n      ;(button as HTMLInputElement | HTMLButtonElement).disabled = true\n    }\n  },\n  {capture: true}\n)\n\n// Revert a form to it's previous state.\nfunction revert(form: HTMLFormElement) {\n  for (const button of form.querySelectorAll(selector)) {\n    const text = originalText.get(button)\n    if (text != null) {\n      setButtonText(button, text)\n      // Button doesn't have a `data-disable-invalid` property or form is valid\n      if (!button.hasAttribute('data-disable-invalid') || form.checkValidity()) {\n        // Enable the button\n        ;(button as HTMLInputElement | HTMLButtonElement).disabled = false\n      }\n      originalText.delete(button)\n    }\n  }\n}\n\n// Enable controls when AJAX request finishes\non('deprecatedAjaxComplete', 'form', function ({currentTarget, target}) {\n  if (currentTarget === target) {\n    revert(currentTarget as HTMLFormElement)\n  }\n})\n\nafterRemote(revert)\n","// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Entire document is drop target.\nobserve('.js-document-dropzone', {\n  constructor: HTMLElement,\n  add(el) {\n    document.body.addEventListener('dragstart', onDragstart)\n    document.body.addEventListener('dragend', onDragend)\n    document.body.addEventListener('dragenter', onDragenter)\n    document.body.addEventListener('dragover', onDragenter)\n    document.body.addEventListener('dragleave', onBodyDragleave)\n    el.addEventListener('drop', onDrop)\n  },\n  remove(el) {\n    document.body.removeEventListener('dragstart', onDragstart)\n    document.body.removeEventListener('dragend', onDragend)\n    document.body.removeEventListener('dragenter', onDragenter)\n    document.body.removeEventListener('dragover', onDragenter)\n    document.body.removeEventListener('dragleave', onBodyDragleave)\n    el.removeEventListener('drop', onDrop)\n  }\n})\n\nfunction hasFile(transfer: DataTransfer): boolean {\n  return Array.from(transfer.types).indexOf('Files') >= 0\n}\n\nlet dragging: number | null = null\n\n// Highlight textarea and change drop cursor. Ensure drop target styles\n// are cleared after dragging back outside of window.\nfunction onDragenter(event: DragEvent) {\n  if (ignorePageElementDrag) return\n\n  const target = event.currentTarget as Element\n\n  if (dragging) {\n    window.clearTimeout(dragging)\n  }\n  dragging = window.setTimeout(() => target.classList.remove('dragover'), 200)\n\n  const transfer = event.dataTransfer\n  if (!transfer || !hasFile(transfer)) return\n\n  transfer.dropEffect = 'copy'\n  target.classList.add('dragover')\n\n  event.stopPropagation()\n  event.preventDefault()\n}\n\nfunction onBodyDragleave(event: DragEvent) {\n  // Ignore leave events from children to prevent flicker.\n  if (!(event.target instanceof Element)) return\n  if (event.target.classList.contains('js-document-dropzone')) {\n    const currentTarget = event.currentTarget as Element\n    currentTarget.classList.remove('dragover')\n  }\n}\n\nfunction onDrop(event: DragEvent) {\n  const container = event.currentTarget as Element\n\n  container.classList.remove('dragover')\n  document.body.classList.remove('dragover')\n\n  const transfer = event.dataTransfer\n  if (!transfer || !hasFile(transfer)) return\n\n  fire(container, 'document:drop', {transfer})\n\n  event.stopPropagation()\n  event.preventDefault()\n}\n\n// Ignore image or link drags from within the page itself. Allow them to be\n// dragged onto the desktop, but ignore any drops back onto the page.\nlet ignorePageElementDrag = false\n\nfunction onDragstart() {\n  ignorePageElementDrag = true\n}\n\nfunction onDragend() {\n  ignorePageElementDrag = false\n}\n","import {TemplateInstance} from '@github/template-parts'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Encrypt plain text with a public key.\nasync function encrypt(publicKey: Uint8Array, value: string): Promise<Uint8Array> {\n  const encoder = new TextEncoder()\n  const messageBytes = encoder.encode(value)\n  const {seal} = await import('../tweetsodium')\n  return seal(messageBytes, publicKey)\n}\n\n// Decode base64 data into a byte array.\nfunction decode(encoded: string): Uint8Array {\n  const bytes = atob(encoded)\n    .split('')\n    .map(x => x.charCodeAt(0))\n  return Uint8Array.from(bytes)\n}\n\n// Encode a byte array as a base64 string.\nfunction encode(bytes: Uint8Array): string {\n  let str = ''\n  for (const byte of bytes) {\n    str += String.fromCharCode(byte)\n  }\n  return btoa(str)\n}\n\non('submit', 'form.js-encrypt-submit', async function (event) {\n  const form = event.currentTarget as HTMLFormElement\n\n  if (event.defaultPrevented || !form.checkValidity()) return\n  const plainText = form.elements.namedItem('secret_value') as HTMLTextAreaElement\n\n  // Prevent serializing plain text value in form submission.\n  plainText.disabled = true\n\n  if (!plainText.value) return\n\n  event.preventDefault()\n\n  // Submit encrypted value in hidden input.\n  const publicKey = decode(form.getAttribute('data-public-key')!)\n\n  ;(form.elements.namedItem('encrypted_value') as HTMLInputElement).value = encode(\n    await encrypt(publicKey, plainText.value)\n  )\n\n  form.submit()\n})\n\n// Submit multiple encrypted values in hidden inputs. If an unencrypted field is empty,\n// its associated hidden encrypted field is disabled.\non('submit', 'form.js-encrypt-bulk-submit', submitBulk(true))\n\n// Submit multiple encrypted values in hidden inputs. If an unencrypted field is empty,\n// its associated hidden encrypted field is not disabled.\non('submit', 'form.js-encrypt-bulk-submit-enable-empty', submitBulk(false))\n\n// Submit multiple encrypted values. If an unencrypted field is empty,\n// its associated hidden encrypted field is enabled or disabled depending on \"disableEmptyValues\".\nfunction submitBulk(disableEmptyValues: boolean) {\n  return async function (event: Event) {\n    const form = event.currentTarget as HTMLFormElement\n\n    if (event.defaultPrevented || !form.checkValidity()) return\n\n    // Submit encrypted value in hidden input.\n    const publicKey = decode(form.getAttribute('data-public-key')!)\n\n    event.preventDefault()\n    for (const element of form.elements) {\n      // Prevent serializing plain text value in form submission.\n      const formElement = element as HTMLInputElement\n      if (formElement.id.endsWith('secret')) {\n        formElement.disabled = true\n\n        if (formElement.required && !formElement.value) {\n          const message = `${formElement.name} is invalid!`\n          const template = document.querySelector<HTMLTemplateElement>('template.js-flash-template')!\n          template.after(new TemplateInstance(template, {className: 'flash-error', message}))\n          return\n        }\n\n        const encryptedValueElementName = `${formElement.name}_encrypted_value`\n        if (!formElement.value) {\n          ;(form.elements.namedItem(encryptedValueElementName) as HTMLInputElement).disabled = disableEmptyValues\n          continue\n        }\n\n        ;(form.elements.namedItem(encryptedValueElementName) as HTMLInputElement).value = encode(\n          await encrypt(publicKey, formElement.value)\n        )\n      }\n    }\n    form.submit()\n  }\n}\n","// Favicon manager\n//\n// Manages light and dark favicon variations, and handles status,\n// showing a , check, or pending dot over depending on the page status\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nlet oldHref: string\n\nfunction updateFavicon(newHref?: string, colorScheme?: string) {\n  const favicon = document.querySelector<HTMLLinkElement>('.js-site-favicon[type=\"image/svg+xml\"]')\n  const faviconFallback = document.querySelector<HTMLLinkElement>('.js-site-favicon[type=\"image/png\"]')\n\n  if (!colorScheme) colorScheme = 'light'\n  const colorSchemeSuffix = colorScheme === 'light' ? '' : '-dark'\n\n  if (favicon && faviconFallback) {\n    if (oldHref == null) {\n      oldHref = favicon.href\n    }\n\n    if (newHref) {\n      newHref = newHref.substr(0, newHref.lastIndexOf('.'))\n      newHref = `${newHref}${colorSchemeSuffix}.svg`\n      favicon.href = newHref\n\n      const newFallbackHref = favicon.href.substr(0, favicon.href.lastIndexOf('.'))\n      faviconFallback.href = `${newFallbackHref}.png`\n    } else {\n      const n = favicon.href.indexOf('-dark.svg')\n      const newFaviconName = favicon.href.substr(0, n !== -1 ? n : favicon.href.lastIndexOf('.'))\n\n      favicon.href = `${newFaviconName}${colorSchemeSuffix}.svg`\n      faviconFallback.href = `${newFaviconName}${colorSchemeSuffix}.png`\n    }\n  }\n}\n\nfunction prefersDarkColorScheme() {\n  return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches\n}\n\nfunction resetIcon() {\n  if (oldHref != null) updateFavicon(oldHref, prefersDarkColorScheme() ? 'dark' : 'light')\n}\n\nobserve('[data-favicon-override]', {\n  add(el) {\n    const href = el.getAttribute('data-favicon-override')!\n\n    // allow `remove` for the old element to fire first\n    setTimeout(() => updateFavicon(href, prefersDarkColorScheme() ? 'dark' : 'light'))\n  },\n  remove() {\n    resetIcon()\n  }\n})\n\nif (prefersDarkColorScheme()) {\n  // update favicon to dark on page load\n  updateFavicon(undefined, 'dark')\n}\n\nwindow.matchMedia('(prefers-color-scheme: dark)').addListener(() => {\n  updateFavicon(undefined, prefersDarkColorScheme() ? 'dark' : 'light')\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('.js-feature-preview-indicator-container', container => {\n  fetchFeaturePreviewIndicator(container)\n})\n\ntype FeatureResponse = {\n  show_indicator: boolean\n}\n\n// Load the indicator status and update any indicators on the page.\nasync function fetchFeaturePreviewIndicator(container: Element) {\n  const url = container.getAttribute('data-feature-preview-indicator-src')!\n  const show = await fetchIndicator(url)\n  const indicators = container.querySelectorAll<HTMLElement>('.js-feature-preview-indicator')\n  for (const indicator of indicators) {\n    indicator.hidden = !show\n  }\n}\n\nasync function fetchIndicator(url: string): Promise<boolean> {\n  try {\n    const response = await fetch(url, {headers: {Accept: 'application/json'}})\n    if (!response.ok) return false\n    const json = (await response.json()) as FeatureResponse\n    return json.show_indicator\n  } catch {\n    return false\n  }\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {dialog} from '../details-dialog'\nimport {fetchSafeDocumentFragment} from '../fetch'\nimport {remoteForm} from '@github/remote-form'\nimport {sendStats} from '../stats'\n\n/*\n  Opens the feature preview dialog to a given feature specified by it's slug\n\n  <button data-feature-preview-trigger-url=\"<%= feature_previews_path(user_id: login, selected_slug: \"my_feature\") %>\">\n    Opt in to the feature preview for My Feature\n  </button>\n\n  You can react to a feature being enrolled/unenrolled by the user with these events:\n\n  - `feature-preview-enroll:my_feature`\n  - `feature-preview-unenroll:my_feature`\n\n  e.g.\n\n  document.addEventListener('feature-preview-enroll:my_feature', () => {\n    optInButton.hidden = true\n    optOutButton.hidden = false\n  })\n\n  document.addEventListener('feature-preview-unenroll:my_feature', () => {\n    optInButton.hidden = false\n    optOutButton.hidden = true\n  })\n*/\n\non('click', '[data-feature-preview-trigger-url]', async event => {\n  const trigger = event.currentTarget\n  const url = trigger.getAttribute('data-feature-preview-trigger-url')!\n\n  const newDialog = await dialog({\n    content: fetchSafeDocumentFragment(document, url),\n    dialogClass: 'feature-preview-dialog'\n  })\n\n  const closeDetails = trigger.getAttribute('data-feature-preview-close-details')!\n  const closeHmac = trigger.getAttribute('data-feature-preview-close-hmac')!\n\n  newDialog.addEventListener('dialog:remove', () => {\n    sendStats({hydroEventPayload: closeDetails, hydroEventHmac: closeHmac}, true)\n  })\n\n  const indicators = document.querySelectorAll<HTMLElement>('.js-feature-preview-indicator')\n  for (const indicator of indicators) {\n    indicator.hidden = true\n  }\n})\n\nremoteForm('.js-feature-preview-unenroll', async (form, wants) => {\n  await wants.text()\n  const feature = form.querySelector<HTMLInputElement>('.js-feature-preview-slug')!.value\n  fire(form, `feature-preview-unenroll:${feature}`)\n})\n\nremoteForm('.js-feature-preview-enroll', async (form, wants) => {\n  await wants.text()\n  const feature = form.querySelector<HTMLInputElement>('.js-feature-preview-slug')!.value\n  fire(form, `feature-preview-enroll:${feature}`)\n})\n","import type {Attachment} from '@github/file-attachment-element'\nimport {sendStats} from '../stats'\n\nexport type UploadError = {\n  status: number\n  body: string\n}\n\n// 204 No Content\ntype S3ResponseData = Record<string, unknown>\n\n// 201 Created\ntype EnterpriseResponseData = {\n  id: number\n  href: string\n}\n\ntype UploadResponseData = EnterpriseResponseData | S3ResponseData\n\ntype S3UploadPolicy = {\n  asset_upload_url: string\n  asset_upload_authenticity_token: string\n  upload_authenticity_token: string\n  upload_url: string\n  form: Record<string, string>\n  header: Record<string, string>\n  same_origin: boolean\n  asset: {\n    id: number\n    href: string\n    name: string\n  }\n}\n\ntype EnterpriseUploadPolicy = {\n  upload_authenticity_token: string\n  upload_url: string\n  form: {[key: string]: string}\n  header: Record<string, string>\n  same_origin: boolean\n  asset: {\n    name: string\n  }\n}\n\nexport type UploadPolicyData = S3UploadPolicy | EnterpriseUploadPolicy\n\nexport type AttachmentUploadDelegate = {\n  attachmentUploadDidStart(attachment: Attachment, policy: UploadPolicyData): void\n  attachmentUploadDidProgress(attachment: Attachment, percent: number): void\n  attachmentUploadDidComplete(attachment: Attachment, policy: UploadPolicyData, data: UploadResponseData): void\n  attachmentUploadDidError(attachment: Attachment, error: UploadError): void\n}\n\nexport default class AttachmentUpload {\n  attachment: Attachment\n  policy: UploadPolicyData\n\n  constructor(attachment: Attachment, policy: UploadPolicyData) {\n    this.attachment = attachment\n    this.policy = policy\n  }\n\n  async process(delegate: AttachmentUploadDelegate): Promise<void> {\n    const startTime = window.performance.now()\n    const headers = new Headers(this.policy.header || {})\n\n    const xhr = new XMLHttpRequest()\n    xhr.open('POST', this.policy.upload_url, true)\n\n    for (const [key, value] of headers) {\n      xhr.setRequestHeader(key, value)\n    }\n\n    xhr.onloadstart = () => {\n      delegate.attachmentUploadDidStart(this.attachment, this.policy)\n    }\n\n    xhr.upload.onprogress = e => {\n      if (e.lengthComputable) {\n        const percent = Math.round((e.loaded / e.total) * 100)\n        delegate.attachmentUploadDidProgress(this.attachment, percent)\n      }\n    }\n\n    await send(xhr, uploadForm(this.attachment, this.policy))\n\n    if (xhr.status === 204) {\n      markComplete(this.policy)\n      delegate.attachmentUploadDidComplete(this.attachment, this.policy, {})\n    } else if (xhr.status === 201) {\n      markComplete(this.policy)\n      delegate.attachmentUploadDidComplete(this.attachment, this.policy, JSON.parse(xhr.responseText))\n    } else {\n      delegate.attachmentUploadDidError(this.attachment, {status: xhr.status, body: xhr.responseText})\n    }\n\n    const endTime = window.performance.now()\n    const timeDiff = endTime - startTime\n    const uploadTiming: PlatformBrowserPerformanceUploadTiming = {\n      duration: timeDiff,\n      size: this.attachment?.file?.size,\n      fileType: this.attachment?.file?.type,\n      success: xhr.status === 204 || xhr.status === 201\n    }\n    sendStats({uploadTiming}, true)\n  }\n}\n\nfunction send(xhr: XMLHttpRequest, body: FormData): Promise<XMLHttpRequest> {\n  return new Promise((resolve, reject) => {\n    xhr.onload = () => resolve(xhr)\n    xhr.onerror = reject\n    xhr.send(body)\n  })\n}\n\nfunction uploadForm(attachment: Attachment, policy: UploadPolicyData): FormData {\n  const form = new FormData()\n  if (policy.same_origin) {\n    // eslint-disable-next-line github/authenticity-token\n    form.append('authenticity_token', policy.upload_authenticity_token)\n  }\n  for (const key in policy.form) {\n    form.append(key, policy.form[key])\n  }\n  form.append('file', attachment.file)\n  return form\n}\n\nfunction markComplete(policy: UploadPolicyData) {\n  /* eslint-disable-next-line @typescript-eslint/ban-ts-comment */\n  // @ts-ignore\n  const url = typeof policy.asset_upload_url === 'string' ? policy.asset_upload_url : null\n  const token =\n    /* eslint-disable-next-line @typescript-eslint/ban-ts-comment */\n    // @ts-ignore\n    typeof policy.asset_upload_authenticity_token == 'string' ? policy.asset_upload_authenticity_token : null\n\n  if (!(url && token)) return\n\n  const form = new FormData()\n  // eslint-disable-next-line github/authenticity-token\n  form.append('authenticity_token', token)\n\n  fetch(url, {\n    method: 'PUT',\n    body: form,\n    credentials: 'same-origin',\n    headers: {\n      Accept: 'application/json',\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n}\n","import type {Attachment, default as FileAttachmentElement} from '@github/file-attachment-element'\nimport type {AttachmentUploadDelegate, UploadError, UploadPolicyData} from './attachment-upload'\n\nimport AttachmentUpload from './attachment-upload'\nimport type Batch from './batch'\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n\nexport async function upload(batch: Batch, container: FileAttachmentElement) {\n  const delegate = createDelegate(batch, container)\n  for (const attachment of batch.attachments) {\n    const policy = await validate(batch, attachment, container)\n    if (!policy) return\n    try {\n      const uploader = new AttachmentUpload(attachment, policy)\n      await uploader.process(delegate)\n    } catch {\n      fire(container, 'upload:error', {batch, attachment})\n      resetState(container, 'is-failed')\n      return\n    }\n  }\n}\n\nasync function validate(batch: Batch, attachment: Attachment, container: Element): Promise<UploadPolicyData | null> {\n  const form = policyForm(attachment, container)\n  const preprocess: Array<Promise<unknown>> = []\n  fire(container, 'upload:setup', {batch, attachment, form, preprocess})\n\n  try {\n    await Promise.all(preprocess)\n    const response = await fetch(policyRequest(form, container))\n    if (response.ok) {\n      return await response.json()\n    }\n    fire(container, 'upload:invalid', {batch, attachment})\n    const body = await response.text()\n    const status = response.status\n    const {state, messaging} = policyErrorState({status, body}, attachment.file)\n    resetState(container, state, messaging)\n  } catch {\n    fire(container, 'upload:invalid', {batch, attachment})\n    resetState(container, 'is-failed')\n  }\n  return null\n}\n\nfunction policyForm(attachment: Attachment, container: Element): FormData {\n  const token = container.querySelector<HTMLInputElement>('.js-data-upload-policy-url-csrf')!.value\n  const repoId = container.getAttribute('data-upload-repository-id')\n  const subjectType = container.getAttribute('data-subject-type')\n  const subject = container.getAttribute('data-subject-param')\n  const file = attachment.file\n\n  const form = new FormData()\n  form.append('name', file.name)\n  form.append('size', String(file.size))\n  form.append('content_type', file.type)\n  // eslint-disable-next-line github/authenticity-token\n  form.append('authenticity_token', token)\n  if (subjectType) form.append('subject_type', subjectType)\n  if (subject) form.append('subject', subject)\n  if (repoId) {\n    form.append('repository_id', repoId)\n  }\n  if (attachment.directory) {\n    form.append('directory', attachment.directory)\n  }\n\n  return form\n}\n\nfunction policyRequest(form: FormData, container: Element): Request {\n  return new Request(container.getAttribute('data-upload-policy-url')!, {\n    method: 'POST',\n    body: form,\n    credentials: 'same-origin',\n    headers: {\n      Accept: 'application/json',\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n}\n\nfunction createDelegate(batch: Batch, container: Element): AttachmentUploadDelegate {\n  return {\n    attachmentUploadDidStart(attachment, policy) {\n      attachment.saving(0)\n      resetState(container, 'is-uploading')\n      fire(container, 'upload:start', {batch, attachment, policy})\n    },\n    attachmentUploadDidProgress(attachment, percent) {\n      attachment.saving(percent)\n      fire(container, 'upload:progress', {batch, attachment})\n    },\n    attachmentUploadDidComplete(attachment, policy, result) {\n      attachment.saved(savedAttributes(result, policy))\n      fire(container, 'upload:complete', {batch, attachment})\n      if (batch.isFinished()) {\n        resetState(container, 'is-default')\n      }\n    },\n    attachmentUploadDidError(attachment, response) {\n      fire(container, 'upload:error', {batch, attachment})\n      const {state} = policyErrorState(response)\n      resetState(container, state)\n    }\n  }\n}\n\n// Extracts the uploaded attachment's attributes that reference the stored\n// file on the server. These can come from the upload response in the case of\n// our Enterprise Alambic file server or from the initial policy creation,\n// prior to file upload, in the case of Amazon S3 used by github.com.\nfunction savedAttributes(\n  /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n  result: any,\n  policy: UploadPolicyData\n): {id: string | null; href: string | null; name: string | null} {\n  const id =\n    /* eslint-disable-next-line @typescript-eslint/ban-ts-comment */\n    // @ts-ignore\n    (result.id == null ? null : String(result.id)) || (policy.asset.id == null ? null : String(policy.asset.id))\n  const href =\n    (typeof result.href === 'string' ? result.href : null) ||\n    /* eslint-disable-next-line @typescript-eslint/ban-ts-comment */\n    // @ts-ignore\n    (typeof policy.asset.href === 'string' ? policy.asset.href : null)\n  return {id, href, name: policy.asset.name}\n}\n\ntype PolicyErrorMessaging = {\n  message: string\n  target: string\n}\n\ntype PolicyErrorState = {\n  state: string\n  messaging?: PolicyErrorMessaging\n}\n\n// Create a CSS class name that matches the errors coming from the policy\n// POST. The /upload/policies/* resource returns a 422 response with a JSON\n// body describing why the policy is invalid.\nfunction policyErrorState(response: UploadError, file?: File): PolicyErrorState {\n  // Amazon S3 error.\n  if (response.status === 400) {\n    return {state: 'is-bad-file'}\n  }\n\n  if (response.status !== 422) {\n    return {state: 'is-failed'}\n  }\n\n  const hash = JSON.parse(response.body)\n\n  // If we have the expected JSON response with errors key, try to find the right\n  // error message. If there's a server-side error or user got logged out, we\n  // won't have hash.errors, so skip this and return generic failure message.\n  if (!hash || !hash.errors) {\n    return {state: 'is-failed'}\n  }\n\n  for (const error of hash.errors) {\n    switch (error.field) {\n      case 'size': {\n        const size = file ? file.size : null\n        if (size != null && size === 0) {\n          return {state: 'is-empty'}\n        }\n        return {\n          state: 'is-too-big',\n          messaging: {\n            message: trimSizeErrorMessage(error.message),\n            target: '.js-upload-too-big'\n          }\n        }\n      }\n      case 'file_count':\n        return {state: 'is-too-many'}\n      case 'width':\n      case 'height':\n        return {state: 'is-bad-dimensions'}\n      case 'name':\n        if (error.code === 'already_exists') {\n          return {state: 'is-duplicate-filename'}\n        }\n        return {state: 'is-bad-file'}\n      case 'content_type':\n        return {state: 'is-bad-file'}\n      case 'uploader_id':\n        return {state: 'is-bad-permissions'}\n      case 'repository_id':\n        return {state: 'is-repository-required'}\n      case 'format':\n        return {state: 'is-bad-format'}\n    }\n  }\n  return {state: 'is-failed'}\n}\n\n/**\nDue to limitations on the server, size errors may be returned with the string\n'size ' prepended on the error message we want from the server. If the message\nstarts with `size` then chop it off with its leading space and return the error\nwe want from the server.\n\nExamples:\n\n'size Yowza that's a big file' => 'Yowza that's a big file'\n'Yowza that's a big file' => 'Yowza that's a big file'\n */\nconst trimSizeErrorMessage = (message: string) => {\n  return message.startsWith('size') ? message.substring(5) : message\n}\n\nconst possibleStates = [\n  'is-default',\n  'is-uploading',\n  'is-bad-file',\n  'is-duplicate-filename',\n  'is-too-big',\n  'is-too-many',\n  'is-hidden-file',\n  'is-failed',\n  'is-bad-dimensions',\n  'is-empty',\n  'is-bad-permissions',\n  'is-repository-required',\n  'is-bad-format'\n]\n\nexport function resetState(container: Element, state: string, messaging?: PolicyErrorMessaging) {\n  if (messaging) {\n    const {message, target} = messaging\n    const el = container.querySelector(target)\n    if (el) el.innerHTML = message\n  }\n  container.classList.remove(...possibleStates)\n  container.classList.add(state)\n}\n","import type {Attachment} from '@github/file-attachment-element'\n\n// A collection of files to be uploaded together. A batch reports progress of\n// the collection rather than each individual file.\nexport default class Batch {\n  attachments: Attachment[]\n  size: number\n  total: number\n\n  constructor(attachments: Attachment[]) {\n    this.attachments = attachments\n\n    // How many total files to upload.\n    this.size = this.attachments.length\n\n    // How many total bytes to upload.\n    this.total = sum(this.attachments, a => a.file.size)\n  }\n\n  // The completion percentage of the batch as a whole.\n  //\n  // Returns a Number between 0 and 100.\n  percent(): number {\n    const bytes = (a: Attachment) => (a.file.size * a.percent) / 100\n    const total = sum(this.attachments, bytes)\n    return Math.round((total / this.total) * 100)\n  }\n\n  uploaded(): number {\n    const value = (a: Attachment) => (a.isSaved() ? 1 : 0)\n    return sum(this.attachments, value)\n  }\n\n  // The completion state of the batch.\n  //\n  // Returns true when all files have been uploaded.\n  isFinished(): boolean {\n    return this.attachments.every(attachment => attachment.isSaved())\n  }\n}\n\nfunction sum<T>(items: T[], map: (item: T) => number): number {\n  return items.reduce((total, item) => total + map(item), 0)\n}\n","import {resetState, upload} from '../upload/batch-upload'\nimport Batch from '../upload/batch'\nimport type FileAttachmentElement from '@github/file-attachment-element'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Synchronize element state with primer styles. This should be replaced with CSS.\nobserve('file-attachment[hover]', {\n  add(el) {\n    el.classList.add('dragover')\n  },\n  remove(el) {\n    el.classList.remove('dragover')\n  }\n})\n\n// Cancel empty drops after filtering out hidden dot files.\non('file-attachment-accept', 'file-attachment', function (event) {\n  const {attachments} = event.detail\n  if (attachments.length === 0) {\n    resetState(event.currentTarget, 'is-hidden-file')\n    event.preventDefault()\n  }\n})\n\n// Upload batched files after passing validation.\non('file-attachment-accepted', 'file-attachment', function (event) {\n  // CodeEditor will hide this element if it wants to handle uploads\n  const dragAndDropLabel = event.currentTarget.querySelector<HTMLElement>('.drag-and-drop')\n  if (dragAndDropLabel && dragAndDropLabel.hidden) {\n    return\n  }\n\n  const {attachments} = event.detail\n  upload(new Batch(attachments), event.currentTarget as FileAttachmentElement)\n})\n\nlet count = 0\n\nobserve('file-attachment', {\n  add(el) {\n    if (count++ === 0) {\n      document.addEventListener('drop', onDocumentDrop)\n      document.addEventListener('dragover', onDocumentDragover)\n    }\n    const form = el.closest('form')\n    if (form) {\n      form.addEventListener('reset', onFormReset)\n    }\n  },\n  remove(el) {\n    if (--count === 0) {\n      document.removeEventListener('drop', onDocumentDrop)\n      document.removeEventListener('dragover', onDocumentDragover)\n    }\n\n    const form = el.closest('form')\n    if (form) {\n      form.removeEventListener('reset', onFormReset)\n    }\n  }\n})\n\nfunction hasFile(transfer: DataTransfer): boolean {\n  return Array.from(transfer.types).indexOf('Files') >= 0\n}\n\n// Ignores accidental drops that miss the textarea.\nfunction onDocumentDrop(event: DragEvent) {\n  const transfer = event.dataTransfer\n  if (transfer && hasFile(transfer)) {\n    event.preventDefault()\n  }\n}\n\n// Prevent accidental drops until we're over a textarea.\nfunction onDocumentDragover(event: DragEvent) {\n  const transfer = event.dataTransfer\n  if (transfer && hasFile(transfer)) {\n    event.preventDefault()\n  }\n}\n\n// Parent form has been reset. Reset uploadable state back to default.\nfunction onFormReset({currentTarget}: Event) {\n  const container = (currentTarget as Element).querySelector<HTMLElement>('file-attachment')!\n  resetState(container, 'is-default')\n}\n","import FilterInputElement from '@github/filter-input-element'\nimport {announce} from '../aria-live'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('filter-input-updated', 'filter-input', event => {\n  const input = (event.currentTarget as FilterInputElement).input\n  if (!(document.activeElement && document.activeElement === input)) return\n  const {count, total} = event.detail\n  // eslint-disable-next-line i18n-text/no-en\n  announce(`Found ${count} out of ${total} ${total === 1 ? 'item' : 'items'}`)\n})\n\non(\n  'toggle',\n  'details',\n  event => {\n    // Wait for the next click to ensure that focus has left input\n    setTimeout(() => resetFilter(event.target as Element), 0)\n  },\n  {capture: true}\n)\n\non(\n  'tab-container-changed',\n  'tab-container',\n  event => {\n    if (!(event.target instanceof HTMLElement)) return\n    const {relatedTarget: panel} = event.detail\n    const filterInput = event.target.querySelector('filter-input')\n    if (filterInput instanceof FilterInputElement) {\n      filterInput.setAttribute('aria-owns', panel.id)\n    }\n  },\n  {capture: true}\n)\n\nfunction resetFilter(target: Element) {\n  const filterInput = target.querySelector<FilterInputElement>('filter-input')\n  if (filterInput && !target.hasAttribute('open')) {\n    filterInput.reset()\n  }\n}\n","// *HACK*\n//\n// In Firefox label.focus() transfers focus to <input> even with tabindex\n// attribute. This is a problem because <details-menu> relies on menuitem to be\n// the activeElement. See: https://github.com/github/github/issues/123224\n//\n// This script ties in very closely with <details-menu>'s navigation logic.\n// Tread with caution.\nimport {microtask} from '../eventloop-tasks'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {onKey} from '../onfocus'\n\nconst firefox = navigator.userAgent.match(/Firefox\\/(\\d+)/)\n\n// This should be remove as the user count for Firefox > 76 grows\nif (firefox && Number(firefox[1]) < 76) {\n  // Rely on <input> as activeElement in Firefox instead of <label>\n  observe('details-menu label[tabindex][role^=\"menuitem\"]', el => {\n    const input = el.querySelector('input')\n    if (!input) return\n\n    // Input needs to be displayed to be focused\n\n    // .select-menu-item input { display: none; }\n    const hiddenBySelectMenu = el.classList.contains('select-menu-item')\n    // eslint-disable-next-line github/no-d-none\n    const hiddenByDNone = input.classList.contains('d-none')\n    const hidden = hiddenBySelectMenu || hiddenByDNone || input.hidden\n\n    if (hiddenBySelectMenu) input.classList.add('d-block')\n    // eslint-disable-next-line github/no-d-none\n    if (hiddenByDNone) input.classList.remove('d-none')\n    if (hidden) {\n      input.classList.add('sr-only')\n      input.hidden = false\n    }\n\n    el.removeAttribute('tabindex')\n  })\n\n  // Normally we rely on :focus for styling, but it doesn't happen on <label>\n  // anymore. So instead:\n  //\n  // On focus/blur, toggle .navigation-focus to style label as focused\n  //\n  // eslint-disable-next-line delegated-events/global-on\n  on(\n    'focus',\n    'details-menu label[role=\"menuitemradio\"] input, details-menu label[role=\"menuitemcheckbox\"] input',\n    event => {\n      const label = event.currentTarget.closest<HTMLElement>('label')!\n      if (label.classList.contains('select-menu-item')) label.classList.add('navigation-focus')\n      if (label.classList.contains('SelectMenu-item')) label.classList.add('hx_menuitem--focus')\n      if (label.classList.contains('dropdown-item')) label.classList.add('hx_menuitem--focus')\n      event.currentTarget.addEventListener(\n        'blur',\n        () => {\n          if (label.classList.contains('select-menu-item')) label.classList.remove('navigation-focus')\n          if (label.classList.contains('SelectMenu-item')) label.classList.remove('hx_menuitem--focus')\n          if (label.classList.contains('dropdown-item')) label.classList.remove('hx_menuitem--focus')\n        },\n        {once: true}\n      )\n    },\n    {capture: true}\n  )\n\n  // <details-menu> listens on ArrowDown/ArrowUp keydown events to navigate.\n  // In Firefox it will always focus on the first/last item, because the\n  // activeElement (<input>) is not a [role^=menuitem]. The workaround:\n  //\n  // On arrow keydown: before details-menu navigates, move [role] from <label>\n  // to <input> so <details-menu> knows the current index.\n  //\n  // Unrelated to navigation- by default, pressing Enter while focusing on\n  // <input> will submit the form. We don't want that here.\n  //\n  // On enter keydown: simulate click for activation and prevent default.\n  onKey(\n    'keydown',\n    'details-menu label[role=\"menuitemradio\"] input, details-menu label[role=\"menuitemcheckbox\"] input',\n    async function (event: KeyboardEvent) {\n      // TODO: Refactor to use data-hotkey\n      /* eslint eslint-comments/no-use: off */\n      /* eslint-disable no-restricted-syntax */\n      if (isArrowKeys(event)) {\n        if (event.currentTarget instanceof Element) switchRoleToInputForNavigation(event.currentTarget)\n      } else if (event.key === 'Enter') {\n        const input = event.currentTarget\n        event.preventDefault()\n        await microtask()\n        if (input instanceof HTMLInputElement) input.click()\n      }\n      /* eslint-enable no-restricted-syntax */\n    }\n  )\n\n  // On blur: after <details-menu> moved focus away from current <input>, revert\n  // role attribute back to <label>.\n  //\n  // eslint-disable-next-line delegated-events/global-on\n  on(\n    'blur',\n    'details-menu label input[role=\"menuitemradio\"], details-menu label input[role=\"menuitemcheckbox\"]',\n    event => {\n      switchRoleBackToOriginalState(event.currentTarget)\n    },\n    {capture: true}\n  )\n\n  // On arrow keyup: if arrow keydown did not trigger blur (for example, when\n  // there is only one item), revert [role] back to <label>.\n  onKey(\n    'keyup',\n    'details-menu label[role=\"menuitemradio\"] input, details-menu label[role=\"menuitemcheckbox\"] input',\n    event => {\n      if (!isArrowKeys(event)) return\n      if (event.currentTarget instanceof Element) switchRoleBackToOriginalState(event.currentTarget)\n    }\n  )\n}\n\nfunction isArrowKeys(event: KeyboardEvent): boolean {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  return event.key === 'ArrowDown' || event.key === 'ArrowUp'\n  /* eslint-enable no-restricted-syntax */\n}\n\n// From a nearby `<label>` tag, get the `data-role` and set it onto the input,\n// removing the role from the label.\nfunction switchRoleToInputForNavigation(input: Element) {\n  const label = input.closest<HTMLElement>('label')!\n  if (!label.hasAttribute('data-role')) label.setAttribute('data-role', label.getAttribute('role')!)\n  input.setAttribute('role', label.getAttribute('data-role')!)\n  label.removeAttribute('role')\n}\n\n// From a nearby `<label>` tag, get the `data-role` and the label to that\n// data-role, removing the role from the input.\nfunction switchRoleBackToOriginalState(input: Element) {\n  const label = input.closest<HTMLElement>('label')!\n  if (!label.hasAttribute('data-role')) label.setAttribute('data-role', label.getAttribute('role')!)\n  label.setAttribute('role', label.getAttribute('data-role')!)\n  input.removeAttribute('role')\n}\n","// Installs observer to account for sticky/fixed overlay offsets when navigating\n// to a fragment.\nimport {computeFixedYOffset, scrollToFragmentTarget} from '../sticky-scroll-into-view'\nimport hashChange from './hash-change'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nfunction scrollTargetIntoViewIfNeeded() {\n  if (document.head.querySelector('meta[name=skip-scroll-target-into-view]')) return\n\n  if (computeFixedYOffset(document)) {\n    scrollToFragmentTarget(document)\n  }\n}\n\nhashChange(scrollTargetIntoViewIfNeeded)\n\non('click', 'a[href^=\"#\"]', function (event) {\n  const {currentTarget} = event\n  if (!(currentTarget instanceof HTMLAnchorElement)) return\n\n  // this defers the execution of scrollTargetIntoViewIfNeeded until after all the click stuff happened, including after scroll\n  setTimeout(scrollTargetIntoViewIfNeeded, 0)\n})\n","import {deleteCookie, getCookies} from './cookies'\nimport {TemplateInstance} from '@github/template-parts'\n\nconst ALLOWED_FLASH_COOKIES = ['flash-notice', 'flash-error', 'flash-message', 'flash-warn']\n\n// Find cookies named something like \"flash-notice\" and render the\n// .js-flash-template template for them.\nexport function displayFlash(el: HTMLTemplateElement) {\n  for (const {key, value} of ALLOWED_FLASH_COOKIES.flatMap(getCookies)) {\n    deleteCookie(key)\n    let message\n    try {\n      message = atob(decodeURIComponent(value))\n    } catch {\n      continue\n    }\n    el.after(new TemplateInstance(el, {className: key, message}))\n  }\n}\n","import {displayFlash} from '../flash'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('template.js-flash-template', {\n  constructor: HTMLTemplateElement,\n  add(el) {\n    displayFlash(el)\n  }\n})\n","// Delayed Focus Events\n//\n// Provides a family cancelable focus/blur that trigger slightly later.\n// This makes it easier to build menus that only display when you are\n// focused in on a field.\n//\n// Events\n//\n// `focusin:delay`\n//\n// Fired when field is being focused for the first time. Will not fire\n// if field is blurred, and refocused in less than 200ms.\n//\n// * **Synchronicity** Sync\n// * **Bubbles** Yes\n// * **Cancelable** Yes\n// * **Target** Element that is receiving focus.\n//\n// `focusout:delay`\n//\n// Fired when field has been blurred for the first time. Won't fire if\n// the field is not refocused in under 200ms or the `focusout:delay` is\n// canceled.\n//\n// * **Synchronicity** Sync\n// * **Bubbles** Yes\n// * **Cancelable** No\n// * **Target** Element that is receiving focus.\n//\n// ```javascript\n// on('focusin:delay', function() {\n//   showAutocompletions()\n// })\n//\n// on('focusout:delay', function() {\n//   hideAutocompletions()\n// })\n// ```\n//\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n\nconst focused = new WeakMap()\n\n// We use the \"focus\" and \"blur\" event in the capture phase because Firefox\n// historically had a limitation with \"focusin\" and \"focusout\" not bubbling.\ndocument.addEventListener(\n  'focus',\n  function (event: Event) {\n    const target = event.target\n    if (target instanceof Element && !focused.get(target)) {\n      fire(target, 'focusin:delay')\n      focused.set(target, true)\n    }\n  },\n  {capture: true}\n)\n\ndocument.addEventListener(\n  'blur',\n  function (event: Event) {\n    setTimeout(function () {\n      const target = event.target\n      if (target instanceof Element && target !== document.activeElement) {\n        fire(target, 'focusout:delay')\n        focused.delete(target)\n      }\n    }, 200)\n  },\n  {capture: true}\n)\n","import {remoteForm} from '@github/remote-form'\n\nremoteForm('.js-form-toggle-target', async function (form, wants) {\n  try {\n    await wants.text()\n  } catch {\n    return\n  }\n\n  const container = form.closest<HTMLElement>('.js-form-toggle-container')!\n  container.querySelector<HTMLElement>('.js-form-toggle-target[hidden]')!.hidden = false\n  form.hidden = true\n})\n","import FuzzyListElement from '../fuzzy-list-element'\nimport {announce} from '../aria-live'\nimport {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nfunction noticeHandler(event: Event) {\n  if (!(event instanceof CustomEvent)) return\n  announce(`${event.detail} results found.`)\n}\n\nobserve('fuzzy-list', {\n  constructor: FuzzyListElement,\n  subscribe: fuzzyList => fromEvent(fuzzyList, 'fuzzy-list-sorted', noticeHandler)\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Behaviors related to special cases in GFM content\n// Toggles quoted email reply content\non('click', '.email-hidden-toggle', function (event) {\n  // assert nextElementSibling is .email-hidden-reply\n  const replyContainer = event.currentTarget.nextElementSibling\n  if (!(replyContainer instanceof HTMLElement)) return\n\n  replyContainer.style.display = ''\n  replyContainer.classList.toggle('expanded')\n\n  event.preventDefault()\n})\n","import {addThrottledInputEventListener} from '../throttled-input'\nimport {fetchSafeDocumentFragment} from '../fetch'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\n\n// Toggle verify SSL visibility for https web hook URLs\nobserve('.js-hook-url-field', {\n  constructor: HTMLInputElement,\n  add(input) {\n    function checkUrl() {\n      const form = input.form\n      if (!form) return\n      let url\n      try {\n        // eslint-disable-next-line no-restricted-syntax\n        url = new URL(input.value)\n      } catch (e) {\n        // Do nothing.\n      }\n      const invalidNotice = form.querySelector('.js-invalid-url-notice')\n      if (invalidNotice instanceof HTMLElement) {\n        invalidNotice.hidden = !!(input.value === '' || (url && /^https?:/.test(url.protocol)))\n      }\n      const insecureNotice = form.querySelector('.js-insecure-url-notice')\n      if (insecureNotice instanceof HTMLElement && url && input.value) {\n        insecureNotice.hidden = /^https:$/.test(url.protocol)\n      }\n      const sslFields = form.querySelector('.js-ssl-hook-fields')\n      if (sslFields instanceof HTMLElement) {\n        sslFields.hidden = !(url && 'https:' === url.protocol)\n      }\n    }\n\n    addThrottledInputEventListener(input, checkUrl)\n    checkUrl()\n  }\n})\n\nfunction chooseEvents(selector: string): void {\n  const events = document.querySelectorAll<HTMLInputElement>('.js-hook-event-checkbox')\n  for (const eventCheckbox of events) {\n    eventCheckbox.checked = eventCheckbox.matches(selector)\n  }\n}\n\non('change', '.js-hook-event-choice', function (event) {\n  const checkbox = event.currentTarget as HTMLInputElement\n  const customIsSelected = checkbox.checked && checkbox.value === 'custom'\n  const hookEventsField = checkbox.closest('.js-hook-events-field')\n  if (hookEventsField) hookEventsField.classList.toggle('is-custom', customIsSelected)\n\n  if (checkbox.checked) {\n    if (customIsSelected) {\n      const hookWildcardEvent = document.querySelector<HTMLInputElement>('.js-hook-wildcard-event')!\n      hookWildcardEvent.checked = false\n    } else if (checkbox.value === 'push') {\n      chooseEvents('[value=\"push\"]')\n    } else if (checkbox.value === 'all') {\n      chooseEvents('.js-hook-wildcard-event')\n    }\n  }\n})\n\n// Load more delivery logs\non('click', '.js-hook-deliveries-pagination-button', async function (event) {\n  const button = event.currentTarget as HTMLButtonElement\n  button.disabled = true\n  const wrapper = button.parentElement!\n\n  const url = button.getAttribute('data-url')!\n  wrapper.before(await fetchSafeDocumentFragment(document, url))\n  wrapper.remove()\n})\n\n// Redeliver Payload Button\nremoteForm('.js-redeliver-hook-form', async function (form, wants) {\n  let response\n  try {\n    response = await wants.html()\n  } catch (responseError) {\n    form.classList.add('failed')\n    return\n  }\n\n  // replace the whole deliveries index\n  const deliveriesDetails = document.querySelector<HTMLElement>(`.js-hook-deliveries-container`)!\n  deliveriesDetails.replaceWith(response.html)\n})\n","import {compose, fromEvent} from '../subscription'\nimport {fetchSafeDocumentFragment} from '../fetch'\nimport memoize from '@github/memoize'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {sendEvent} from '../hydro-analytics'\nimport {trackView} from '../hydro-tracking'\n\ntype Position = {\n  containerTop: number\n  containerLeft: number\n  contentClassSuffix: string\n}\n\n// The card content. Moved around the page to where the current hover is\nlet cardContentContainer = document.querySelector('.js-hovercard-content')\nobserve('.js-hovercard-content', el => {\n  cardContentContainer = el\n})\n\nconst cachedFetchSafeDocumentFragment = memoize(fetchSafeDocumentFragment)\n\nlet currentTarget: Element | null | undefined\n\nlet activatingElement: Element | null = null\n\nlet deactivateTimer: number | null\n\n// Mouse position for when links wrap lines\nlet mouseX = 0\n\nconst caretDistanceFromTarget = 12\n\n// For calculating position of the card when it hangs to the left\n// NOTE: These need to stay in sync with certain CSS rules in order to keep the\n// caret pointing at the target.\n//\n// caret distance from edge of card\nconst caretPaddingX = 24\nconst caretMarginY = 7\nconst caretPaddingY = caretPaddingX - caretMarginY\n\nconst caretHeight = 16\n\n// The amount of extra time given to move into the content\nconst deactivateTimeout = 100\n\n// The minimum time before opening the hovercard via mouseover\nconst activateTimeout = 250\n\n// Get the content class of a given selector.\n// (Prefixes the selector with `Popover-message--`).\nfunction contentClass(suffix: string): string {\n  const contentClassPrefix = 'Popover-message--'\n  return contentClassPrefix + suffix\n}\n\n// Track a load of the hovercard in octolytics if it stays for > 500ms.\nfunction trackLoad(cardContentBody: HTMLElement) {\n  setTimeout(() => {\n    if (document.body && document.body.contains(cardContentBody)) {\n      // Octolytics\n      const octolyticsElement = cardContentBody.querySelector('[data-hovercard-tracking]')\n      if (octolyticsElement) {\n        const trackingData = octolyticsElement.getAttribute('data-hovercard-tracking')\n        if (trackingData) {\n          sendEvent('user-hovercard-load', JSON.parse(trackingData))\n        }\n      }\n\n      const trackingElement = cardContentBody.querySelector('[data-hydro-view]')\n      if (trackingElement instanceof HTMLElement) {\n        trackView(trackingElement)\n      }\n    }\n  }, 500)\n}\n\nfunction hideCard() {\n  if (!(cardContentContainer instanceof HTMLElement)) return\n\n  cardContentContainer.style.display = 'none'\n  cardContentContainer.children[0].innerHTML = ''\n\n  activatingElement = null\n  currentTarget = null\n}\n\nfunction selectRectNearestMouse(target: Element): ClientRect {\n  const rects = target.getClientRects()\n  let foundRect = rects[0] || target.getBoundingClientRect() || {top: 0, left: 0, height: 0, width: 0}\n\n  if (rects.length > 0) {\n    for (const rect of rects) {\n      if (rect.left < mouseX && rect.right > mouseX) {\n        foundRect = rect\n        break\n      }\n    }\n  }\n\n  return foundRect\n}\n\nfunction calculatePositions(target: Element): Position {\n  const {width: contentWidth, height: contentHeight} = cardContentContainer!.getBoundingClientRect()\n  const {left: targetX, top: targetY, height: targetHeight, width: targetWidth} = selectRectNearestMouse(target)\n\n  const roomAbove = targetY > contentHeight\n  const hangLeft = target.classList.contains('js-hovercard-left')\n\n  if (hangLeft) {\n    // If there is room, show hovercard above hover position. Else, show it below\n    const left = targetX - contentWidth - caretDistanceFromTarget\n    const targetCenterY = targetY + targetHeight / 2\n    const top = roomAbove\n      ? targetCenterY - contentHeight + caretPaddingY + caretHeight / 2\n      : targetCenterY - caretPaddingY - caretHeight / 2\n\n    return {\n      containerTop: top,\n      containerLeft: left,\n      contentClassSuffix: roomAbove ? 'right-bottom' : 'right-top'\n    }\n  } else {\n    const roomRight = window.innerWidth - targetX > contentWidth\n    const targetCenterX = targetX + targetWidth / 2\n    const left = roomRight ? targetCenterX - caretPaddingX : targetCenterX - contentWidth + caretPaddingX\n    const top = roomAbove\n      ? targetY - contentHeight - caretDistanceFromTarget\n      : targetY + targetHeight + caretDistanceFromTarget\n\n    const contentClassSuffix = roomAbove\n      ? roomRight\n        ? 'bottom-left'\n        : 'bottom-right'\n      : roomRight\n      ? 'top-left'\n      : 'top-right'\n    return {containerTop: top, containerLeft: left, contentClassSuffix}\n  }\n}\n\nfunction positionCard(target: Element, cardContent: Element) {\n  if (!(cardContentContainer instanceof HTMLElement)) return\n\n  // Hide container, reset popover styles\n  cardContentContainer.style.visibility = 'hidden'\n  cardContentContainer.style.display = 'block'\n  cardContent.classList.remove(\n    contentClass('bottom-left'),\n    contentClass('bottom-right'),\n    contentClass('right-top'),\n    contentClass('right-bottom'),\n    contentClass('top-left'),\n    contentClass('top-right')\n  )\n\n  const {containerTop, containerLeft, contentClassSuffix} = calculatePositions(target)\n\n  // Add the class for correct caret location\n  cardContent.classList.add(contentClass(contentClassSuffix))\n\n  // Position the popover & inner message correctly\n  cardContentContainer.style.top = `${containerTop + window.pageYOffset}px`\n  cardContentContainer.style.left = `${containerLeft + window.pageXOffset}px`\n\n  // Set z-index override\n  setZIndexOverride(target, cardContentContainer)\n\n  // After positioning correctly, show the popover again\n  cardContentContainer.style.visibility = ''\n}\n\nfunction showCard(fragment: DocumentFragment, target: Element) {\n  if (!(cardContentContainer instanceof HTMLElement)) return\n\n  const cardContent = cardContentContainer.children[0]\n\n  cardContent.innerHTML = ''\n\n  const cardContentBody = document.createElement('div')\n  for (const child of fragment.children) {\n    cardContentBody.appendChild(child.cloneNode(true))\n  }\n\n  cardContent.appendChild(cardContentBody)\n\n  positionCard(target, cardContent)\n  trackLoad(cardContentBody)\n\n  cardContentContainer.style.display = 'block'\n}\n\nfunction determineEnclosingSubject(target: Element): string | null {\n  const tag = target.closest('[data-hovercard-subject-tag]')\n  if (tag) return tag.getAttribute('data-hovercard-subject-tag')\n  // Fall back to page context\n  const meta = document.head && document.head.querySelector('meta[name=\"hovercard-subject-tag\"]')\n  if (meta) return meta.getAttribute('content')\n  return null\n}\n\nfunction hovercardUrlFromTarget(target: Element): string {\n  const baseHovercardUrl = target.getAttribute('data-hovercard-url')\n\n  if (baseHovercardUrl) {\n    const subjectTag = determineEnclosingSubject(target)\n    if (subjectTag) {\n      const url = new URL(baseHovercardUrl, window.location.origin)\n      const params = new URLSearchParams(url.search.slice(1))\n      params.append('subject', subjectTag)\n      params.append('current_path', window.location.pathname + window.location.search)\n      url.search = params.toString()\n      return url.toString()\n    }\n\n    return baseHovercardUrl\n  }\n\n  return ''\n}\n\n// Determine if a hovercard is enabled for this type of element.\n//\n// Return boolean will be `true` if this link element has hovercard\n// attributes and the link's particular kind of hovercard is enabled for the\n// viewer and that part of the page.\nfunction hovercardsAreEnabledForType(target: Element): boolean {\n  const hovercardType = target.getAttribute('data-hovercard-type')\n\n  if (hovercardType === 'pull_request' || hovercardType === 'issue') {\n    return !!target.closest('[data-issue-and-pr-hovercards-enabled]')\n  }\n\n  if (hovercardType === 'team') {\n    return !!target.closest('[data-team-hovercards-enabled]')\n  }\n\n  if (hovercardType === 'repository') {\n    return !!target.closest('[data-repository-hovercards-enabled]')\n  }\n\n  if (hovercardType === 'commit') {\n    return !!target.closest('[data-commit-hovercards-enabled]')\n  }\n\n  if (hovercardType === 'project') {\n    return !!target.closest('[data-project-hovercards-enabled]')\n  }\n\n  if (hovercardType === 'discussion') {\n    return !!target.closest('[data-discussion-hovercards-enabled]')\n  }\n\n  if (hovercardType === 'acv_badge') {\n    return !!target.closest('[data-acv-badge-hovercards-enabled]')\n  }\n\n  if (hovercardType === 'sponsors_listing') {\n    return !!target.closest('[data-sponsors-listing-hovercards-enabled]')\n  }\n\n  // User and organization hovercards are enabled everywhere\n  return true\n}\n\n// When mousing over a hovercard target, load the data and show the card.\nasync function activateFn(event: Event, minimumTimeout?: number): Promise<void> {\n  // Don't show hovercards on touch devices. Prevents mobile Safari users\n  // from needing to double tap links with hovercards.\n  // https://humanwhocodes.com/blog/2012/07/05/ios-has-a-hover-problem/\n  const touchDevice = 'ontouchstart' in document\n  if (touchDevice) return\n\n  const target = event.currentTarget\n\n  if (event instanceof MouseEvent) {\n    mouseX = event.clientX\n  }\n\n  if (!(target instanceof Element)) return\n  if (currentTarget === target) return\n  if (target.closest('.js-hovercard-content')) return\n\n  // Don't actually show issue or PR hovercards unless the link has an ancestor\n  // element with data-issue-and-pr-hovercards-enabled\n  if (!hovercardsAreEnabledForType(target)) return\n\n  hideCard()\n\n  // Set the current target as the one we're currently hovering on\n  currentTarget = target\n  activatingElement = document.activeElement\n\n  const hovercardUrl = hovercardUrlFromTarget(target)\n\n  let fragment: DocumentFragment | null | undefined\n  try {\n    const forcedDelay = new Promise(r => window.setTimeout(r, minimumTimeout, 0))\n    fragment = await cachedFetchSafeDocumentFragment(document, hovercardUrl)\n    await forcedDelay\n  } catch (err) {\n    const response: Response = err.response\n    if (response && response.status === 404) {\n      // eslint-disable-next-line i18n-text/no-en\n      const notAvailableMessage = 'Hovercard is unavailable'\n      target.setAttribute('aria-label', notAvailableMessage)\n      target.classList.add('tooltipped', 'tooltipped-ne')\n    } else if (response && response.status === 410) {\n      const data: {[key: string]: string} = await response.clone().json()\n      target.setAttribute('aria-label', data.message)\n      target.classList.add('tooltipped', 'tooltipped-ne')\n    }\n    return\n  }\n\n  // Ensure that the target is still the active one\n  if (target === currentTarget) {\n    showCard(fragment, target)\n\n    if (event instanceof KeyboardEvent && cardContentContainer instanceof HTMLElement) {\n      cardContentContainer.focus()\n    }\n  }\n}\n\n// Load the data but don't show until at least `activateTimeout` Only used when\n// loading via mouseover.\nfunction activateWithTimeoutFn(event: Event) {\n  activateFn(event, activateTimeout)\n}\n\n// When leaving a hovercard, deactivate unless we're moving to another child.\n// This allows the user to hover into the content area without dismissing.\nfunction deactivateFn(event: Event) {\n  if (!currentTarget) return\n\n  if (event instanceof MouseEvent && event.relatedTarget instanceof HTMLElement) {\n    const relatedTarget = event.relatedTarget\n    if (relatedTarget.closest('.js-hovercard-content') || relatedTarget.closest('[data-hovercard-url]')) {\n      return\n    }\n  } else if (event instanceof KeyboardEvent && activatingElement instanceof HTMLElement) {\n    // Return focus to where it was before the card was opened\n    activatingElement.focus()\n  }\n\n  hideCard()\n}\n\n// Deactivate after 250 ms unless the deactivate timer is canceled as a result\n// of the user entering the hovercard content area.\nfunction deactivateWithTimeoutFn(event: Event) {\n  const targetWas = currentTarget\n\n  deactivateTimer = window.setTimeout(() => {\n    if (currentTarget === targetWas) deactivateFn(event)\n  }, deactivateTimeout)\n}\n\n// Triggered when a key is pressed while either a container is focused, or\n// while inside of an open hovercard.\nfunction keyupFn(event: Event) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (!(event instanceof KeyboardEvent)) return\n  switch (event.key) {\n    case 'Escape':\n      deactivateFn(event)\n  }\n  /* eslint-enable no-restricted-syntax */\n}\n\n// Cancel the deactivation timer since the user is inside the content now\nfunction cancelDeactivation() {\n  if (deactivateTimer) clearTimeout(deactivateTimer)\n}\n\nif (cardContentContainer) {\n  observe('[data-hovercard-url]', {\n    subscribe: el =>\n      compose(\n        fromEvent(el, 'mouseover', activateWithTimeoutFn),\n        fromEvent(el, 'mouseleave', deactivateWithTimeoutFn),\n        fromEvent(el, 'keyup', keyupFn)\n      )\n  })\n\n  observe('[data-hovercard-url]', {\n    remove(el) {\n      // Hide the card if we're removing the element that triggered it\n      if (currentTarget === el) hideCard()\n    }\n  })\n\n  observe('.js-hovercard-content', {\n    subscribe: el =>\n      compose(\n        fromEvent(el, 'mouseover', cancelDeactivation),\n        fromEvent(el, 'mouseleave', deactivateFn),\n        fromEvent(el, 'keyup', keyupFn)\n      )\n  })\n\n  // eslint-disable-next-line delegated-events/global-on\n  on('menu:activated', 'details', hideCard)\n\n  window.addEventListener('statechange', hideCard)\n}\n\nfunction setZIndexOverride(target: Element, container: HTMLElement) {\n  const zIndex = target.getAttribute('data-hovercard-z-index-override')\n  if (zIndex) {\n    container.style.zIndex = zIndex\n  } else {\n    // Reset to initial z-index from Popover\n    container.style.zIndex = '100'\n  }\n}\n","import {loaded} from '../document-ready'\nimport {sendPageView} from '../hydro-analytics'\n;(async function () {\n  // PJAX should be treated like pageloads\n  document.addEventListener('pjax:complete', () =>\n    sendPageView({\n      pjax: 'true'\n    })\n  )\n\n  // Send a page view as soon as the page is loaded\n  await loaded\n  sendPageView()\n})()\n","import type {Context} from '@github/hydro-analytics-client'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {sendEvent} from '../hydro-analytics'\n\non('click', '[data-octo-click]', function (event) {\n  const targetEl = event.currentTarget\n  if (!(targetEl instanceof HTMLElement)) {\n    return\n  }\n\n  const eventType = targetEl.getAttribute('data-octo-click') || ''\n  const context: Context = {}\n\n  if (targetEl.hasAttribute('data-ga-click')) {\n    const gaEvent = targetEl.getAttribute('data-ga-click')!\n    const parts = gaEvent.split(',')\n    context.category = parts[0].trim()\n    context.action = parts[1].trim()\n  }\n\n  if (targetEl.hasAttribute('data-octo-dimensions')) {\n    const dimensionsList = targetEl.getAttribute('data-octo-dimensions')!.split(',')\n\n    for (const dimensionPair of dimensionsList) {\n      const [key, value] = dimensionPair.split(/:(.+)/)\n      if (key) {\n        context[key] = value || ''\n      }\n    }\n  }\n  sendEvent(eventType, context)\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {sendData} from '../hydro-tracking'\n\non('click', '[data-hydro-click]', function (event) {\n  const el = event.currentTarget\n  const payload = el.getAttribute('data-hydro-click') || ''\n  const hmac = el.getAttribute('data-hydro-click-hmac') || ''\n  const hydroClientContext = el.getAttribute('data-hydro-client-context') || ''\n  sendData(payload, hmac, hydroClientContext)\n})\n\non('click', '[data-optimizely-hydro-click]', function (event) {\n  const el = event.currentTarget\n  const payload = el.getAttribute('data-optimizely-hydro-click') || ''\n  const hmac = el.getAttribute('data-optimizely-hydro-click-hmac') || ''\n  sendData(payload, hmac, '')\n})\n","// Handle immediate updates returned from the server on ajax success.\n//\n// See ShowPartial#render_immediate_partials\n\nimport {remoteForm} from '@github/remote-form'\nimport {replaceContent} from '../updatable-content'\n\nremoteForm('.js-immediate-updates', async function (form, wants) {\n  let updateContent\n\n  try {\n    const response = await wants.json()\n    updateContent = response.json.updateContent\n  } catch (error) {\n    if (error.response.json) {\n      updateContent = error.response.json.updateContent\n    }\n  }\n\n  if (updateContent) {\n    for (const selector in updateContent) {\n      const html = updateContent[selector]\n      const el = document.querySelector(selector)\n      if (el instanceof HTMLElement) {\n        replaceContent(el, html)\n      }\n    }\n  }\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('[data-indeterminate]', {\n  constructor: HTMLInputElement,\n  initialize(el) {\n    el.indeterminate = true\n  }\n})\n","import {logPageView} from '../jump-to/page-views'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nfunction load() {\n  import('../jump-to')\n}\n\nobserve('.js-jump-to-field', {\n  constructor: HTMLInputElement,\n  add(el) {\n    el.addEventListener('focusin', load, {once: true})\n    logPageView(window.location.pathname)\n  }\n})\n","import {dialog} from '../details-dialog'\nimport {eventToHotkeyString} from '@github/hotkey'\nimport {fetchSafeDocumentFragment} from '../fetch'\nimport {isFormField} from '../form'\nimport {isShortcutAllowed} from './keyboard-shortcuts-helper'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nlet shortcutModalShown = false\n\nasync function showKeyboardShortcuts() {\n  if (shortcutModalShown) return\n  shortcutModalShown = true\n\n  const metaKeyboardShortcuts = document.querySelector<HTMLMetaElement>('meta[name=github-keyboard-shortcuts]')!\n  const options = {contexts: metaKeyboardShortcuts.content}\n  const url = `/site/keyboard_shortcuts?${new URLSearchParams(options).toString()}`\n\n  const shortcutModal = await dialog({\n    content: fetchSafeDocumentFragment(document, url),\n    labelledBy: 'keyboard-shortcuts-heading'\n  })\n  shortcutModal.style.width = '800px'\n  shortcutModal.addEventListener(\n    'dialog:remove',\n    function () {\n      shortcutModalShown = false\n    },\n    {once: true}\n  )\n}\n\n// Toggles ajax request to display keyboard shortcuts.\n//\n// Add a class of `js-keyboard-shortcuts` to get this behavior on your page.\non('click', '.js-keyboard-shortcuts', showKeyboardShortcuts)\n\ndocument.addEventListener('keydown', (event: Event) => {\n  if (!(event instanceof KeyboardEvent)) return\n  if (!isShortcutAllowed(event)) return\n\n  if (event.target instanceof Node && isFormField(event.target)) return\n  if (eventToHotkeyString(event) !== 'Shift+?') return\n  showKeyboardShortcuts()\n})\n\nobserve('.js-modifier-key', {\n  constructor: HTMLElement,\n  add(container) {\n    if (/Macintosh/.test(navigator.userAgent)) {\n      let shortcut = container.textContent\n      if (shortcut) {\n        shortcut = shortcut.replace(/ctrl/, '')\n        shortcut = shortcut.replace(/alt/, '')\n        container.textContent = shortcut\n      }\n    }\n  }\n})\n\nobserve('.js-modifier-label-key', {\n  add(container) {\n    let shortcutLabel = container.textContent?.replace(/ctrl/i, 'Ctrl')\n    if (!shortcutLabel) return\n    if (/Macintosh/.test(navigator.userAgent)) {\n      shortcutLabel = shortcutLabel.replace(/ctrl/i, 'Cmd')\n      shortcutLabel = shortcutLabel.replace(/alt/i, 'Option')\n    }\n    container.textContent = shortcutLabel\n  }\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Length-limited input with warning.\n//\n// Limit the length of user input and provide a warning with a character count\n// when the user approaches the length limit.\n//\n// Three classes must be set.\n//  - js-length-limited-input.\n//  - js-length-limited-input-container.\n//  - js-length-limited-input-warning (probably also hidden by default).\n//\n// Two data attributes should be set on .js-length-limited-input:\n//  - data-warning-text, a string template for the warning message.\n//    Use `{{remaining}}` to interpolate the number of characters remaining.\n//  - data-input-max-length.\n//\n// @example\n// ```html\n//    <dd class=\"js-length-limited-input-container\">\n//      <input type=\"text\"\n//             class=\"js-length-limited-input\"\n//             data-warning-text=\"You have {{remaining}} characters remaining\"\n//             data-input-max-length=\"160\">\n//\n//      <p class=\"js-length-limited-input-warning d-none\">\n//      </p>\n//    </dd>\n// ```\nfunction displayLengthWarning(event: Event) {\n  // The user input field (<input>, <textarea>, etc)\n  const inputField = event.currentTarget\n  if (!(inputField instanceof HTMLInputElement || inputField instanceof HTMLTextAreaElement)) return\n\n  // The character limit, set in data attribute \"max-length\"\n  const maxLength = parseInt(inputField.getAttribute('data-input-max-length') || '', 10)\n\n  // The remaining length to start showing the warning for, defaults to 5\n  const warningLength = parseInt(inputField.getAttribute('data-warning-length') || '', 10) || 5\n\n  // The user input field (<input>, <textarea>, etc)\n  const inputValue = inputField.value\n\n  // New lines need to be counted as two characters. They are by the server.\n  const inputValueWithNewLinesFix = inputValue.replace(/(\\r\\n|\\n|\\r)/g, '\\r\\n')\n\n  // Characters remaining before the limit is reached\n  let remainingLength = maxLength - inputValueWithNewLinesFix.length\n\n  // HTML maxLength attribute does not count carriage returns correctly.\n  // It is also inconsistent between Chrome and Firefox\n  // and therefore can't be used bugfree without browser sniffing\n  // Creating our own maxLength implementation instead.\n  if (remainingLength <= 0) {\n    let truncatedInputValue = inputValueWithNewLinesFix.substr(0, maxLength)\n    // Trim trailing \\r so we don't truncate in the middle of a \\r\\n newline\n    if (truncatedInputValue.endsWith('\\r')) {\n      truncatedInputValue = truncatedInputValue.substr(0, maxLength - 1)\n      remainingLength = 1\n    } else {\n      remainingLength = 0\n    }\n    inputField.value = truncatedInputValue\n  }\n\n  // The warning message to display after the remaining character count\n  const warningText = inputField.getAttribute('data-warning-text')!\n\n  // The container enclosing the length-limited input field\n  const inputContainer = inputField.closest<HTMLElement>('.js-length-limited-input-container')!\n\n  // The container for the warning message\n  const warningArea = inputContainer.querySelector<HTMLElement>('.js-length-limited-input-warning')!\n\n  if (remainingLength <= warningLength) {\n    warningArea.textContent = warningText.replace(new RegExp('{{remaining}}', 'g'), `${remainingLength}`)\n    /* eslint-disable-next-line github/no-d-none */\n    warningArea.classList.remove('d-none')\n  } else {\n    warningArea.textContent = ''\n    /* eslint-disable-next-line github/no-d-none */\n    warningArea.classList.add('d-none')\n  }\n}\n\nobserve('.js-length-limited-input', {\n  add(el) {\n    el.addEventListener('input', displayLengthWarning)\n    el.addEventListener('change', displayLengthWarning)\n  },\n  remove(el) {\n    el.removeEventListener('input', displayLengthWarning)\n    el.removeEventListener('change', displayLengthWarning)\n  }\n})\n","// <link rel=\"prefetch-viewed\">\n//\n// See Also\n//   app/helpers/prefetch_helper.rb\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('link[rel=prefetch-viewed]', {\n  initialize() {\n    window.requestIdleCallback(() => {\n      fetch(location.href, {\n        method: 'HEAD',\n        credentials: 'same-origin',\n        headers: {\n          Purpose: 'prefetch-viewed'\n        }\n      })\n    })\n  }\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\n\non('click', '.js-member-search-filter', function (event) {\n  event.preventDefault()\n\n  const filter = event.currentTarget.getAttribute('data-filter')!\n  const menu = event.currentTarget.closest<HTMLElement>('[data-filter-on]')!\n  const filterOn = menu.getAttribute('data-filter-on')!\n  const field = document.querySelector<HTMLInputElement>('.js-member-filter-field')!\n\n  // Remove any existing filters on the opened dropdown.\n  const currentValue = field.value\n\n  // Regex allows a-z chars, underscores & strings wrapped in single quotes (required for custom roles)\n  const regex = new RegExp(`${filterOn}:(?:[a-z]|_|((').*(')))+`)\n  const currentFilters = currentValue.toString().trim().replace(regex, '')\n\n  field.value = `${currentFilters} ${filter}`.replace(/\\s\\s/, ' ').trim()\n  field.focus()\n  fire(field, 'input')\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('auto-check-success', '.js-new-organization-name', function (event) {\n  const field = event.target as HTMLInputElement\n  const container = field.closest<HTMLElement>('dd')!\n  const hint = container.querySelector('.js-field-hint-name')\n  if (!hint) {\n    return\n  }\n  hint.textContent = field.value\n})\n","// Notice Behavior\n//\n// Add basic data-remote success hook for hiding notice on ajax\n// success.\n//\n// Markup\n//\n//     <div class=\"js-notice\">\n//       Hey!\n//       <a href=\"/dismiss\" class=\"js-notice-dismiss\">\n//         Dismiss\n//       </a>\n//     </div>\n//\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\nimport {showGlobalError} from '../behaviors/ajax-error'\n\nremoteForm('.js-notice-dismiss', async function (form, send) {\n  await send.text()\n  const notice = form.closest<HTMLElement>('.js-notice')!\n  notice.remove()\n})\n\non('submit', '.js-notice-dismiss-remote', async function (event) {\n  const form = event.currentTarget as HTMLFormElement\n  event.preventDefault()\n  let response\n  try {\n    response = await fetch(form.action, {\n      method: form.method,\n      body: new FormData(form),\n      headers: {\n        Accept: 'application/json',\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    })\n  } catch {\n    showGlobalError()\n    return\n  }\n  if (response && !response.ok) {\n    showGlobalError()\n  } else {\n    const notice = form.closest<HTMLElement>('.js-notice')!\n    notice.remove()\n  }\n})\n","// If the current page is openable in github.dev, do so on click.\n// This would be achievable without any custom JS by just using\n// data-hotkey except for two things:\n//  - PJAX and other replaceState-triggered location updates like\n//    the `y` hotkey need to be respected.\n//  - the editor cares about the hash of the page.\n// So we'll construct the href client-side.\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nfunction isVisible(el: HTMLElement) {\n  try {\n    const rect = el.getBoundingClientRect()\n    if (rect.height === 0 && rect.width === 0) {\n      return false\n    }\n    if (el.style.opacity === '0' || el.style.visibility === 'hidden') {\n      return false\n    }\n  } catch {\n    // fall through to return true below\n  }\n  return true\n}\n\non('click', '.js-github-dev-shortcut', function (event) {\n  event.preventDefault()\n  // If content exists in any visble comment field, prompt before navigating to github.dev\n  for (const el of document.querySelectorAll<HTMLTextAreaElement>('textarea.js-comment-field')) {\n    // eslint-disable-next-line i18n-text/no-en\n    if (el.value && isVisible(el) && !confirm('Are you sure you want to open github.dev?')) {\n      return\n    }\n  }\n  // Assumption: the href of the shortcut is the base URL for\n  // the serverless editor, e.g. https://github.dev/\n  const target = event.currentTarget as HTMLAnchorElement\n  target.pathname = window.location.pathname\n  target.hash = window.location.hash\n  window.location.href = target.href\n})\n\non('click', '.js-github-dev-new-tab-shortcut', function (event) {\n  // Assumption: the href of the shortcut is the base URL for\n  // the serverless editor, e.g. https://github.dev/\n  const target = event.currentTarget as HTMLAnchorElement\n  target.pathname = window.location.pathname\n  target.hash = window.location.hash\n})\n","// If the current page is openable in blackbird, do so on click.\n// This would be achievable without any custom JS by just using\n// data-hotkey except for two things:\n//  - PJAX and other replaceState-triggered location updates like\n//    the `y` hotkey need to be respected.\n//  - the editor cares about the hash of the page.\n// So we'll construct the href client-side.\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nexport function getBlackbirdURL(blackbirdLink: HTMLAnchorElement, currentURL: URL, selection?: string): URL {\n  const output = new URL('', window.location.origin)\n  const pathComponents = currentURL.pathname.split('/')\n  output.pathname = pathComponents.slice(1, 3).join('/')\n  output.hash = currentURL.hash\n\n  // If the user has currently selected something, search for that\n  if (selection) {\n    output.search = `?q=${encodeURIComponent(selection)}`\n  }\n\n  // If the URL contains a ?q=..., let's forward that to blackbird\n  const u = new URLSearchParams(currentURL.search)\n  const search = u.get('q')\n  if (search) {\n    output.search = `?q=${encodeURIComponent(search)}`\n  }\n\n  // If the path is a blob or tree view path, jump to the corresponding view in blackbird\n  else if (pathComponents.length >= 6 && (pathComponents[3] === 'blob' || pathComponents[3] === 'tree')) {\n    output.pathname = currentURL.pathname\n  }\n\n  output.host = blackbirdLink.host\n  output.protocol = blackbirdLink.protocol\n  output.port = blackbirdLink.port\n  return output\n}\n\non('click', '.js-blackbird-shortcut', function (event) {\n  // Assumption: the href of the shortcut is the base URL for\n  // the blackbird frontend, e.g. https://cs.github.com/\n  const target = event.currentTarget as HTMLAnchorElement\n  const blackbirdURL = getBlackbirdURL(\n    target,\n    new URL(window.location.href, window.location.origin),\n    window.getSelection()?.toString()\n  )\n  target.href = blackbirdURL.href\n})\n","// Append any window.location.hash changes to the permalink.\n//\n// For example, if you're viewing:\n// /github/linguist/blob/master/lib/linguist/languages.yml#L12\n//\n// You probably want the permalink to preserve the #L12, and go to:\n// /github/linguist/blob/SHA/lib/linguist/languages.yml#L12\n//\n//\n// Also update link that we want to keep in sync with the permalink change.\n//\n// For example, if you `y` a Markdown file and click the \"Display as source blob\"\n// button, probably you want its link (href) to change from:\n// /github/linguist/blob/master/README.md?plain=1\n//\n// to:\n// /github/linguist/blob/SHA/README.md?plain=1\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {replaceState} from '../history'\n\non('click', '.js-permalink-shortcut', function (event) {\n  const target = event.currentTarget as HTMLAnchorElement\n  try {\n    replaceState(null, '', target.href + window.location.hash)\n  } catch (error) {\n    window.location.href = target.href + window.location.hash\n  }\n  for (const element of document.querySelectorAll('.js-permalink-replaceable-link')) {\n    if (element instanceof HTMLAnchorElement) {\n      element.href = element.getAttribute('data-permalink-href')!\n    }\n  }\n  event.preventDefault()\n})\n","import {remoteForm} from '@github/remote-form'\n\nremoteForm('.js-permission-menu-form', async function (form, wants) {\n  const success = form.querySelector<HTMLElement>('.js-permission-success')!\n  const error = form.querySelector<HTMLElement>('.js-permission-error')!\n\n  success.hidden = true\n  error.hidden = true\n  form.classList.add('is-loading')\n\n  let response\n  try {\n    response = await wants.json()\n  } catch (e) {\n    // If the request errored, we'll set the error state and return.\n    form.classList.remove('is-loading')\n    error.hidden = false\n    return\n  }\n\n  form.classList.remove('is-loading')\n  success.hidden = false\n\n  const container = form.closest('.js-org-repo')\n  if (container) {\n    const data = response.json\n    container.classList.toggle('with-higher-access', data['members_with_higher_access'])\n  }\n})\n","import {ready} from '../document-ready'\n;(async function () {\n  await ready\n\n  // loading bar at the top of the page for pjax actions\n  const bar = document.querySelector('.js-pjax-loader-bar')\n  if (!bar) {\n    return\n  }\n\n  const progressEl = bar.firstElementChild\n  if (!(progressEl instanceof HTMLElement)) {\n    return\n  }\n\n  let width = 0\n  let incTimer: number | null = null\n  let originalTransition: string | null = null\n\n  function initiateLoader() {\n    setWidth(0)\n    if (bar) bar.classList.add('is-loading')\n    incTimer = window.setTimeout(increment, 0)\n  }\n\n  // Set the new width of the progress bar.\n  function setWidth(newWidth: number) {\n    if (!(progressEl instanceof HTMLElement)) return\n    if (newWidth === 0) {\n      if (originalTransition == null) originalTransition = getComputedStyle(progressEl).transition\n      progressEl.style.transition = 'none'\n    }\n\n    width = newWidth\n    progressEl.style.width = `${width}%`\n\n    if (newWidth === 0) {\n      progressEl.clientWidth // ensure previous style gets fully applied without transition\n      progressEl.style.transition = originalTransition || ''\n    }\n  }\n\n  function increment() {\n    // First animation should be more\n    if (width === 0) width = 12\n    setWidth(Math.min(width + 3, 95))\n    incTimer = window.setTimeout(increment, 500)\n  }\n\n  function finishLoader() {\n    if (incTimer) {\n      clearTimeout(incTimer)\n    }\n    setWidth(100)\n    if (bar) bar.classList.remove('is-loading')\n  }\n\n  document.addEventListener('pjax:start', initiateLoader)\n  document.addEventListener('pjax:end', finishLoader)\n})()\n","import {microtask} from '../eventloop-tasks'\nimport {sendStats} from '../stats'\n\nlet lastPjaxRequestUrl: string | null = null\n\n// Collect User Timing metrics so we can track time-to-load on pjax actions\nconst pjaxMeasure = 'last_pjax_request'\nconst pjaxStartMark = 'pjax_start'\nconst pjaxEndMark = 'pjax_end'\n\n// Mark pjax start on performance timeline and save url for last pjax request.\nfunction markPjaxStart(event: CustomEvent<{url?: string}>) {\n  if (event instanceof CustomEvent && event.detail && event.detail.url) {\n    window.performance.mark(pjaxStartMark)\n    lastPjaxRequestUrl = event.detail.url\n  }\n}\n\n// Mark pjax end on performance timeline and report results.\nasync function trackPjaxTiming() {\n  await microtask()\n\n  if (!window.performance.getEntriesByName(pjaxStartMark).length) return\n\n  window.performance.mark(pjaxEndMark)\n  window.performance.measure(pjaxMeasure, pjaxStartMark, pjaxEndMark)\n  const measures = window.performance.getEntriesByName(pjaxMeasure)\n\n  const measure = measures.pop()\n  const duration = measure ? measure.duration : null\n  if (!duration) return\n\n  if (lastPjaxRequestUrl) {\n    sendStats({\n      requestUrl: lastPjaxRequestUrl,\n      pjaxDuration: Math.round(duration)\n    })\n  }\n  clearPjaxMarks()\n}\n\n// Clear pjax marks from performance timeline.\nfunction clearPjaxMarks() {\n  window.performance.clearMarks(pjaxStartMark)\n  window.performance.clearMarks(pjaxEndMark)\n  window.performance.clearMeasures(pjaxMeasure)\n}\n\nif ('getEntriesByName' in window.performance) {\n  document.addEventListener('pjax:start', markPjaxStart)\n  document.addEventListener('pjax:end', trackPjaxTiming)\n}\n","import {microtask} from '../eventloop-tasks'\nimport {sendStats} from '../stats'\n\nlet lastTurboRequestUrl: string | null = null\n\n// Collect User Timing metrics so we can track time-to-load on turbo actions\nconst turboMeasure = 'last_turbo_request'\nconst turboStartMark = 'turbo_start'\nconst turboEndMark = 'turbo_end'\n\n// Mark turbo start on performance timeline and save url for last turbo request.\nfunction markTurboStart(event: Event) {\n  if (!(event instanceof CustomEvent)) return\n  if (!event.detail?.url) return\n\n  window.performance.mark(turboStartMark)\n  lastTurboRequestUrl = event.detail.url\n}\n\n// Mark turbo end on performance timeline and report results.\nasync function trackTurboTiming() {\n  await microtask()\n\n  if (!window.performance.getEntriesByName(turboStartMark).length) return\n\n  window.performance.mark(turboEndMark)\n  window.performance.measure(turboMeasure, turboStartMark, turboEndMark)\n  const measures = window.performance.getEntriesByName(turboMeasure)\n\n  const measure = measures.pop()\n  const duration = measure ? measure.duration : null\n  if (!duration) return\n\n  if (lastTurboRequestUrl) {\n    sendStats({\n      requestUrl: lastTurboRequestUrl,\n      turboDuration: Math.round(duration)\n    })\n  }\n  clearTurboMarks()\n}\n\n// Clear turbo marks from performance timeline.\nfunction clearTurboMarks() {\n  window.performance.clearMarks(turboStartMark)\n  window.performance.clearMarks(turboEndMark)\n  window.performance.clearMeasures(turboMeasure)\n}\n\nif ('getEntriesByName' in window.performance) {\n  document.addEventListener('turbo:before-fetch-request', markTurboStart)\n  document.addEventListener('turbo:render', trackTurboTiming)\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Checks if two urls start with the same \"/owner/repo\" prefix.\nfunction isSameRepo(url1: string, url2: string): boolean {\n  const path1 = url1.split('/', 3).join('/')\n  const path2 = url2.split('/', 3).join('/')\n  return path1 === path2\n}\n\n// Disable cross-repo PJAX navigation\non('pjax:click', '#js-repo-pjax-container a[href]', function (event) {\n  const url = (event.currentTarget as HTMLAnchorElement).pathname\n\n  if (!isSameRepo(url, location.pathname)) {\n    event.preventDefault()\n  }\n})\n\n// Disable document download PJAX from /:owner/:repo/files/:id/:name.\non('pjax:click', '.js-comment-body', function (event) {\n  const link = event.target\n  if (link instanceof HTMLAnchorElement && link.pathname.split('/')[3] === 'files') {\n    event.preventDefault()\n  }\n})\n","import {detectContainer, preserveScrollTo} from './utils'\nimport {isFeatureEnabled} from '../../features'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport pjaxRequest from '../pjax'\n\non('click', '[data-pjax] a, a[data-pjax]', function (event) {\n  const link = event.currentTarget\n  if (link instanceof HTMLAnchorElement) {\n    if (link.getAttribute('data-skip-pjax') != null) {\n      return\n    }\n    if (link.getAttribute('data-remote') != null) {\n      return\n    }\n\n    const container = detectContainer(link)\n    if (container) {\n      click(event, {\n        container,\n        scrollTo: preserveScrollTo(link)\n      })\n    }\n  }\n})\n\non('change', 'select[data-pjax]', function (event) {\n  if (isFeatureEnabled('PJAX_DISABLED') || isFeatureEnabled('TURBO')) return\n\n  const select = event.currentTarget as HTMLSelectElement\n  const container = detectContainer(select)\n  if (container) {\n    pjaxRequest({url: select.value, container})\n  }\n})\n\nfunction click(event: MouseEvent, options: {container: Element; scrollTo?: number | false}) {\n  if (isFeatureEnabled('PJAX_DISABLED') || isFeatureEnabled('TURBO')) return\n\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  const link = event.currentTarget as HTMLAnchorElement\n\n  // Middle click, cmd click, and ctrl click should open\n  // links in a new tab as normal.\n  if (event.button !== 0 || event.metaKey || event.ctrlKey || event.shiftKey || event.altKey) return\n\n  // Ignore cross origin links\n  if (location.protocol !== link.protocol || location.hostname !== link.hostname) return\n\n  // Ignore case when a hash is being tacked on the current URL\n  if (link.href.indexOf('#') > -1 && stripHash(link) === stripHash(location)) return\n\n  // Ignore event with default prevented\n  if (event.defaultPrevented) return\n\n  const opts = {\n    url: link.href,\n    target: link,\n    ...options\n  }\n\n  const clickEvent = new CustomEvent('pjax:click', {\n    bubbles: true,\n    cancelable: true,\n    detail: {options: opts, relatedEvent: event}\n  })\n\n  if (link.dispatchEvent(clickEvent)) {\n    pjaxRequest(opts)\n    event.preventDefault()\n    link.dispatchEvent(new CustomEvent('pjax:clicked', {bubbles: true, cancelable: true, detail: {options: opts}}))\n  }\n  /* eslint-enable no-restricted-syntax */\n}\n\n// Return the `href` component of given URL object with the hash portion removed.\nfunction stripHash(location: Location | HTMLAnchorElement): string {\n  return location.href.replace(/#.*/, '')\n}\n","import {detectContainer, preserveScrollTo} from './utils'\nimport pjaxRequest, {PjaxOptions} from '../pjax'\nimport {isFeatureEnabled} from '../../features'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {serialize} from '../../form'\n\non('submit', 'form[data-pjax]', function (event) {\n  if (isFeatureEnabled('PJAX_DISABLED') || isFeatureEnabled('TURBO')) return\n\n  const form = event.currentTarget as HTMLFormElement\n  const container = detectContainer(form)\n\n  if (!container) {\n    return\n  }\n\n  const scrollTo = preserveScrollTo(form)\n\n  const opts: PjaxOptions = {\n    type: (form.method || 'GET').toUpperCase(),\n    url: form.action,\n    target: form,\n    scrollTo,\n    container\n  }\n\n  if (opts.type === 'GET') {\n    // Can't handle file uploads, exit\n    if (form.querySelector('input[type=file]')) {\n      return\n    }\n\n    const url = parseURL(opts.url)\n    url.search += (url.search ? '&' : '') + serialize(form)\n    opts.url = url.toString()\n  } else {\n    opts.data = new FormData(form)\n  }\n\n  pjaxRequest(opts)\n  event.preventDefault()\n})\n\nfunction parseURL(url: string): HTMLAnchorElement {\n  const a = document.createElement('a')\n  a.href = url\n  return a\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('body.js-print-popup', () => {\n  window.print()\n  setTimeout(window.close, 1000)\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('poll-include-fragment[data-redirect-url]', function (el) {\n  const url = el.getAttribute('data-redirect-url')!\n  el.addEventListener('load', function () {\n    window.location.href = url\n  })\n})\n\nobserve('poll-include-fragment[data-reload]', function (el) {\n  el.addEventListener('load', function () {\n    window.location.reload()\n  })\n})\n","// Reports a proxy site and applies rudimentary obfuscation to the data that is sent.\n\nimport detectProxySite from '../proxy-site-detection'\nimport {reportError} from '../failbot'\n\n// See lib/github/proxy_detection.rb\nconst ProxyDetectionParam = '$__'\n\nconst proxyPayload = document.querySelector('meta[name=js-proxy-site-detection-payload]')\nconst expectedHostname = document.querySelector('meta[name=expected-hostname]')\n\nif (proxyPayload instanceof HTMLMetaElement && expectedHostname instanceof HTMLMetaElement) {\n  if (detectProxySite(document)) {\n    const data = {\n      url: window.location.href,\n      expectedHostname: expectedHostname.content,\n      documentHostname: document.location.hostname,\n      proxyPayload: proxyPayload.content\n    }\n\n    const error = new Error()\n    const obj: {[key: string]: string} = {}\n    obj[`${ProxyDetectionParam}`] = btoa(JSON.stringify(data))\n    reportError(error, obj)\n  }\n}\n","// Quick submit using -Enter or Ctrl+Enter\n//\n// When `.js-quick-submit` field is focused, -Enter or Ctrl+Enter will submit\n// the form it belongs to unless the first submit button of that form is disabled.\n\nimport {onKey} from '../onfocus'\nimport {requestSubmit} from '../form'\n\nonKey('keydown', '.js-quick-submit', function (event: KeyboardEvent) {\n  quickSubmit(event)\n})\n\nfunction quickSubmit(event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  const field = event.target as HTMLInputElement | HTMLTextAreaElement\n\n  if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {\n    const form = field.form!\n    const button = form.querySelector('input[type=submit], button[type=submit]')\n    if (event.shiftKey) {\n      const altButton = form.querySelector('.js-quick-submit-alternative')\n      if ((altButton instanceof HTMLInputElement || altButton instanceof HTMLButtonElement) && !altButton.disabled) {\n        requestSubmit(form, altButton)\n      }\n    } else if (button instanceof HTMLInputElement || button instanceof HTMLButtonElement) {\n      if (!button.disabled) {\n        requestSubmit(form)\n      }\n    } else {\n      requestSubmit(form)\n    }\n    event.preventDefault()\n  }\n  /* eslint-enable no-restricted-syntax */\n}\n","import {MarkdownQuote, Quote} from '@github/quote-selection'\nimport {debounce} from '@github/mini-throttle'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport visible from '../visible'\n\nlet activeSelection: SelectionContext | null\n\n// Hide the \"Quote reply\" button on threads where there is no textarea to quote\n// text into. This prevents it from showing up on locked threads.\nobserve('.js-comment-quote-reply', function (button) {\n  ;(button as HTMLElement).hidden =\n    button\n      .closest('.js-quote-selection-container')\n      ?.querySelector('.js-inline-comment-form-container textarea, .js-new-comment-form textarea') == null\n})\n\nfunction isHighlightContainer(el: Element): boolean {\n  return el.nodeName === 'DIV' && el.classList.contains('highlight')\n}\n\nfunction hasContent(node: Node): boolean {\n  return node.nodeName === 'IMG' || node.firstChild != null\n}\n\nconst filters: {[key: string]: (arg0: HTMLElement) => string | HTMLElement} = {\n  PRE(el) {\n    const parent = el.parentElement\n    if (parent && isHighlightContainer(parent)) {\n      const match = parent.className.match(/highlight-source-(\\S+)/)\n      const flavor = match ? match[1] : ''\n      const text = (el.textContent || '').replace(/\\n+$/, '')\n      el.textContent = `\\`\\`\\`${flavor}\\n${text}\\n\\`\\`\\``\n      el.append('\\n\\n')\n    }\n    return el\n  },\n  A(el) {\n    const text = el.textContent || ''\n    if (el.classList.contains('user-mention') || el.classList.contains('team-mention')) {\n      return text\n    } else if (el.classList.contains('issue-link') && /^#\\d+$/.test(text)) {\n      return text\n    } else {\n      return el\n    }\n  },\n  IMG(el) {\n    const alt = el.getAttribute('alt')\n    if (alt && el.classList.contains('emoji')) {\n      return alt\n    } else {\n      return el\n    }\n  },\n  DIV(el) {\n    if (el.classList.contains('js-suggested-changes-blob')) {\n      // skip quoting suggested changes widget\n      el.remove()\n    } else if (el.classList.contains('blob-wrapper-embedded')) {\n      // handle embedded blob snippets\n      const container = el.parentElement!\n      const link = container.querySelector<HTMLAnchorElement>('a[href]')!\n      const p = document.createElement('p')\n      p.textContent = link.href\n      container.replaceWith(p)\n    }\n    return el\n  }\n}\n\nfunction insertMarkdownSyntax(root: DocumentFragment): void {\n  const nodeIterator = document.createNodeIterator(root, NodeFilter.SHOW_ELEMENT, {\n    acceptNode(node) {\n      if (node.nodeName in filters && hasContent(node)) {\n        return NodeFilter.FILTER_ACCEPT\n      } else {\n        return NodeFilter.FILTER_SKIP\n      }\n    }\n  })\n  const results: HTMLElement[] = []\n  let node = nodeIterator.nextNode()\n\n  while (node) {\n    if (node instanceof HTMLElement) {\n      results.push(node)\n    }\n    node = nodeIterator.nextNode()\n  }\n\n  // process deepest matches first\n  results.reverse()\n\n  for (const el of results) {\n    el.replaceWith(filters[el.nodeName](el))\n  }\n}\n\non('click', '.js-comment-quote-reply', function ({isTrusted, currentTarget}) {\n  const container = currentTarget.closest<HTMLElement>('.js-comment')!\n  const commentBody = container.querySelector<HTMLElement>('.js-comment-body')!\n  const commentBodyClone = container.querySelector<HTMLElement>('.js-comment-body')!.cloneNode(true)\n  const quoteSelectionContainer = container.closest('.js-quote-selection-container')!\n  // Remove elements that contain meta info and should not be present in the quoted text\n  const ignorableElements = commentBody.querySelectorAll('button.js-convert-to-issue-button, span.js-clear')\n  for (const el of ignorableElements) {\n    el.remove()\n  }\n  let quote = new Quote()\n\n  // User pressed `r` but has nothing selected\n  if (!isTrusted && quote.range.collapsed) {\n    return\n  }\n\n  if (quoteSelectionContainer.hasAttribute('data-quote-markdown')) {\n    quote = new MarkdownQuote(\n      quoteSelectionContainer.getAttribute('data-quote-markdown') || '',\n      (fragment: DocumentFragment) => {\n        const parent = quote.range.startContainer.parentElement\n        const codeBlock = parent && parent.closest('pre')\n        if (codeBlock instanceof HTMLElement) {\n          const pp = codeBlock.parentElement\n          if (pp && isHighlightContainer(pp)) {\n            const div = document.createElement('div')\n            div.className = pp.className\n            div.appendChild(fragment)\n            fragment.appendChild(div)\n          }\n        }\n        insertMarkdownSyntax(fragment)\n      }\n    )\n  }\n\n  // If the user has selected text before clicking the dropdown, use that as the quote.\n  // (Workaround for Safari clearing the selection just before <details> is opened).\n  if (activeSelection && commentBody.contains(activeSelection.anchorNode)) {\n    quote.range = activeSelection.range\n  } else if (quote.range.collapsed) {\n    quote.select(commentBody)\n  }\n\n  if (quote.closest('.js-quote-selection-container') !== quoteSelectionContainer) return\n\n  // Capture the current range incase elements switch focus\n  const range = quote.range\n\n  quoteSelectionContainer.dispatchEvent(\n    new CustomEvent('quote-selection', {\n      bubbles: true,\n      detail: quote\n    })\n  )\n\n  // Replace the range for elements that changed focus\n  quote.range = range\n\n  for (const textarea of quoteSelectionContainer.querySelectorAll('textarea')) {\n    if (visible(textarea)) {\n      quote.insert(textarea)\n      break\n    }\n  }\n\n  // Restore the HTML to it's initial form. The ignorable elements had to be removed\n  // So that the quote lib would not include then into the selection\n  container.querySelector<HTMLElement>('.js-comment-body')!.replaceWith(commentBodyClone)\n})\n\ntype SelectionContext = {\n  anchorNode: Node | null\n  range: Range\n}\n\n// Workaround for Safari clearing the selection just before a <details> element\n// was activated: persist the previous selection and use its range when quoting.\nlet previousSelection: SelectionContext | null\n\ndocument.addEventListener(\n  'selectionchange',\n  debounce(function () {\n    const selection = window.getSelection()!\n    let range\n    try {\n      range = selection.getRangeAt(0)\n    } catch {\n      previousSelection = null\n      return\n    }\n    previousSelection = {\n      anchorNode: selection.anchorNode,\n      range\n    }\n  }, 100)\n)\ndocument.addEventListener(\n  'toggle',\n  () => {\n    activeSelection = previousSelection\n  },\n  {capture: true}\n)\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {parseHTML} from '../parse-html'\nimport {remoteForm} from '@github/remote-form'\n\nremoteForm('.js-pick-reaction', async function (form, send) {\n  const response = await send.json()\n\n  const comment = form.closest<HTMLElement>('.js-comment')!\n  const reactionsContainer = comment.querySelector<HTMLElement>('.js-reactions-container')!\n  const reactionsHeader = comment.querySelector<HTMLElement>('.js-comment-header-reaction-button')!\n\n  const newReactions = parseHTML(document, response.json['reactions_container'].trim())\n  const newReactionButton = parseHTML(document, response.json['comment_header_reaction_button'].trim())\n  reactionsContainer.replaceWith(newReactions)\n  reactionsHeader.replaceWith(newReactionButton)\n})\n\nfunction showReactionContent(event: MouseEvent) {\n  const target = event.target as HTMLElement\n\n  const label = target.getAttribute('data-reaction-label')!\n  const container = target.closest<HTMLElement>('.js-add-reaction-popover')!\n  const description = container.querySelector<HTMLElement>('.js-reaction-description')!\n\n  if (!description.hasAttribute('data-default-text')) {\n    description.setAttribute('data-default-text', description.textContent || '')\n  }\n\n  description.textContent = label\n}\n\nfunction hideReactionContent(event: MouseEvent) {\n  const container = (event.target as HTMLElement).closest<HTMLElement>('.js-add-reaction-popover')!\n  const description = container.querySelector<HTMLElement>('.js-reaction-description')!\n\n  const defaultText = description.getAttribute('data-default-text')\n  if (defaultText) {\n    description.textContent = defaultText\n  }\n}\n\non(\n  'toggle',\n  '.js-reaction-popover-container',\n  function (event) {\n    const isOpen = event.currentTarget.hasAttribute('open')\n    for (const item of (event.target as Element).querySelectorAll<HTMLElement>('.js-reaction-option-item')) {\n      if (isOpen) {\n        item.addEventListener('mouseenter', showReactionContent)\n        item.addEventListener('mouseleave', hideReactionContent)\n      } else {\n        item.removeEventListener('mouseenter', showReactionContent)\n        item.removeEventListener('mouseleave', hideReactionContent)\n      }\n    }\n  },\n  {capture: true}\n)\n","// Remote\n//\n// Implements `data-remote` for forms.\n//\n//\n// Markup\n//\n// `<form>`\n//\n// ``` definition-table\n// Attribute - Description\n//\n// `data-remote`\n//   Enables remote behavior on the element if set to anything.\n//\n// `method`\n//   Changes the method of the AJAX request. Defaults to `\"get\"`. Maps to\n//   jQuery's [type](http://api.jquery.com/jQuery.ajax/).\n//\n// `action`\n//   URL for AJAX request. Defaults to the current url. Maps to jQuery's\n//   [`url`](http://api.jquery.com/jQuery.ajax/).\n//\n// `data-type`\n//   Specify the data type of the response. Can be `\"xml\"`, `\"json\"`,\n//   `\"script\"`, or `\"html\"`. Defaults to jQuery's *\"intelligent guess\"*\n//   from the response content type. Maps to jQuery's\n//   [`dataType`](http://api.jquery.com/jQuery.ajax/).\n// ```\n//\n// ``` html\n// <form action=\"/comment\" method=\"post\" data-remote></form>\n// ```\n//\n//\n// Events\n//\n// Use delegated jQuery's global AJAX events to handle successful\n// and error states. See jQuery's [AJAX event\n// documentation](http://docs.jquery.com/Ajax_Events) for a complete\n// reference.\n//\n// `deprecatedAjaxSuccess`\n//\n// This event is only called if the request was successful (no errors from the server, no errors with the data).\n//\n// ``` definition-table\n// Property - Value\n//\n// Synchronicity  - Sync\n// Bubbles        - Yes\n// Cancelable     - No\n// Target         - `form` element with `[data-remote]`\n// ```\n//\n// `ajaxError`\n//\n// This event is only called if an error occurred with the request (you can never\n// have both an error and a success callback with a request).\n//\n// ``` definition-table\n// Property - Value\n//\n// Synchronicity  - Sync\n// Bubbles        - Yes\n// Cancelable     - No\n// Target         - `form` element with `[data-remote]`\n// Extra arguments\n//   `status` - Status response number\n//   `error` - Error message string\n//   `text` - Response text string\n// ```\n//\n// `deprecatedAjaxComplete`\n//\n// This event is called regardless of if the request was successful, or not. You\n// will always receive a complete callback, even for synchronous requests.\n//\n// ``` definition-table\n// Property - Value\n//\n// Synchronicity  - Sync\n// Bubbles        - Yes\n// Cancelable     - No\n// Target         - `form` element with `[data-remote]`\n// ```\n//\n//     on('deprecatedAjaxSend', '.new-comment', function(event) {\n//        event.currentTarget.classList.add('loading')\n//     })\n//\n//     on('deprecatedAjaxComplete', '.new-comment', function(event) {\n//        event.currentTarget.classList.remove('loading')\n//     })\n//\n//     on('deprecatedAjaxSuccess', '.new-comment', function (event) {\n//        event.currentTarget.classList.add('success')\n//     })\n//\n//     on('deprecatedAjaxError', '.new-comment', function (event) {\n//       alert(\"Something went wrong!\")\n//     })\n//\n//\n// Intercept all form submissions with data-remote and turn\n// it into a XHR request instead.\n\nimport type {Kicker, SimpleRequest, SimpleResponse} from '@github/remote-form'\nimport {afterRemote, beforeRemote, remoteForm} from '@github/remote-form'\nimport {findPersistedSubmitButtonValue, persistSubmitButtonValue} from '../remote-submit'\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport verifySso from '../sso'\n\nfunction submitWithLegacyEvents(form: HTMLFormElement, send: Kicker, req: SimpleRequest) {\n  const dataType = form.getAttribute('data-type')\n  if (dataType === 'json') {\n    req.headers.set('Accept', 'application/json')\n  }\n\n  fire(form, 'deprecatedAjaxSend', {request: req})\n\n  send\n    .text()\n    /* eslint-disable-next-line github/no-then */\n    .catch(err => {\n      if (err.response) {\n        return err.response\n      } else {\n        throw err\n      }\n    })\n    /* eslint-disable-next-line github/no-then */\n    .then(\n      (response: SimpleResponse) => {\n        if (response.status < 300) {\n          fire(form, 'deprecatedAjaxSuccess')\n        } else {\n          fire(form, 'deprecatedAjaxError', {error: response.statusText, status: response.status, text: response.text})\n        }\n      },\n      err => {\n        fire(form, 'deprecatedAjaxError', {error: err.message, status: 0, text: null})\n      }\n    )\n    /* eslint-disable-next-line github/no-then */\n    .then(() => {\n      fire(form, 'deprecatedAjaxComplete')\n    })\n}\n\n// Persist submit button value for ALL forms, regardless of whether they are\n// ajax-enabled or not. The submit value is reset after either `deprecatedAjaxComplete`\n// has fired or `remoteForm` has finished processing.\non(\n  'click',\n  ['form button:not([type])', 'form button[type=submit]', 'form input[type=submit]'].join(', '),\n  function (event) {\n    const button = event.currentTarget as HTMLButtonElement | HTMLInputElement\n    const form = button.form\n    if (form && !event.defaultPrevented) {\n      persistSubmitButtonValue(button)\n    }\n  }\n)\n\nremoteForm('form[data-remote]', submitWithLegacyEvents)\n\n// Restore forms after AJAX submissions\non('deprecatedAjaxComplete', 'form', function ({currentTarget}) {\n  const el = findPersistedSubmitButtonValue(currentTarget as HTMLFormElement)\n  if (el) el.remove()\n})\n\nafterRemote(form => {\n  const button = findPersistedSubmitButtonValue(form)\n  if (button) button.remove()\n})\n\nbeforeRemote(verifySso)\n","import {controller, target, targets} from '@github/catalyst'\nimport {parseHTML} from '../parse-html'\nimport {requestSubmit} from '../form'\n\n@controller\nexport default class RemotePaginationElement extends HTMLElement {\n  @target form: HTMLFormElement\n  @target list: HTMLElement\n  @targets focusMarkers: HTMLElement[]\n  @target submitButton: HTMLButtonElement\n  loaderWasFocused = false\n\n  connectedCallback() {\n    this.setPaginationUrl(this.list)\n  }\n\n  get hasNextPage(): boolean {\n    return !this.form.hidden\n  }\n\n  loadNextPage() {\n    if (!this.hasNextPage) return\n    requestSubmit(this.form)\n  }\n\n  get disabled(): boolean {\n    return this.submitButton.hasAttribute('aria-disabled')\n  }\n\n  set disabled(value: boolean) {\n    if (value) {\n      this.submitButton.setAttribute('aria-disabled', 'true')\n    } else {\n      this.submitButton.removeAttribute('aria-disabled')\n    }\n    this.submitButton.classList.toggle('disabled', value)\n  }\n\n  private loadstart(event: Event) {\n    ;(event.target as HTMLElement).addEventListener(\n      'focus',\n      () => {\n        this.loaderWasFocused = true\n      },\n      {once: true}\n    )\n    ;(event.target as HTMLElement).addEventListener(\n      'include-fragment-replaced',\n      () => {\n        this.setPaginationUrl(this.list)\n        if (this.loaderWasFocused) {\n          this.focusMarkers.pop()?.focus()\n        }\n        this.loaderWasFocused = false\n      },\n      {once: true}\n    )\n  }\n\n  private async submit(event: Event) {\n    event.preventDefault()\n    if (this.disabled) return\n    this.disabled = true\n    let html\n    try {\n      const response = await fetch(this.form.action)\n      if (!response.ok) return\n      html = await response.text()\n    } catch {\n      return\n    }\n    const fragment = parseHTML(document, html)\n    this.setPaginationUrl(fragment)\n    this.list.append(fragment)\n    this.focusMarkers.pop()?.focus()\n    this.disabled = false\n    this.dispatchEvent(new CustomEvent('remote-pagination-load'))\n  }\n\n  private setPaginationUrl(container: HTMLElement | DocumentFragment) {\n    const destinationEl = container.querySelector('[data-pagination-src]')\n    if (!destinationEl) return\n    const url = destinationEl.getAttribute('data-pagination-src')\n    if (url) {\n      this.form.action = url\n      this.form.hidden = false\n    } else {\n      this.form.hidden = true\n    }\n  }\n}\n","// Removed Contents behavior\n//\n// When \"has-removed-contents\" is added to an Element, its contents are\n// detached from the document and stored in memory. Once the class is removed,\n// the original contents are automatically reinserted into the document.\n//\n// WARNING: Adding new content to an Element while it has its contents detatch\n// has undefined behavior.\n//\n// This behavior is useful when working with form with multiple states. Using\n// d-none is only presentational and doesn't exclude the form fields from\n// being submitted or participating in validation requirements.\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('.has-removed-contents', function () {\n  let contents: ChildNode[]\n  return {\n    add(parent) {\n      contents = Array.from(parent.childNodes)\n      for (const el of contents) {\n        parent.removeChild(el)\n      }\n      const form = parent.closest('form')\n      if (form) fire(form, 'change')\n    },\n    remove(parent) {\n      for (const el of contents) {\n        parent.appendChild(el)\n      }\n      const form = parent.closest('form')\n      if (form) fire(form, 'change')\n    }\n  }\n})\n","import {TemplateResult, html, render} from 'lit-html'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\ninterface ColorModeParam {\n  color_mode: Omit<ColorModes, 'auto'>\n}\n\nenum ColorModes {\n  Auto = 'auto',\n  Light = 'light',\n  Dark = 'dark'\n}\n\n/**\n * getUserSystemColorMode Attempts to detect the color mode the user has specified\n * in their operating system's preferences.\n * Defaults to 'light'\n * @returns One of 'light' or 'dark' color modes.\n */\nfunction getUserSystemColorMode() {\n  if (window.matchMedia(`(prefers-color-scheme: ${ColorModes.Dark})`).matches) {\n    return ColorModes.Dark\n  }\n\n  return ColorModes.Light\n}\n\n// Enrichable Markdown Rendering:\n//\n// We use the `markdown-enrichment` to render code blocks in markdown.\n// The CodeRenderService is responsible for rendering the code blocks to html and\n// this code will find those blocks and enrich them with the code rendering service appropriate\n// for the language.\n// If we're enriching a raw code block, we need to hide the original\n// code block once the iframe has rendered successfully\n\nconst RENDER_PLAINTEXT_SELECTOR = '.js-render-plaintext'\nexport function markdownEnrichmentSuccess(where: Element) {\n  const parent = where.closest('.js-render-needs-enrichment')\n  if (!parent) {\n    return\n  }\n\n  const rawCodeBlock = parent.querySelector(RENDER_PLAINTEXT_SELECTOR)\n\n  if (rawCodeBlock) {\n    setCodeBlockLoaderVisibility(parent as HTMLElement, false)\n  }\n}\n\nexport function showMarkdownRenderError(parent: HTMLElement, template: TemplateResult) {\n  setCodeBlockLoaderVisibility(parent, false)\n  setRawCodeBlockVisibility(parent, true)\n  parent.classList.add('render-error')\n\n  const plaintextTarget = parent.querySelector(RENDER_PLAINTEXT_SELECTOR)\n  if (!plaintextTarget) {\n    return\n  }\n  plaintextTarget.classList.remove('render-plaintext-hidden')\n  const plaintextEl = plaintextTarget.querySelector('pre') as HTMLElement\n\n  render(html`${template} ${plaintextEl}`, plaintextTarget)\n}\n\n// Show the spinner or not when enriching a code block.\nfunction setCodeBlockLoaderVisibility(where: HTMLElement, loaderVisible: boolean) {\n  const loader = where.getElementsByClassName('js-render-enrichment-loader')[0] as HTMLElement\n  const expander = where.getElementsByClassName('render-expand')[0] as HTMLElement\n  if (loader) {\n    loader.hidden = !loaderVisible\n  }\n  if (expander) {\n    expander.hidden = loaderVisible\n  }\n}\n\nfunction setRawCodeBlockVisibility(where: HTMLElement, codeVisible: boolean) {\n  const rawCodeBlock = where.querySelector(RENDER_PLAINTEXT_SELECTOR) as HTMLElement\n\n  if (codeVisible) {\n    rawCodeBlock.classList.remove('render-plaintext-hidden')\n  } else {\n    rawCodeBlock.classList.add('render-plaintext-hidden')\n  }\n}\n\nclass EnrichableMarkdownRenderer {\n  enrichmentTarget: HTMLElement\n  el: HTMLElement\n  iframeUrl: string\n  identifier: string\n  iframeContentType: string\n  iframeOrigin: string\n  iframeContent: string\n\n  constructor(el: HTMLElement) {\n    this.el = el\n    this.enrichmentTarget = el.getElementsByClassName('js-render-enrichment-target')[0] as HTMLElement\n    this.iframeUrl = this.getIframeUrl()\n    this.identifier = this.el.getAttribute('data-identity')!\n    this.iframeContentType = this.el.getAttribute('data-type')!\n    this.iframeOrigin = new URL(this.iframeUrl, window.location.origin).origin\n    this.iframeContent = this.el.getAttribute('data-content')!\n    // Setup the loading state for this code block to show the spinner\n    setCodeBlockLoaderVisibility(this.el, true)\n  }\n\n  enrich() {\n    const enriched = this.createDialog()\n    render(enriched, this.enrichmentTarget)\n    this.setupModal()\n  }\n\n  private getIframeUrl() {\n    const baseUrl = this.el.getAttribute('data-src')!\n    const params = {\n      ...this.colorMode()\n    }\n    const queryParams = Object.entries(params)\n      .map(([key, val]) => `${key}=${val}`)\n      .join('&')\n\n    return `${baseUrl}?${queryParams}`\n  }\n\n  /**\n   * colorMode queries the DOM for the user's preferred\n   * color mode setting  either `dark`, `light`, or `auto`. A value of\n   * `auto` indicates that the color mode is derived from the user's\n   * system preferences, which triggers a further check.\n   *\n   * @returns ColorModeParam\n   */\n  private colorMode(): ColorModeParam {\n    let colorMode = document.querySelector('html')?.getAttribute('data-color-mode')\n\n    if (colorMode === ColorModes.Auto || !colorMode) {\n      colorMode = getUserSystemColorMode()\n    }\n\n    return {color_mode: colorMode}\n  }\n  // We need some interactions in the modal to add the\n  // iframe to the dialog when it is opened. We tag the iframe\n  // with a full screen identifier so the rendering service has a\n  // unique identifier for the iframe.\n  private setupModal() {\n    const iframe = this.generateIframeCode('-fullscreen')\n    const dialogEl = this.el.querySelector('.Box-body') as HTMLElement\n    const dialogButton = this.el.querySelector('.js-full-screen-render') as HTMLButtonElement\n    dialogButton.addEventListener('click', () => {\n      render(iframe, dialogEl)\n    })\n  }\n\n  // This is a dialog element to allow the user to see the full screen rendering\n  // it calls out the iframe code to be rendered in the normal view\n  private createDialog() {\n    const iframeDom = this.generateIframeCode()\n    return html` <div class=\"d-flex flex-column flex-auto js-render-box\">\n      <details class=\"details-reset details-overlay details-overlay-dark\">\n        <summary class=\"btn-sm btn position-absolute js-full-screen-render render-expand\" aria-haspopup=\"dialog\" hidden>\n          <svg\n            width=\"16\"\n            height=\"16\"\n            viewBox=\"0 0 16 16\"\n            fill=\"currentColor\"\n            class=\"octicon\"\n            style=\"display:inline-block;vertical-align:text-bottom\"\n          >\n            <path\n              fill-rule=\"evenodd\"\n              d=\"M3.72 3.72a.75.75 0 011.06 1.06L2.56 7h10.88l-2.22-2.22a.75.75 0 011.06-1.06l3.5 3.5a.75.75 0 010 1.06l-3.5 3.5a.75.75 0 11-1.06-1.06l2.22-2.22H2.56l2.22 2.22a.75.75 0 11-1.06 1.06l-3.5-3.5a.75.75 0 010-1.06l3.5-3.5z\"\n            ></path>\n          </svg>\n        </summary>\n        <details-dialog class=\"Box Box--overlay render-full-screen d-flex flex-column anim-fade-in fast\">\n          <div>\n            <button\n              aria-label=\"Close dialog\"\n              data-close-dialog=\"\"\n              type=\"button\"\n              data-view-component=\"true\"\n              class=\"Link--muted btn-link position-absolute render-full-screen-close\"\n            >\n              <svg\n                width=\"24\"\n                height=\"24\"\n                viewBox=\"0 0 24 24\"\n                fill=\"currentColor\"\n                style=\"display:inline-block;vertical-align:text-bottom\"\n                class=\"octicon octicon-x\"\n              >\n                <path\n                  fill-rule=\"evenodd\"\n                  d=\"M5.72 5.72a.75.75 0 011.06 0L12 10.94l5.22-5.22a.75.75 0 111.06 1.06L13.06 12l5.22 5.22a.75.75 0 11-1.06 1.06L12 13.06l-5.22 5.22a.75.75 0 01-1.06-1.06L10.94 12 5.72 6.78a.75.75 0 010-1.06z\"\n                ></path>\n              </svg>\n            </button>\n            <div class=\"Box-body\"></div>\n          </div>\n        </details-dialog>\n      </details>\n      ${iframeDom}\n    </div>`\n  }\n\n  // Generate the iframe code to be rendered\n  private generateIframeCode(identityPrefix = '') {\n    const iframeIdentity = this.identifier + identityPrefix\n    const iframeUrl = `${this.iframeUrl}#${iframeIdentity}`\n\n    return html`\n      <div\n        class=\"render-container js-render-target p-0\"\n        data-identity=\"${iframeIdentity}\"\n        data-host=\"${this.iframeOrigin}\"\n        data-type=\"${this.iframeContentType}\"\n      >\n        <iframe\n          class=\"render-viewer\"\n          src=\"${iframeUrl}\"\n          name=\"${iframeIdentity}\"\n          data-content=\"${this.iframeContent}\"\n          sandbox=\"allow-scripts allow-same-origin allow-top-navigation\"\n        >\n        </iframe>\n      </div>\n    `\n  }\n}\n\nobserve('.js-render-needs-enrichment', function (el) {\n  const htmlEl = el as HTMLElement\n  const enricher = new EnrichableMarkdownRenderer(htmlEl)\n  enricher.enrich()\n})\n\n/**\n * Toggling back and forth between the `preview` and `write` tabs produces jank in\n * the form of an occasionally visible fully rendered chart. This is because we leave the\n * chart on the page until a request to regenerate the chart can be made.\n *\n * So, we add an event in `preview.ts` we can hook into,\n * and clear out the previously rendered chart before requesting a new one from viewscreen\n */\non('preview:toggle:off', '.js-previewable-comment-form', function (event) {\n  const target = event.currentTarget\n  const htmlEl = target.querySelector<HTMLElement>('.js-render-needs-enrichment')\n  const enrichTarget = htmlEl?.querySelector('.js-render-enrichment-target')\n\n  if (!enrichTarget) {\n    return\n  }\n\n  enrichTarget.innerHTML = ''\n})\n\non('preview:rendered', '.js-previewable-comment-form', function (event) {\n  const target = event.currentTarget\n  const htmlEl = target.querySelector<HTMLElement>('.js-render-needs-enrichment')\n  if (htmlEl) {\n    setRawCodeBlockVisibility(htmlEl, false)\n  }\n})\n\nexport default EnrichableMarkdownRenderer\n","import {TemplateResult, html, render} from 'lit-html'\nimport {markdownEnrichmentSuccess, showMarkdownRenderError} from './enrichable-markdown-render'\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport visible from '../visible'\ninterface RenderTiming {\n  load?: number | null\n  helloTimer?: number | null\n  hello?: number | null\n  loadTimer?: number | null\n  untimed?: boolean\n}\n\n// These are the mutable state classes. They are to be wiped between transitions.\nconst stateClasses = ['is-render-pending', 'is-render-ready', 'is-render-loading', 'is-render-loaded']\n// During a pjax navigation, we need to clear most of the mutable state classes, but preserve `is-render-pending`.\n// We also want to clear out any of the failed state classes, since they prevent the user from viewing content\n// which has otherwise rendered correctly\nconst pjaxStateClasses = [\n  'is-render-ready',\n  'is-render-loading',\n  'is-render-loaded',\n  'is-render-failed',\n  'is-render-failed-fatally'\n]\nconst timingData: WeakMap<Element, RenderTiming> = new WeakMap()\nfunction resetTiming(where: Element) {\n  const renderTiming = timingData.get(where)\n  if (renderTiming == null) {\n    return\n  }\n  renderTiming.load = renderTiming.hello = null\n  if (renderTiming.helloTimer) {\n    clearTimeout(renderTiming.helloTimer)\n    renderTiming.helloTimer = null\n  }\n  if (renderTiming.loadTimer) {\n    clearTimeout(renderTiming.loadTimer)\n    renderTiming.loadTimer = null\n  }\n}\n\n// Everything is broken, sink with the ship\nfunction renderFailed(where: Element, msg = '') {\n  where.classList.remove(...stateClasses)\n  where.classList.add('is-render-failed')\n\n  const errElement = renderError(msg)\n\n  // determine if we're rendering a file or a code block\n  const markdownRender = where.parentElement?.closest('.js-render-needs-enrichment') as HTMLElement\n  if (markdownRender) {\n    showMarkdownRenderError(markdownRender, errElement)\n  } else {\n    fileRenderError(where as HTMLElement, errElement)\n  }\n  resetTiming(where)\n}\n\nfunction fileRenderError(parent: HTMLElement, template: TemplateResult) {\n  const child = parent.querySelector('.render-viewer-error')\n  if (child) {\n    child.remove()\n    parent.classList.remove('render-container')\n    render(template, parent)\n  }\n}\n\nfunction renderError(msg: string) {\n  let errMsg = html`<p>Unable to render code block</p>`\n  if (msg !== '') {\n    const msgLines = msg.split('\\n')\n    errMsg = html`<p><b>Error rendering embedded code</b></p>\n      <p>${msgLines.map(line => html`${line}<br />`)}</p>`\n  }\n  return html`<div class=\"flash flash-error\">${errMsg}</div>`\n}\n\nfunction timeoutWatchdog(where: Element, checkHello = false) {\n  if (\n    !visible(where as HTMLElement) ||\n    where.classList.contains('is-render-ready') ||\n    where.classList.contains('is-render-failed') ||\n    where.classList.contains('is-render-failed-fatally') ||\n    (checkHello && !timingData.get(where)?.hello)\n  ) {\n    return\n  }\n\n  renderFailed(where)\n}\n\n// Update each container with a potentially\n// changed element every time a refresh or pjax\n// triggers.\nobserve('.js-render-target', function (el) {\n  const htmlEl = el as HTMLElement\n  htmlEl.classList.remove(...pjaxStateClasses)\n  htmlEl.style.height = 'auto'\n\n  if (timingData.get(el)?.load) {\n    return\n  }\n\n  resetTiming(el)\n\n  if (timingData.get(el)) {\n    return\n  }\n\n  timingData.set(el, {\n    load: Date.now(),\n    hello: null,\n    helloTimer: window.setTimeout(timeoutWatchdog, 10_000, el, true),\n    loadTimer: window.setTimeout(timeoutWatchdog, 45_000, el)\n  })\n\n  el.classList.add('is-render-automatic', 'is-render-requested')\n})\n\ninterface RenderMessage {\n  type: string\n  body?: unknown\n}\n\nfunction postAsJson(renderWindow: Window | null | undefined, message: RenderMessage) {\n  if (renderWindow && renderWindow.postMessage) {\n    renderWindow.postMessage(JSON.stringify(message), '*')\n  }\n}\n\nexport function handleMessage(event: MessageEvent) {\n  let result = event.data\n  if (!result) return\n\n  if (typeof result === 'string') {\n    try {\n      result = JSON.parse(result) as unknown\n    } catch {\n      // Ignore parse errors\n      return\n    }\n  }\n\n  if (result.type !== 'render') return\n\n  if (typeof result.identity !== 'string') return\n  const identity = result.identity\n\n  if (typeof result.body !== 'string') return\n  const body = result.body\n\n  let container: HTMLElement | null = null\n  for (const target of document.querySelectorAll<HTMLElement>('.js-render-target')) {\n    if (target.getAttribute('data-identity') === identity) {\n      container = target\n      break\n    }\n  }\n\n  if (!container) return\n\n  if (event.origin !== container.getAttribute('data-host')) {\n    return\n  }\n\n  const payload = result.payload != null ? result.payload : undefined\n  const iframe = container.querySelector('iframe')\n  const renderWindow = iframe?.contentWindow\n\n  function postData() {\n    const data = iframe?.getAttribute('data-content')\n    if (!data) {\n      return\n    }\n    const msg = {\n      type: 'render:cmd',\n      body: {\n        cmd: 'code_rendering_service:data:ready',\n        'code_rendering_service:data:ready': {\n          data: JSON.parse(data).data,\n          width: container?.getBoundingClientRect().width\n        }\n      }\n    }\n    postAsJson(renderWindow, msg)\n  }\n\n  switch (body) {\n    case 'hello':\n      {\n        const renderTiming = timingData.get(container) || {\n          untimed: true\n        }\n\n        renderTiming.hello = Date.now()\n\n        const ackmsg = {\n          type: 'render:cmd',\n          body: {\n            cmd: 'ack',\n            ack: true\n          }\n        }\n\n        const msg = {\n          type: 'render:cmd',\n          body: {\n            cmd: 'branding',\n            branding: false\n          }\n        }\n\n        if (!renderWindow) return\n        postAsJson(renderWindow, ackmsg)\n        postAsJson(renderWindow, msg)\n      }\n      break\n    case 'error':\n      if (payload) {\n        renderFailed(container, payload.error)\n      } else {\n        renderFailed(container)\n      }\n      break\n    case 'error:fatal': {\n      renderFailed(container)\n      container.classList.add('is-render-failed-fatal')\n      break\n    }\n    case 'error:invalid':\n      renderFailed(container)\n      container.classList.add('is-render-failed-invalid')\n      break\n    case 'loading':\n      container.classList.remove(...stateClasses)\n      container.classList.add('is-render-loading')\n      break\n    case 'loaded':\n      container.classList.remove(...stateClasses)\n      container.classList.add('is-render-loaded')\n      break\n    case 'ready':\n      markdownEnrichmentSuccess(container)\n      container.classList.remove(...stateClasses)\n      container.classList.add('is-render-ready')\n\n      if (payload && typeof payload.height === 'number') {\n        container.style.height = `${payload.height}px`\n      }\n\n      break\n    case 'resize':\n      if (payload && typeof payload.height === 'number') {\n        container.style.height = `${payload.height}px`\n      }\n\n      break\n    case 'code_rendering_service:container:get_size':\n      postAsJson(renderWindow, {\n        type: 'render:cmd',\n        body: {\n          cmd: 'code_rendering_service:container:size',\n          'code_rendering_service:container:size': {\n            width: container?.getBoundingClientRect().width\n          }\n        }\n      })\n      break\n    case 'code_rendering_service:markdown:get_data':\n      if (!renderWindow) return\n      postData()\n      break\n    default:\n      break\n  }\n}\n\n// Handle messages coming from the viewer iframe using `postMessage`.\n// We throw away any message that doesn't look like it's coming from the render\n// client.\nwindow.addEventListener('message', handleMessage)\n","import {remoteForm} from '@github/remote-form'\n\nremoteForm('form[data-replace-remote-form]', async function (form, wants) {\n  form.classList.remove('is-error')\n  form.classList.add('is-loading')\n  try {\n    let target: Element = form\n\n    const response = await wants.html()\n    const container = form.closest('[data-replace-remote-form-target]')\n    if (container) {\n      const id = container.getAttribute('data-replace-remote-form-target')\n      target = id ? document.getElementById(id)! : container\n    }\n    target.replaceWith(response.html)\n  } catch (e) {\n    form.classList.remove('is-loading')\n    form.classList.add('is-error')\n  }\n})\n","import {sendStats} from '../stats'\n\nif (PerformanceObserver && (PerformanceObserver.supportedEntryTypes || []).includes('longtask')) {\n  const observer = new PerformanceObserver(function (list) {\n    const longTasks = list.getEntries().map(({name, duration}) => ({name, duration, url: window.location.href}))\n    sendStats({longTasks})\n  })\n  observer.observe({entryTypes: ['longtask']})\n}\n","import MarkdownToolbarElement from '@github/markdown-toolbar-element'\nimport {dialog} from '../details-dialog'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nconst selectionEnds = new WeakMap()\n\nfunction getTextarea(el: HTMLElement): HTMLTextAreaElement {\n  return el.closest<MarkdownToolbarElement>('markdown-toolbar')!.field!\n}\n\non('click', '.js-markdown-link-button', async function ({currentTarget}) {\n  const template = document.querySelector<HTMLTemplateElement>('.js-markdown-link-dialog')!\n  const content = template.content.cloneNode(true)\n  if (!(content instanceof DocumentFragment)) return\n\n  const dialogEl = await dialog({\n    content,\n    labelledBy: 'box-title'\n  })\n  if (!(currentTarget instanceof HTMLElement)) return\n  selectionEnds.set(dialogEl, getTextarea(currentTarget).selectionEnd)\n})\n\non('click', '.js-markdown-link-insert', ({currentTarget}) => {\n  const container = currentTarget.closest<HTMLElement>('details-dialog')!\n  const textarea = document.querySelector<HTMLTextAreaElement>(`#${currentTarget.getAttribute('data-for-textarea')!}`)!\n  const selectionEnd = selectionEnds.get(container) || 0\n\n  const href = container.querySelector<HTMLInputElement>('#js-dialog-link-href')!.value\n  const text = container.querySelector<HTMLInputElement>('#js-dialog-link-text')!.value\n  const link = `[${text}](${href}) `\n  const before = textarea.value.slice(0, selectionEnd)\n  const after = textarea.value.slice(selectionEnd)\n  textarea.value = before + link + after\n  textarea.focus()\n  textarea.selectionStart = textarea.selectionEnd = selectionEnd + link.length\n})\n","import {eventToHotkeyString} from '@github/hotkey'\nimport {insertText} from '../text'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {onKey} from '../onfocus'\n\non(\n  'details-menu-select',\n  '.js-saved-reply-menu',\n  function (event) {\n    if (!(event.target instanceof Element)) return\n\n    const body = event.detail.relatedTarget.querySelector('.js-saved-reply-body')\n\n    // Since this details-menu-select can hold options which arent saved\n    // replies, we guard to ensure that only saved replies are handled here.\n    if (!body) return\n\n    const text = (body.textContent || '').trim()\n    const container = event.target.closest<HTMLElement>('.js-previewable-comment-form')!\n\n    const comment = container.querySelector<HTMLTextAreaElement>('textarea.js-comment-field')!\n    insertText(comment, text)\n    setTimeout(() => comment.focus(), 0)\n  },\n  {capture: true}\n)\n\nonKey('keydown', '.js-saved-reply-shortcut-comment-field', function (event) {\n  if (eventToHotkeyString(event) === 'Control+.') {\n    const container = (event.target as Element).closest<HTMLElement>('.js-previewable-comment-form')!\n    const menu = container.querySelector<HTMLElement>('.js-saved-reply-container')!\n    menu.setAttribute('open', '')\n    event.preventDefault()\n  }\n})\n\nonKey('keydown', '.js-saved-reply-filter-input', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (/^Control\\+[1-9]$/.test(eventToHotkeyString(event))) {\n    const container = (event.target as Element).closest<HTMLElement>('.js-saved-reply-container')!\n    const replies = container.querySelectorAll('[role=\"menuitem\"]')\n    const savedReplyNumber = Number(event.key)\n    const reply = replies[savedReplyNumber - 1]\n    if (reply instanceof HTMLElement) {\n      reply.click()\n      event.preventDefault()\n    }\n  } else if (event.key === 'Enter') {\n    const container = (event.target as Element).closest<HTMLElement>('.js-saved-reply-container')!\n    const replies = container.querySelectorAll('[role=\"menuitem\"]')\n\n    if (replies.length > 0 && replies[0] instanceof HTMLButtonElement) {\n      replies[0].click()\n    }\n\n    event.preventDefault()\n  }\n  /* eslint-enable no-restricted-syntax */\n})\n","import type {BlobRange} from '../blob-anchor'\nimport {DOMRangeFromBlob} from '../blob-anchor'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {surroundContents} from '../range'\n\nfunction queryLineElement(snippet: Element, line: number) {\n  return snippet.querySelector(`#LC${line}`)\n}\n\nfunction highlightColumns(blobRange: BlobRange, snippet: Element) {\n  const range = DOMRangeFromBlob(blobRange, line => queryLineElement(snippet, line))\n\n  if (range) {\n    const span = document.createElement('span')\n    const highlightClasses = ['text-bold', 'hx_keyword-hl', 'rounded-2', 'd-inline-block']\n\n    span.classList.add(...highlightClasses)\n    surroundContents(range, span)\n  }\n}\n\nfunction parseColumnHighlightRange(snippet: Element): BlobRange | null {\n  const startLine = parseInt(snippet.getAttribute('data-start-line')!)\n  const endLine = parseInt(snippet.getAttribute('data-end-line')!)\n  const startColumn = parseInt(snippet.getAttribute('data-start-column')!)\n  // The end column is a special case, as 0 acts as a special value\n  const dataEndColumn = parseInt(snippet.getAttribute('data-end-column')!)\n\n  // TODO: handle multi-line highlight regions\n  if (startLine !== endLine) return null\n\n  // Nothing to highlight if start and end lines and start and end cols are the\n  // same, as column ranges are half-open\n  if (startLine === endLine && startColumn === dataEndColumn) return null\n\n  // 0 here indicates that no end column was provided, so the highlight should\n  // continue to the end of the line.\n  // DOMRangeFromBlob will interpret null in a similar way to this.\n  const endColumn = dataEndColumn !== 0 ? dataEndColumn : null\n\n  return {\n    start: {line: startLine, column: startColumn},\n    end: {line: endLine, column: endColumn}\n  }\n}\n\nobserve('.js-highlight-code-snippet-columns', function (snippet: Element) {\n  const blobRange = parseColumnHighlightRange(snippet)\n  if (blobRange !== null) {\n    highlightColumns(blobRange, snippet)\n  }\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('click', '.js-segmented-nav-button', function (event) {\n  event.preventDefault()\n  const target = event.currentTarget\n\n  const selectedTabSelector = target.getAttribute('data-selected-tab')!\n  const navigationContainer = target.closest<HTMLElement>('.js-segmented-nav')!\n  const container = navigationContainer.parentElement!\n\n  for (const button of navigationContainer.querySelectorAll('.js-segmented-nav-button')) {\n    button.classList.remove('selected')\n  }\n\n  target.classList.add('selected')\n\n  for (const tab of container.querySelectorAll('.js-selected-nav-tab')) {\n    if (tab.parentElement === container) {\n      tab.classList.remove('active')\n    }\n  }\n\n  document.querySelector<HTMLElement>(`.${selectedTabSelector}`)!.classList.add('active')\n})\n","// Gets the current page's id for persisting fields.\n//\n// The value can be overridden by providing a normalized value in a meta tag.\n//\n//   <meta name=\"session-resume-id\" content=\"/github/github/issues/123\">.\n//\n// Defaults to the current url path.\nexport function getPageID(url?: URL): string {\n  const location = url || window.location\n\n  const metaTag = document.head && document.head.querySelector('meta[name=session-resume-id]')\n  const id = metaTag instanceof HTMLMetaElement && metaTag.content\n\n  return id || location.pathname\n}\n","import {persistResumableFields, restoreResumableFields, setForm} from '@github/session-resume'\nimport {debounce} from '@github/mini-throttle'\nimport {getPageID} from '../session-resume-helpers'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nconst debouncedRestoreResumableFields = debounce(function () {\n  restoreResumableFields(getPageID())\n}, 50)\n\n/**\n * Returns true while turbo is showing a \"preview\" of the route from cache: in other words between\n * the time a route is visited and the time it is loaded\n * @returns boolean\n */\nfunction isTurboRenderingCachePreview(): boolean {\n  return document.querySelector('html')?.hasAttribute('data-turbo-preview') ?? false\n}\n\n// Session Resume.\n//\n// Annotate fields to be persisted on navigation away from the current page.\n// Fields be automatically restored when the user revists the page again in\n// their current browser session (excludes seperate tabs).\n//\n// Not design for persisted crash recovery.\n\n// Listen for all form submit events and to see if their default submission\n// behavior is invoked.\nwindow.addEventListener('submit', setForm, {capture: true})\n\n// Resume field content on regular page loads.\nwindow.addEventListener('pageshow', function () {\n  restoreResumableFields(getPageID())\n})\n\n// Resume field content on pjax page loads.\nwindow.addEventListener('pjax:end', function () {\n  restoreResumableFields(getPageID())\n})\n\n// Resume field content on elements that are added later\n// We use a debounced version to avoid repeatedly calling it if multiple\n// fields are added\nobserve('.js-session-resumable', function () {\n  // we don't want to restore fields on turbo-cache previews as that empties the cache\n  // causing the fields to be lost when turbo re-renders with the fetched page\n  if (!isTurboRenderingCachePreview()) {\n    debouncedRestoreResumableFields()\n  }\n})\n\n// Persist resumable fields when page is unloaded\nwindow.addEventListener('pagehide', function () {\n  persistResumableFields(getPageID(), {selector: '.js-session-resumable'})\n})\n\n// Persist resumable fields before pjax swaps them out\nwindow.addEventListener('pjax:beforeReplace', function (event) {\n  const state = event.detail.previousState\n  const url = state ? state.url : null\n\n  if (url) {\n    persistResumableFields(getPageID(new URL(url, window.location.origin)), {selector: '.js-session-resumable'})\n  } else {\n    const error = new Error('pjax:beforeReplace event.detail.previousState.url is undefined')\n    setTimeout(function () {\n      throw error\n    })\n  }\n})\n\n// preserve fields before navigating away\nwindow.addEventListener('turbo:before-visit', function () {\n  persistResumableFields(getPageID(), {selector: '.js-session-resumable'})\n})\n\n// restore fields once turbo navigation has finished\nwindow.addEventListener('turbo:load', function () {\n  restoreResumableFields(getPageID())\n})\n","import {getItem, removeItem, setItem} from '../../session-storage'\n\ntype ShelfReferrerParams = {\n  notification_referrer_id?: string\n  notifications_before?: string\n  notifications_after?: string\n  notifications_query?: string\n}\n\nconst shelfParams: Array<keyof ShelfReferrerParams> = [\n  'notification_referrer_id',\n  'notifications_before',\n  'notifications_after',\n  'notifications_query'\n]\n\nconst sessionStorageKey = 'notification_shelf'\n\n/*\n * Stores url params for the shelf in session storage if present, and returns\n * search params without any shelf params.\n */\nexport function storeAndStripShelfParams(\n  searchParams: URLSearchParams,\n  pathname: string | null = null\n): URLSearchParams | null {\n  if (searchParams.has('notification_referrer_id')) {\n    storeShelfParams(searchParams, pathname)\n    return deleteShelfParams(searchParams)\n  }\n  return null\n}\n\n/*\n * Loads the shelf params from sessionStorage if they are there and they match\n * the current pull request page, clear them otherwise.\n */\nexport function getStoredShelfParamsForCurrentPage(pathname: string | null = null): ShelfReferrerParams | null {\n  // If the current page is not a pull request, then the stored data will\n  // not match, so clear it and move on.\n  const currentPullRequestPathname = getCurrentPullRequestPathname(pathname)\n  if (!currentPullRequestPathname) {\n    removeItem(sessionStorageKey)\n    return null\n  }\n\n  try {\n    const str = getItem(sessionStorageKey)\n    if (!str) return null\n\n    const stored = JSON.parse(str)\n    if (!stored || !stored.pathname) throw new Error('Must have a pathname')\n\n    if (stored.pathname !== currentPullRequestPathname) {\n      throw new Error('Stored pathname does not match current pathname.')\n    }\n\n    const result: ShelfReferrerParams = {}\n\n    for (const key of shelfParams) {\n      result[key] = stored[key]\n    }\n\n    return result\n  } catch (e) {\n    removeItem(sessionStorageKey)\n    return null\n  }\n}\n\nfunction storeShelfParams(searchParams: URLSearchParams, pathname: string | null) {\n  const pullRequestPathname = getCurrentPullRequestPathname(pathname)\n  if (!pullRequestPathname) return\n\n  const params: {[key: string]: string} = {\n    pathname: pullRequestPathname\n  }\n\n  for (const key of shelfParams) {\n    const value = searchParams.get(key)\n    if (value) params[key] = value\n  }\n\n  setItem(sessionStorageKey, JSON.stringify(params))\n}\n\nfunction deleteShelfParams(searchParams: URLSearchParams): URLSearchParams {\n  for (const key of shelfParams) {\n    searchParams.delete(key)\n  }\n  return searchParams\n}\n\n/*\n * Returns the base pathname of the current page if it's a pull request.\n *\n * `/github/github/pull/123/files` -> `/github/github/pull/123`\n */\nfunction getCurrentPullRequestPathname(pathname: string | null): string | null {\n  pathname = pathname || window.location.pathname\n  const pullRequestPathnameRegex = /^(\\/[^/]+\\/[^/]+\\/pull\\/[^/]+)/\n  const match = pathname.match(pullRequestPathnameRegex)\n  if (!match) return null\n\n  return match[0]\n}\n","import {getStoredShelfParamsForCurrentPage, storeAndStripShelfParams} from './notification-shelf-referrer-params'\nimport IncludeFragmentElement from '@github/include-fragment-element'\nimport type {Kicker} from '@github/remote-form'\nimport {remoteForm} from '@github/remote-form'\nimport {updateNotificationStates} from './update-notification-states'\n\n// Perform an action and change the status of the notification shelf.\nexport async function remoteShelfActionForm() {\n  return remoteForm('.js-notification-shelf .js-notification-action form', async function (form, wants) {\n    const shouldRedirect = form.hasAttribute('data-redirect-to-inbox-on-submit')\n\n    if (shouldRedirect) {\n      await performRequest(wants)\n      const inboxButton = document.querySelector<HTMLAnchorElement>('.js-notifications-back-to-inbox')!\n\n      if (inboxButton) {\n        inboxButton.click()\n      }\n\n      return\n    }\n\n    updateNotificationStates(form, form)\n    await performRequest(wants)\n  })\n}\n\nexport function urlWithoutNotificationParameters() {\n  const searchParams = new URLSearchParams(window.location.search)\n  const cleanSearchParams = storeAndStripShelfParams(searchParams)\n\n  if (cleanSearchParams) {\n    const newUrl = new URL(window.location.href, window.location.origin)\n    newUrl.search = cleanSearchParams.toString()\n    return newUrl.toString()\n  }\n}\n\nexport function loadShelfFromStoredParams(includeFragmentEl: Element) {\n  if (!(includeFragmentEl instanceof IncludeFragmentElement)) {\n    return\n  }\n\n  const params = getStoredShelfParamsForCurrentPage()\n  if (!params) return\n\n  const baseUrl = includeFragmentEl.getAttribute('data-base-src')\n  if (!baseUrl) return\n\n  const shelfURL = new URL(baseUrl, window.location.origin)\n  const searchParams = new URLSearchParams(shelfURL.search)\n\n  for (const [key, value] of Object.entries(params)) {\n    if (typeof value === 'string') searchParams.set(key, value)\n  }\n  shelfURL.search = searchParams.toString()\n  includeFragmentEl.setAttribute('src', shelfURL.toString())\n}\n\n// Submits an AJAX request, but ignores any errors.\nasync function performRequest(wants: Kicker) {\n  try {\n    await wants.text()\n  } catch (error) {\n    // TODO show error message\n  }\n}\n","import {\n  loadShelfFromStoredParams,\n  remoteShelfActionForm,\n  urlWithoutNotificationParameters\n} from './../notifications/v2/notification-shelf-helpers'\nimport {loaded} from '../document-ready'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {replaceState} from '../history'\nimport {requestSubmit} from '../form'\n\nremoteShelfActionForm()\n\n// Remove the notification_referrer_id parameter from the url on page load\nfunction removeNotificationParams() {\n  const newUrl = urlWithoutNotificationParameters()\n  if (newUrl) replaceState(null, '', newUrl)\n}\nremoveNotificationParams()\n\nobserve('.js-notification-shelf-include-fragment', loadShelfFromStoredParams)\n\non('submit', '.js-mark-notification-form', async function (event) {\n  const form = event.currentTarget as HTMLFormElement\n  event.preventDefault()\n  try {\n    await fetch(form.action, {\n      method: form.method,\n      body: new FormData(form),\n      headers: {\n        Accept: 'application/json',\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    })\n  } catch {\n    // Ignore network errors\n  }\n})\n\n// mark related notification as read\nasync function markNotificationAsRead() {\n  await loaded\n\n  const form = document.querySelector('.js-mark-notification-form')\n  if (form instanceof HTMLFormElement) {\n    requestSubmit(form)\n  }\n}\n\nmarkNotificationAsRead()\n","import {onFocus, onKey} from '../onfocus'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nfunction isJumpToAvailable(field: Element): boolean {\n  return !!field.closest('.js-jump-to-field')\n}\n\nfunction toggleSearchScope(field: HTMLElement, enabled: boolean) {\n  // We don't want legacy search behaviour of changing scope on backspace when using Jump To.\n  if (isJumpToAvailable(field)) {\n    return\n  }\n  const form = document.querySelector<HTMLFormElement>('.js-site-search-form')!\n  document.querySelector<HTMLElement>('.js-site-search')!.classList.toggle('scoped-search', enabled)\n\n  let url\n  let placeholder\n  if (enabled) {\n    url = form.getAttribute('data-scoped-search-url')!\n    placeholder = field.getAttribute('data-scoped-placeholder')!\n  } else {\n    url = form.getAttribute('data-unscoped-search-url')!\n    placeholder = field.getAttribute('data-unscoped-placeholder')!\n  }\n\n  form.setAttribute('action', url)\n  field.setAttribute('placeholder', placeholder)\n}\n\nonKey('keyup', '.js-site-search-field', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  const field = event.target as HTMLInputElement\n\n  const emptyQuery = field.value.length === 0\n  if (emptyQuery && event.key === 'Backspace' && field.classList.contains('is-clearable')) {\n    toggleSearchScope(field, false)\n  }\n  if (emptyQuery && event.key === 'Escape') {\n    toggleSearchScope(field, true)\n  }\n  field.classList.toggle('is-clearable', emptyQuery)\n  /* eslint-enable no-restricted-syntax */\n})\n\nonFocus('.js-site-search-focus', function (field) {\n  const container = field.closest<HTMLElement>('.js-chromeless-input-container')!\n  container.classList.add('focus')\n\n  // Restore scope on blur\n  function blurHandler() {\n    container.classList.remove('focus')\n    if ((field as HTMLInputElement).value.length === 0 && field.classList.contains('js-site-search-field')) {\n      toggleSearchScope(field, true)\n    }\n    field.removeEventListener('blur', blurHandler)\n  }\n\n  field.addEventListener('blur', blurHandler)\n})\n\non('submit', '.js-site-search-form', function (event) {\n  if (!(event.target instanceof Element)) return\n  const input = event.target.querySelector<HTMLInputElement>('.js-site-search-type-field')!\n  input.value = new URLSearchParams(window.location.search).get('type') || ''\n})\n","// Size to Fit textarea behavior\n//\n// Auto sizes any textareas marked with `.js-size-to-fit` to its text\n// contents height.\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport subscribe from '@github/textarea-autosize'\n\nobserve('textarea.js-size-to-fit', {\n  constructor: HTMLTextAreaElement,\n  subscribe\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nconst hiddenTimePeriodOnScrollInMs = 1000\n\nconst abortControllers = new WeakMap()\n\nconst snippetClipboardCopyTemplate = document.querySelector<HTMLTemplateElement>('#snippet-clipboard-copy-button')\n\nasync function insertSnippetClipboardCopyButton(el: HTMLElement, signal: AbortSignal): Promise<void> {\n  const clipboardContent = el.getAttribute('data-snippet-clipboard-copy-content')\n  if (clipboardContent === null) return\n\n  // Remove this attribute so that we don't add a second button.\n  el.removeAttribute('data-snippet-clipboard-copy-content')\n\n  if (!(snippetClipboardCopyTemplate instanceof HTMLTemplateElement)) return\n\n  const documentFragment = snippetClipboardCopyTemplate.content.cloneNode(true) as DocumentFragment\n\n  const clonedZeroClipboardContainer = documentFragment.children[0]\n  if (!(clonedZeroClipboardContainer instanceof HTMLElement)) return\n\n  const clipboardCopyElement = clonedZeroClipboardContainer.children[0]\n  if (!(clipboardCopyElement instanceof HTMLElement)) return\n\n  clipboardCopyElement.setAttribute('value', clipboardContent)\n\n  document.addEventListener(\n    'selectionchange',\n    () => {\n      const selection = document.getSelection()\n      if (selection && el.contains(selection.anchorNode)) {\n        const selectedText = selection?.toString()\n        clipboardCopyElement.style.display = selectedText.trim() === '' ? 'inherit' : 'none'\n      }\n    },\n    {signal}\n  )\n\n  const scrollableElement = el.querySelector('pre')\n  if (scrollableElement !== null) {\n    let timer: ReturnType<typeof setTimeout> | undefined\n\n    /* eslint-disable-next-line github/prefer-observers */\n    scrollableElement.addEventListener(\n      'scroll',\n      () => {\n        if (timer) clearTimeout(timer)\n\n        clipboardCopyElement.style.display = 'none'\n        timer = setTimeout(() => {\n          clipboardCopyElement.style.display = 'inherit'\n        }, hiddenTimePeriodOnScrollInMs)\n      },\n      {signal}\n    )\n  }\n\n  el.appendChild(clonedZeroClipboardContainer)\n}\n\nobserve('[data-snippet-clipboard-copy-content]', {\n  constructor: HTMLElement,\n  add(el) {\n    if (el.parentElement && el.parentElement.classList.contains('js-no-snippet-clipboard-copy')) return\n\n    const abortController = new AbortController()\n    abortControllers.set(el, abortController)\n\n    insertSnippetClipboardCopyButton(el, abortController.signal)\n  }\n})\n\nobserve('.snippet-clipboard-content clipboard-copy', {\n  constructor: HTMLElement,\n  remove(el) {\n    const controller = abortControllers.get(el)\n    if (controller) {\n      controller.abort()\n    }\n  }\n})\n","// Social Buttons\n//\n// Behavior for the Watch, Fork, and Star buttons within repo nav.\n//\n// Expects the JSON response to a .js-social-form XHR request to be in this format:\n//\n// On success:\n//\n// { \"count\": \"1,234\" }\n//\n// Count is formatted with delimiters. The social count in any .js-social child of .js-social-container will be updated\n// to the new value.\n//\n// If the form is annotated with the .js-deferred-toggler-target class, the .js-toggler container will have its state\n// toggled after the successful response has arrived (and not optimistically as .js-toggler-target behaves).\n//\n// Any .js-social-updatable child of .js-social-container with a data-url will also be re-fetched and updated with new\n// content.\n//\n// Failure cases:\n//\n// 409 Conflict - indicates that the user needs to confirm the social action in a dialog.\n//\n// {\n//   \"confirmationDialog\": {\n//     \"templateSelector\": \"[CSS selector to find DOM element containing <template> for dialog contents]\",\n//     \"inputs\": { \"arbitraryTemplateParts\": \"...\" }\n//   }\n// }\n//\n// Any other 4xx or 5xx error will result in a generic global error being shown.\n\nimport type {SimpleResponse} from '@github/remote-form'\nimport {TemplateInstance} from '@github/template-parts'\nimport {dialog} from '../details-dialog'\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\nimport {showGlobalError} from './ajax-error'\nimport {updateContent} from '../updatable-content'\n\nfunction handleSocialResponse(\n  container: HTMLElement,\n  newCount: string,\n  isDeferredTogglerTarget: boolean\n): Promise<void[]> {\n  updateSocialCounts(container, newCount)\n  if (isDeferredTogglerTarget) container.classList.toggle('on')\n\n  const updatePromises = Array.from(container.querySelectorAll<HTMLElement>('.js-social-updatable'), updateContent)\n  return Promise.all(updatePromises)\n}\n\nremoteForm('.js-social-form', async function (form, wants) {\n  let response: SimpleResponse\n  const container = form.closest<HTMLElement>('.js-social-container')\n  const isDeferredTogglerTarget = form.classList.contains('js-deferred-toggler-target')\n\n  try {\n    response = await wants.json()\n\n    if (container) await handleSocialResponse(container, response.json.count, isDeferredTogglerTarget)\n  } catch (e) {\n    // 409 Conflict: the user needs to accept a confirmation dialog. Find its template and trigger it.\n    if (e.response?.status === 409 && e.response.json.confirmationDialog) {\n      const dialogPayload = e.response.json.confirmationDialog\n      const confirmationDialogTemplate = document.querySelector<HTMLTemplateElement>(dialogPayload.templateSelector)\n      const confirmCsrfToken = form.querySelector<HTMLInputElement>('.js-confirm-csrf-token')?.value\n\n      if (confirmationDialogTemplate instanceof HTMLTemplateElement && confirmCsrfToken) {\n        const content = new TemplateInstance(confirmationDialogTemplate, {\n          confirmUrl: form.action,\n          confirmCsrfToken,\n          ...(dialogPayload.inputs || {})\n        })\n        const dialogElement = await dialog({content})\n\n        dialogElement.addEventListener('social-confirmation-form:success', async event => {\n          if (!(event instanceof CustomEvent)) return\n          if (container) await handleSocialResponse(container, event.detail.count, isDeferredTogglerTarget)\n        })\n\n        dialogElement.addEventListener('social-confirmation-form:error', () => {\n          showGlobalError()\n        })\n      }\n    } else {\n      // If the social form is also a toggler, but *not* a deferred one, it was optimistically toggled on click. Because\n      // the action failed, we need to toggle it back off here so it won't be in an incorrect state.\n      if (container && !isDeferredTogglerTarget) container.classList.toggle('on')\n\n      showGlobalError()\n    }\n  }\n})\n\nremoteForm('.js-social-confirmation-form', async function (form, wants) {\n  try {\n    const response = await wants.json()\n    fire(form, 'social-confirmation-form:success', response.json)\n  } catch {\n    fire(form, 'social-confirmation-form:error')\n  }\n})\n\nexport function updateSocialCounts(container: HTMLElement, newCount: string) {\n  for (const count of container.querySelectorAll('.js-social-count')) {\n    count.textContent = newCount\n\n    const singularSuffix = count.getAttribute('data-singular-suffix')\n    const pluralSuffix = count.getAttribute('data-plural-suffix')\n    const suffix = newCount === '1' ? singularSuffix : pluralSuffix\n\n    if (suffix) {\n      count.setAttribute('aria-label', `${newCount} ${suffix}`)\n    }\n  }\n}\n","import {AliveSession as BaseAliveSession} from '@github/alive-client'\nimport type {Notifier} from '@github/alive-client'\nexport class AliveSession<T> extends BaseAliveSession<T> {\n  constructor(url: string, private refreshUrl: string, shared: boolean, notify: Notifier<T>) {\n    super(url, () => this.getUrlFromRefreshUrl(), shared, notify)\n  }\n\n  private getUrlFromRefreshUrl() {\n    return fetchRefreshUrl(this.refreshUrl)\n  }\n}\n\ntype PostUrl = {url?: string; token?: string}\nasync function fetchRefreshUrl(url: string): Promise<string | null> {\n  const data = await fetchJSON<PostUrl>(url)\n  return data && data.url && data.token ? post(data.url, data.token) : null\n}\n\nasync function fetchJSON<T>(url: string): Promise<T | null> {\n  const response = await fetch(url, {headers: {Accept: 'application/json'}})\n  if (response.ok) {\n    return response.json()\n  } else if (response.status === 404) {\n    return null\n  } else {\n    throw new Error('fetch error')\n  }\n}\n\nasync function post(url: string, csrf: string): Promise<string> {\n  const response = await fetch(url, {\n    method: 'POST',\n    mode: 'same-origin',\n    headers: {\n      'Scoped-CSRF-Token': csrf\n    }\n  })\n  if (response.ok) {\n    return response.text()\n  } else {\n    throw new Error('fetch error')\n  }\n}\n","import {Subscription} from '../subscription'\n\ntype IdleListener = (isIdle: boolean) => unknown\n\nconst idleListeners: IdleListener[] = []\nconst DEBOUNCE_UNTIL_IDLE = 30000\nconst DEBOUNCE_UNTIL_ACTIVE = 0 // If active, we want to send immediately\nlet idle = document.hidden // if the page is hidden on load, consider it idle immediately\nlet visibilityDebounceTimeout: ReturnType<typeof setTimeout> | undefined\n\nexport function addIdleStateListener(listener: IdleListener) {\n  listener(idle)\n  idleListeners.push(listener)\n\n  return new Subscription(() => {\n    const index = idleListeners.indexOf(listener)\n    if (index !== -1) {\n      idleListeners.splice(index, 1)\n    }\n  })\n}\n\n;(() => {\n  // listen for visibility change events, which trigger the wait period for idle changes\n  document.addEventListener('visibilitychange', () => {\n    const pageIsHidden = document.hidden\n\n    if (visibilityDebounceTimeout !== undefined) {\n      // we were waiting to send an idle change, cancel the previous timeout and queue a new one\n      clearTimeout(visibilityDebounceTimeout)\n    }\n\n    // When page visibility changes, wait a little bit before marking as idle in case visibility comes back\n    const debouncePeriod = pageIsHidden ? DEBOUNCE_UNTIL_IDLE : DEBOUNCE_UNTIL_ACTIVE\n\n    visibilityDebounceTimeout = setTimeout(() => {\n      if (pageIsHidden === idle) {\n        // idle hasn't changed, don't call any listeners\n        return\n      }\n\n      idle = pageIsHidden\n      visibilityDebounceTimeout = undefined\n\n      // send current idle state to all listeners\n      for (const idleListener of idleListeners) {\n        idleListener(idle)\n      }\n    }, debouncePeriod)\n  })\n})()\n","import type {AliveEvent, Metadata, MetadataUpdate, Notifier, Subscription} from '@github/alive-client'\nimport {IDLE_METADATA_KEY, PresenceMetadataSet, SubscriptionSet, Topic, isPresenceChannel} from '@github/alive-client'\nimport {compose, fromEvent} from '../subscription'\n\nimport {AliveSession} from '../alive-session'\nimport {addIdleStateListener} from '../alive/idle-state'\nimport {debounce} from '@github/mini-throttle'\nimport {isFeatureEnabled} from '../features'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {ready} from '../document-ready'\nimport safeStorage from '../safe-storage'\nimport {taskQueue} from '../eventloop-tasks'\n\nfunction isSharedWorkerSupported(): boolean {\n  return 'SharedWorker' in window && safeStorage('localStorage').getItem('bypassSharedWorker') !== 'true'\n}\n\nfunction workerSrc(): string | null {\n  return document.head.querySelector<HTMLLinkElement>('link[rel=shared-web-socket-src]')?.href ?? null\n}\n\nfunction socketUrl(): string | null {\n  return document.head.querySelector<HTMLLinkElement>('link[rel=shared-web-socket]')?.href ?? null\n}\n\nfunction socketRefreshUrl(): string | null {\n  return (\n    document.head.querySelector<HTMLLinkElement>('link[rel=shared-web-socket]')?.getAttribute('data-refresh-url') ??\n    null\n  )\n}\n\nfunction sessionIdentifier(): string | null {\n  return (\n    document.head.querySelector<HTMLLinkElement>('link[rel=shared-web-socket]')?.getAttribute('data-session-id') ?? null\n  )\n}\n\nfunction subscriptions(el: Element): Array<Subscription<Element>> {\n  return channels(el).map((topic: Topic) => ({subscriber: el, topic}))\n}\n\nexport function channels(el: Element): Topic[] {\n  const names = (el.getAttribute('data-channel') || '').trim().split(/\\s+/)\n  return names.map(Topic.parse).filter(isPresent)\n}\n\nfunction isPresent(value: Topic | null): value is Topic {\n  return value != null\n}\n\nfunction notify(subscribers: Iterable<Element>, {channel, type, data}: AliveEvent) {\n  for (const el of subscribers) {\n    el.dispatchEvent(\n      new CustomEvent(`socket:${type}`, {\n        bubbles: false,\n        cancelable: false,\n        detail: {name: channel, data}\n      })\n    )\n  }\n}\n\nclass AliveSessionProxy {\n  private worker: SharedWorker\n  private subscriptions = new SubscriptionSet<Element>()\n  private presenceMetadata = new PresenceMetadataSet<Element>()\n  private notify: Notifier<Element>\n\n  constructor(src: string, url: string, refreshUrl: string, sessionId: string, notifier: Notifier<Element>) {\n    this.notify = notifier\n    this.worker = new SharedWorker(src, `github-socket-worker-v2-${sessionId}`)\n    this.worker.port.onmessage = ({data}) => this.receive(data)\n    this.worker.port.postMessage({connect: {url, refreshUrl}})\n  }\n\n  subscribe(subs: Array<Subscription<Element>>) {\n    const added = this.subscriptions.add(...subs)\n    if (added.length) {\n      this.worker.port.postMessage({subscribe: added})\n    }\n\n    // We may be adding a subscription to a presence channel which is already subscribed.\n    // In this case, we need to explicitly ask the SharedWorker to send us the presence data.\n    const addedChannels = new Set(added.map(topic => topic.name))\n    const redundantPresenceChannels = subs.reduce((redundantChannels, subscription) => {\n      const channel = subscription.topic.name\n\n      if (isPresenceChannel(channel) && !addedChannels.has(channel)) {\n        redundantChannels.add(channel)\n      }\n\n      return redundantChannels\n    }, new Set<string>())\n\n    if (redundantPresenceChannels.size) {\n      this.worker.port.postMessage({requestPresence: Array.from(redundantPresenceChannels)})\n    }\n  }\n\n  unsubscribeAll(...subscribers: Element[]) {\n    const removed = this.subscriptions.drain(...subscribers)\n    if (removed.length) {\n      this.worker.port.postMessage({unsubscribe: removed})\n    }\n\n    const updatedPresenceChannels = this.presenceMetadata.removeSubscribers(subscribers)\n    this.sendPresenceMetadataUpdate(updatedPresenceChannels)\n  }\n\n  updatePresenceMetadata(metadataUpdates: Array<MetadataUpdate<Element>>) {\n    const updatedChannels = new Set<string>()\n\n    for (const update of metadataUpdates) {\n      // update the local metadata for this specific element\n      this.presenceMetadata.setMetadata(update)\n      updatedChannels.add(update.channelName)\n    }\n\n    // Send the full local metadata for these channels to the SharedWorker\n    this.sendPresenceMetadataUpdate(updatedChannels)\n  }\n\n  sendPresenceMetadataUpdate(channelNames: Set<string>) {\n    if (!channelNames.size) {\n      return\n    }\n\n    const updatesForSharedWorker: Array<Omit<MetadataUpdate<Element>, 'subscriber'>> = []\n\n    for (const channelName of channelNames) {\n      // get all metadata for this channel (from all elements) to send to the SharedWorker\n      updatesForSharedWorker.push({\n        channelName,\n        metadata: this.presenceMetadata.getChannelMetadata(channelName)\n      })\n    }\n\n    // Send the full metadata updates to the SharedWorker\n    this.worker.port.postMessage({updatePresenceMetadata: updatesForSharedWorker})\n  }\n\n  online() {\n    this.worker.port.postMessage({online: true})\n  }\n\n  offline() {\n    this.worker.port.postMessage({online: false})\n  }\n\n  hangup() {\n    this.worker.port.postMessage({hangup: true})\n  }\n\n  private notifyPresenceDebouncedByChannel = new Map<string, Notifier<Element>>()\n  private receive(event: AliveEvent) {\n    const {channel} = event\n\n    if (event.type === 'presence') {\n      // There are times when we get a flood of messages from the SharedWorker, such as a tab that has been idle for a long time and then comes back to the foreground.\n      // Since each presence message for a channel contains the full list of users, we can debounce the events and only notify subscribers with the last one\n      let debouncedNotify = this.notifyPresenceDebouncedByChannel.get(channel)\n      if (!debouncedNotify) {\n        debouncedNotify = debounce((subscribers, debouncedEvent) => {\n          this.notify(subscribers, debouncedEvent)\n          this.notifyPresenceDebouncedByChannel.delete(channel)\n        }, 100)\n        this.notifyPresenceDebouncedByChannel.set(channel, debouncedNotify)\n      }\n\n      debouncedNotify(this.subscriptions.subscribers(channel), event)\n      return\n    }\n\n    // For non-presence messages, we can send them through immediately since they may contain different messages/data\n    this.notify(this.subscriptions.subscribers(channel), event)\n  }\n}\n\nfunction connect() {\n  const src = workerSrc()\n  if (!src) return\n\n  const url = socketUrl()\n  if (!url) return\n\n  const refreshUrl = socketRefreshUrl()\n  if (!refreshUrl) return\n\n  const sessionId = sessionIdentifier()\n  if (!sessionId) return\n\n  const createSession = () => {\n    if (isSharedWorkerSupported()) {\n      try {\n        return new AliveSessionProxy(src, url, refreshUrl, sessionId, notify)\n      } catch (_) {\n        // ignore errors.  CSP will some times block SharedWorker creation. Fall back to standard AliveSession.\n      }\n    }\n\n    return new AliveSession(url, refreshUrl, false, notify)\n  }\n  const session = createSession()\n\n  type Subs = Array<Subscription<Element>>\n  const queueSubscribe = taskQueue<Subs>(subs => session.subscribe(subs.flat()))\n  const queueUnsubscribe = taskQueue<Element>(els => session.unsubscribeAll(...els))\n  const queueMetadata = taskQueue<MetadataUpdate<Element>>(updates => session.updatePresenceMetadata(updates))\n\n  observe('.js-socket-channel[data-channel]', {\n    subscribe: el => {\n      const elementSubscriptions = subscriptions(el)\n      const presenceChannels = elementSubscriptions\n        .map(subscription => subscription.topic.name)\n        .filter(channelName => isPresenceChannel(channelName))\n\n      let listenerSubscription = {\n        unsubscribe() {\n          // nothing to clean up by default.  This will be overridden if there are presence channels\n        }\n      }\n\n      if (presenceChannels.length) {\n        let latestMetadata: Metadata | undefined = undefined\n        let latestIdle: boolean | undefined\n        const queueMetadataOrIdleChange = () => {\n          const metadata: Metadata[] = []\n\n          // combine metadata and idle values\n          if (latestMetadata) {\n            metadata.push(latestMetadata)\n          }\n          if (latestIdle !== undefined) {\n            metadata.push({[IDLE_METADATA_KEY]: latestIdle ? 1 : 0})\n          }\n\n          // Send the metadata to all presence channels on this element\n          for (const channelName of presenceChannels) {\n            queueMetadata({subscriber: el, channelName, metadata})\n          }\n        }\n\n        listenerSubscription = compose(\n          // listen for metadata updates emitted on the element\n          fromEvent(el, 'socket:set-presence-metadata', (e: Event) => {\n            const {detail} = e as CustomEvent\n            latestMetadata = detail\n            queueMetadataOrIdleChange()\n          }),\n          // listen for idle changes, which will cause us to send a metadata update\n          addIdleStateListener(idle => {\n            if (!isFeatureEnabled('PRESENCE_IDLE')) {\n              return\n            }\n            latestIdle = idle\n            queueMetadataOrIdleChange()\n          })\n        )\n      }\n\n      // Process normal subscriptions after setting up metadata listeners\n      // This needs to come second so that idle state is ready when we subscribe\n      queueSubscribe(elementSubscriptions)\n\n      return listenerSubscription\n    },\n    remove: el => queueUnsubscribe(el)\n  })\n\n  window.addEventListener('online', () => session.online())\n  window.addEventListener('offline', () => session.offline())\n  window.addEventListener('pagehide', () => {\n    if ('hangup' in session) session.hangup()\n  })\n}\n\n;(async () => {\n  await ready\n  connect()\n})()\n","import type {AliveData, Topic} from '@github/alive-client'\nimport {channels} from './socket-channel'\n\ntype Entry = {name: string; data: AliveData; arrived: number}\nconst cache = new Map<string, Entry>()\n\nfunction stale(topics: Topic[], since: number): Entry[] {\n  const entries = []\n  for (const topic of topics) {\n    const entry = cache.get(topic.name)\n    if (entry && entry.arrived > since) {\n      entries.push(entry)\n    }\n  }\n  return entries\n}\n\nfunction dispatch(container: Element, cachedAt: number) {\n  for (const el of container.querySelectorAll('.js-socket-channel[data-channel]')) {\n    for (const entry of stale(channels(el), cachedAt)) {\n      el.dispatchEvent(\n        new CustomEvent('socket:message', {\n          bubbles: false,\n          cancelable: false,\n          detail: {name: entry.name, data: entry.data, cached: true}\n        })\n      )\n    }\n  }\n}\n\nfunction store(event: Event) {\n  const {name, data, cached} = (event as CustomEvent).detail\n  if (cached) return\n  const entry = {name, data: {...data}, arrived: Date.now()}\n  entry.data.wait = 0\n  cache.set(name, entry)\n}\n\n// Cache socket messages for future delivery.\ndocument.addEventListener('socket:message', store, {capture: true})\n\n// Dispatch socket:message when elements are restored from PJAX cache.\ndocument.addEventListener('pjax:popstate', function (event: Event) {\n  const container = event.target as Element\n  const cachedAt = (event as CustomEvent).detail.cachedAt\n  if (cachedAt) setTimeout(() => dispatch(container, cachedAt))\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {requestSubmit} from '../form'\n\nobserve('form.js-auto-replay-enforced-sso-request', {\n  constructor: HTMLFormElement,\n  initialize(el) {\n    requestSubmit(el)\n  }\n})\n","import {fetchSafeDocumentFragment} from '../fetch'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport verifySsoSession from '../sso'\n\nfunction updateStatusPosition(container: Element, menu: HTMLElement, details: Element) {\n  const containerHeight = container.getBoundingClientRect().height\n  const menuRect = menu.getBoundingClientRect()\n  const iconRect = details.getBoundingClientRect()\n  let top = iconRect.top\n  // Ensure popover stays off the bottom of the page by at least 10 pixels\n  if (top + menuRect.height + 10 >= containerHeight) {\n    top = Math.max(containerHeight - menuRect.height - 10, 0)\n  }\n  let left = iconRect.right\n  // Show popover to the left\n  if (details.closest('.js-build-status-to-the-left') != null) {\n    left = Math.max(iconRect.left - menuRect.width - 10, 0)\n  }\n  menu.style.top = `${top}px`\n  menu.style.left = `${left}px`\n  menu.style.right = 'auto'\n}\n\non(\n  'toggle',\n  '.js-build-status .js-dropdown-details',\n  function (event) {\n    const details = event.currentTarget\n    const menu = details.querySelector<HTMLElement>('.js-status-dropdown-menu')\n    if (!menu) return\n\n    function closeOnToggle() {\n      if (!details.hasAttribute('open')) closeStatusPopover()\n    }\n\n    function closeOnScroll(scrollEvent: Event) {\n      if (!menu!.contains(scrollEvent.target as Element)) closeStatusPopover()\n    }\n\n    function closeStatusPopover() {\n      details.removeAttribute('open')\n      /* eslint-disable-next-line github/no-d-none */\n      menu!.classList.add('d-none')\n      details.appendChild(menu!)\n      details.removeEventListener('toggle', closeOnToggle)\n      window.removeEventListener('scroll', closeOnScroll)\n    }\n\n    details.addEventListener('toggle', closeOnToggle)\n\n    if (menu.classList.contains('js-close-menu-on-scroll')) {\n      /* eslint-disable-next-line github/prefer-observers */\n      window.addEventListener('scroll', closeOnScroll, {capture: true})\n    }\n\n    /* eslint-disable-next-line github/no-d-none */\n    menu.classList.remove('d-none')\n    menu.querySelector<HTMLElement>('.js-details-container')!.classList.add('open')\n    if (menu.classList.contains('js-append-menu-to-body')) {\n      // Move menu to body so it can overlay on top of other elements\n      document.body.appendChild(menu)\n      updateStatusPosition(document.body, menu, details)\n    }\n  },\n  {capture: true}\n)\n\nasync function loadStatus(el: Element) {\n  const details = el.querySelector('.js-dropdown-details')\n  const menu = el.querySelector('.js-status-dropdown-menu') || el.closest('.js-status-dropdown-menu')\n\n  if (!(menu instanceof HTMLElement)) {\n    // Status does not have an associated dropdown menu\n    return\n  }\n\n  const loader = menu.querySelector('.js-status-loader')\n  if (!loader) {\n    return\n  }\n\n  const loadingArea = menu.querySelector<HTMLElement>('.js-status-loading')!\n  const errorArea = menu.querySelector<HTMLElement>('.js-status-error')!\n\n  const url = loader.getAttribute('data-contents-url')!\n\n  /* eslint-disable-next-line github/no-d-none */\n  loadingArea.classList.remove('d-none')\n  /* eslint-disable-next-line github/no-d-none */\n  errorArea.classList.add('d-none')\n\n  let html\n  try {\n    await verifySsoSession()\n    html = await fetchSafeDocumentFragment(document, url)\n  } catch (error) {\n    /* eslint-disable-next-line github/no-d-none */\n    loadingArea.classList.add('d-none')\n    /* eslint-disable-next-line github/no-d-none */\n    errorArea.classList.remove('d-none')\n  }\n\n  if (html) {\n    loader.replaceWith(html)\n    menu.querySelector<HTMLElement>('.js-details-container')!.classList.add('open')\n    if (details && menu.classList.contains('js-append-menu-to-body')) {\n      updateStatusPosition(document.body, menu, details)\n    }\n  }\n}\n\non('click', '.js-status-retry', ({currentTarget}) => {\n  loadStatus(currentTarget)\n})\n\nfunction onMouseEnter(event: Event) {\n  const currentTarget = event.currentTarget as Element\n  loadStatus(currentTarget)\n}\n\nobserve('.js-build-status', {\n  add(el) {\n    el.addEventListener('mouseenter', onMouseEnter, {once: true})\n  },\n  remove(el) {\n    el.removeEventListener('mouseenter', onMouseEnter)\n  }\n})\n","import {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {requestSubmit} from '../form'\nimport sudo from '../sudo'\n\non('click', 'button[data-sudo-required], summary[data-sudo-required]', checkSudo)\nobserve('form[data-sudo-required]', {\n  constructor: HTMLFormElement,\n  subscribe: form => fromEvent(form, 'submit', checkSudo)\n})\n\nasync function checkSudo(event: Event) {\n  const currentTarget = event.currentTarget\n  if (!(currentTarget instanceof HTMLElement)) return\n\n  event.stopPropagation()\n  event.preventDefault()\n  const sudoPassed = await sudo()\n\n  if (sudoPassed) {\n    currentTarget.removeAttribute('data-sudo-required')\n    if (currentTarget instanceof HTMLFormElement) {\n      requestSubmit(currentTarget)\n    } else {\n      currentTarget.click()\n    }\n  }\n}\n","import {compare, fuzzyScore} from '../../fuzzy-filter'\nimport {compose, fromEvent} from '../../subscription'\nimport {fetchSafeDocumentFragment} from '../../fetch'\nimport {filterSort} from '../../filter-sort'\nimport memoize from '@github/memoize'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nconst selectors: {[key: string]: string} = {\n  'actor:': 'ul.js-user-suggestions',\n  'user:': 'ul.js-user-suggestions',\n  'operation:': 'ul.js-operation-suggestions',\n  'org:': 'ul.js-org-suggestions',\n  'action:': 'ul.js-action-suggestions',\n  'repo:': 'ul.js-repo-suggestions',\n  'country:': 'ul.js-country-suggestions'\n}\n\nobserve('text-expander[data-audit-url]', {\n  subscribe: el =>\n    compose(fromEvent(el, 'text-expander-change', onchange), fromEvent(el, 'text-expander-value', onvalue))\n})\n\nfunction onvalue(event: Event) {\n  const detail = (event as CustomEvent).detail\n  if (!isActivationKey(detail.key)) return\n  const value = detail.item.getAttribute('data-value')!\n  detail.value = `${detail.key}${value}`\n}\n\nfunction onchange(event: Event) {\n  const {key, provide, text} = (event as CustomEvent).detail\n  if (!isActivationKey(key)) return\n  const menu = event.target as HTMLElement\n  const url = menu.getAttribute('data-audit-url')!\n  provide(auditMenu(url, key, text))\n}\n\nfunction search(items: Element[], searchQuery: string): Element[] {\n  const query = searchQuery.toLowerCase()\n  const key = (item: Element) => {\n    const text = item.textContent!.toLowerCase().trim()\n    const score = fuzzyScore(text, query)\n    return score > 0 ? {score, text} : null\n  }\n  return query ? filterSort(items, key, compare) : items\n}\n\nconst children = memoize((el: Element) => [...el.children], {hash: (el: Element) => el.className})\n\nasync function auditMenu(url: string, key: string, query: string): Promise<{fragment?: HTMLElement; matched: boolean}> {\n  const lists = await cachedMenu(url)\n  const list = lists.querySelector<HTMLElement>(selector(key))\n  if (!list) return {matched: false}\n  const results = search(children(list), query).slice(0, 5)\n  const clone = list.cloneNode(false) as HTMLElement\n  clone.innerHTML = ''\n  for (const el of results) clone.append(el)\n  return {fragment: clone, matched: results.length > 0}\n}\n\nfunction isActivationKey(key: string): boolean {\n  return Object.getOwnPropertyNames(selectors).includes(key)\n}\n\nfunction selector(key: string): string {\n  const found = selectors[key]\n  if (!found) throw new Error(`Unknown audit log expander key: ${key}`)\n  return found\n}\n\nasync function fetchMenu(url: string): Promise<HTMLElement> {\n  const fragment = await fetchSafeDocumentFragment(document, url)\n  const root = document.createElement('div')\n  root.append(fragment)\n  return root\n}\nconst cachedMenu = memoize(fetchMenu)\n","import {compose, fromEvent} from '../../subscription'\nimport {compare} from '../../fuzzy-filter'\nimport {fetchSafeDocumentFragment} from '../../fetch'\nimport {filterSort} from '../../filter-sort'\nimport memoize from '@github/memoize'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nfunction getValue(el: Element): string | undefined | null {\n  if (el.hasAttribute('data-use-colon-emoji')) {\n    return el.getAttribute('data-value')\n  }\n\n  const emojiEl = el.firstElementChild\n  if (emojiEl && 'G-EMOJI' === emojiEl.tagName && !emojiEl.firstElementChild) {\n    return emojiEl.textContent\n  } else {\n    return el.getAttribute('data-value')\n  }\n}\n\nfunction search(items: Element[], searchQuery: string): Element[] {\n  const query = ` ${searchQuery.toLowerCase().replace(/_/g, ' ')}`\n  const key = (item: Element) => {\n    const text = item.getAttribute('data-emoji-name')!\n    const score = emojiScore(emojiText(item), query)\n    return score > 0 ? {score, text} : null\n  }\n  return filterSort(items, key, compare)\n}\n\nfunction emojiText(item: Element): string {\n  const aliases = item.getAttribute('data-text')!.trim().toLowerCase().replace(/_/g, ' ')\n  return ` ${aliases}`\n}\n\nfunction emojiScore(aliases: string, query: string): number {\n  const score = aliases.indexOf(query)\n  return score > -1 ? 1000 - score : 0\n}\n\nobserve('text-expander[data-emoji-url]', {\n  subscribe: el =>\n    compose(fromEvent(el, 'text-expander-change', onchange), fromEvent(el, 'text-expander-value', onvalue))\n})\n\nfunction onvalue(event: Event) {\n  const detail = (event as CustomEvent).detail\n  if (detail.key !== ':') return\n  detail.value = getValue(detail.item)\n}\n\nfunction onchange(event: Event) {\n  const {key, provide, text} = (event as CustomEvent).detail\n  if (key !== ':') return\n  const menu = event.target as Element\n  const url = menu.getAttribute('data-emoji-url')!\n  provide(emojiMenu(url, text))\n}\n\nasync function emojiMenu(url: string, query: string): Promise<{fragment: HTMLElement; matched: boolean}> {\n  const [list, children] = await cachedEmoji(url)\n  const results = search(children, query).slice(0, 5)\n  list.innerHTML = ''\n  for (const el of results) list.append(el)\n  return {fragment: list, matched: results.length > 0}\n}\n\nasync function fetchEmoji(url: string): Promise<[HTMLElement, Element[]]> {\n  const fragment = await fetchSafeDocumentFragment(document, url)\n  const root = fragment.firstElementChild as HTMLElement\n  return [root, [...root.children]]\n}\nconst cachedEmoji = memoize(fetchEmoji)\n","import {compare, fuzzyScore} from '../../fuzzy-filter'\nimport {compose, fromEvent} from '../../subscription'\nimport {html, render, unsafeHTML} from '@github/jtml'\n\nimport TextExpanderElement from '@github/text-expander-element'\nimport {filterSort} from '../../filter-sort'\nimport memoize from '@github/memoize'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {parseHTML} from '../../parse-html'\n\ninterface Data {\n  suggestions: SuggestionData[]\n  icons: Icons\n}\n\ninterface SuggestionData {\n  id: number\n  number: number\n  title: string\n  type: string\n}\n\ninterface Icons {\n  [key: string]: string\n}\n\nfunction asText(item: SuggestionData): string {\n  return `${item.number} ${item.title.trim().toLowerCase()}`\n}\n\nfunction search(items: SuggestionData[], query: string): SuggestionData[] {\n  if (!query) return items\n  const re = new RegExp(`\\\\b${escapeRegExp(query)}`)\n  const hashedScore = /^\\d+$/.test(query)\n    ? (text: string) => issueNumberScore(text, re)\n    : (text: string) => fuzzyScore(text, query)\n  const key = (item: SuggestionData) => {\n    const text = asText(item)\n    const score = hashedScore(text)\n    return score > 0 ? {score, text} : null\n  }\n  return filterSort(items, key, compare)\n}\n\nfunction escapeRegExp(regex: string): string {\n  return regex.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n}\n\n// Returns a score that gets higher as the query that matches a number starting\n// on a word boundary is found earlier in the string.\nfunction issueNumberScore(text: string, query: RegExp): number {\n  const score = text.search(query)\n  if (score > -1) {\n    return 1000 - score\n  } else {\n    return 0\n  }\n}\n\nfunction renderResults(issues: SuggestionData[], container: HTMLElement, icons: Icons): void {\n  const itemsTemplate = (items: SuggestionData[]) => html`\n    <ul role=\"listbox\" class=\"suggester-container suggester suggestions list-style-none position-absolute\">\n      ${items.map(itemTemplate)}\n    </ul>\n  `\n\n  const itemTemplate = (item: SuggestionData) => {\n    const icon = item.type in icons ? parseHTML(document, icons[item.type]) : ''\n    return html`\n      <li class=\"markdown-title\" role=\"option\" id=\"suggester-issue-${item.id}\" data-value=\"${item.number}\">\n        <span class=\"d-inline-block mr-1\">${icon}</span>\n        <small>#${item.number}</small> ${\n          // eslint-disable-next-line no-restricted-syntax\n          unsafeHTML(item.title)\n        }\n      </li>\n    `\n  }\n\n  render(itemsTemplate(issues), container)\n}\n\nobserve('text-expander[data-issue-url]', {\n  subscribe: el => {\n    const subscriptions = [\n      fromEvent(el, 'text-expander-change', onchange),\n      fromEvent(el, 'text-expander-value', onvalue),\n      fromEvent(el, 'keydown', onkeydown),\n      fromEvent(el, 'click', onclick)\n    ]\n\n    return compose(...subscriptions)\n  }\n})\n\nfunction onvalue(event: Event) {\n  const detail = (event as CustomEvent).detail\n  if (detail.key !== '#') return\n  const value = detail.item.getAttribute('data-value')!\n  detail.value = `#${value}`\n}\n\nfunction onchange(event: Event) {\n  const {key, provide, text} = (event as CustomEvent).detail\n  if (key !== '#') return\n  if (text === '#') {\n    hideSuggestions(event.target)\n    return\n  }\n\n  const menu = event.target as Element\n  const url = menu.getAttribute('data-issue-url')!\n  provide(issueMenu(url, text))\n}\n\nfunction hideSuggestions(target: EventTarget | null) {\n  if (!target) return\n\n  const textExpander = (target as HTMLElement).closest('text-expander') as TextExpanderElement\n  if (textExpander) {\n    textExpander.dismiss()\n  }\n}\n\nfunction onclick(event: Event) {\n  hideSuggestions(event.target)\n}\n\nfunction onkeydown(event: Event) {\n  const specialKeys = ['ArrowRight', 'ArrowLeft']\n  const {key} = event as KeyboardEvent\n  if (specialKeys.indexOf(key) < 0) return\n\n  hideSuggestions(event.target)\n}\n\nasync function issueMenu(url: string, query: string): Promise<{fragment: HTMLElement; matched: boolean}> {\n  const data: Data = await cachedJSON(url)\n  const list = document.createElement('div')\n  const results = search(data.suggestions, query).slice(0, 5)\n  renderResults(results, list, data.icons)\n  const root = list.firstElementChild as HTMLElement\n  return {fragment: root, matched: results.length > 0}\n}\n\nconst cachedJSON = memoize(async function <T>(url: RequestInfo): Promise<T> {\n  const response = await self.fetch(url, {\n    headers: {\n      'X-Requested-With': 'XMLHttpRequest',\n      Accept: 'application/json'\n    }\n  })\n  if (!response.ok) {\n    const responseError = new Error()\n    const statusText = response.statusText ? ` ${response.statusText}` : ''\n    responseError.message = `HTTP ${response.status}${statusText}`\n    throw responseError\n  }\n  return response.json()\n})\n","import {compose, fromEvent} from '../../subscription'\nimport {html, render} from '@github/jtml'\nimport {compare} from '../../fuzzy-filter'\nimport {filterSort} from '../../filter-sort'\nimport memoize from '@github/memoize'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\ninterface UserData {\n  login: string\n  type: string\n  id: string\n  name: string\n  description: string\n  participant?: boolean\n}\n\nfunction asText(item: UserData): string {\n  return item.description\n    ? `${item.name} ${item.description}`.trim().toLowerCase() // team\n    : `${item.login} ${item.name}`.trim().toLowerCase() // user\n}\n\nfunction search(items: UserData[], query: string): UserData[] {\n  if (!query) return items\n  const scorer = fuzzyScorer(query)\n  const key = (item: UserData) => {\n    const text = asText(item)\n    const score = scorer(text, item.participant)\n    return score > 0 ? {score, text} : null\n  }\n  return filterSort(items, key, compare)\n}\n\nfunction renderResults(usersAndTeams: UserData[], container: HTMLElement): void {\n  const itemsTemplate = (items: UserData[]) => html`\n    <ul role=\"listbox\" class=\"suggester-container suggester suggestions list-style-none position-absolute\">\n      ${items.map(itemTemplate)}\n    </ul>\n  `\n\n  const itemTemplate = (item: UserData) => {\n    const name = item.type === 'user' ? item.login : item.name\n    const desc = item.type === 'user' ? item.name : item.description\n    return html`\n      <li role=\"option\" id=\"suggester-${item.id}-${item.type}-${name}\" data-value=\"${name}\">\n        <span>${name}</span>\n        <small>${desc}</small>\n      </li>\n    `\n  }\n\n  render(itemsTemplate(usersAndTeams), container)\n}\n\nfunction fuzzyScorer(query: string): (text: string, participant?: boolean) => number {\n  if (!query) return () => 2.0\n  const queryChars = query.toLowerCase().split('')\n  return (text: string, participant?: boolean): number => {\n    if (!text) return 0.0\n    const match = shortestMatch(text, queryChars)\n    if (!match) return 0.0\n    const value = query.length / (match[1] as number)\n    const score = value / ((match[0] as number) / 2 + 1)\n    if (participant) return score + 1\n    return score\n  }\n}\n\n// Get the shortest match (least distance between start and end index) for all\n// the query characters in the given text.\n//\n// Returns an array in format [firstIndex, matchLength, [matchIndexes]]\nfunction shortestMatch(text: string, queryChars: string[]): Array<number | number[]> | null {\n  let indexes\n  let j\n  let len\n  let match\n  const starts = allIndexesOf(text, queryChars[0])\n  if (starts.length === 0) {\n    return null\n  }\n  if (queryChars.length === 1) {\n    return [starts[0], 1, []]\n  }\n  match = null\n  for (j = 0, len = starts.length; j < len; j++) {\n    const start = starts[j]\n    if (!(indexes = indexesOfChars(text, queryChars, start + 1))) {\n      continue\n    }\n    const length = indexes[indexes.length - 1] - start\n    if (!match || length < match[1]) {\n      match = [start, length, indexes]\n    }\n  }\n  return match\n}\n\n// Find all indexes of character inside a string.\nfunction allIndexesOf(string: string, char: string) {\n  let index = 0\n  const results1 = []\n  while ((index = string.indexOf(char, index)) > -1) {\n    results1.push(index++)\n  }\n  return results1\n}\n\n// Find all indexes of characters of query string in order.\nfunction indexesOfChars(string: string, chars: string[], startingIndex: number): number[] | undefined {\n  let index = startingIndex\n  const indexes = []\n  for (let i = 1; i < chars.length; i += 1) {\n    index = string.indexOf(chars[i], index)\n    if (index === -1) return\n    indexes.push(index++)\n  }\n  return indexes\n}\n\nobserve('text-expander[data-mention-url]', {\n  subscribe: el =>\n    compose(fromEvent(el, 'text-expander-change', onchange), fromEvent(el, 'text-expander-value', onvalue))\n})\n\nfunction onvalue(event: Event) {\n  const detail = (event as CustomEvent).detail\n  if (detail.key !== '@') return\n  const login = detail.item.getAttribute('data-value')!\n  detail.value = `@${login}`\n}\n\nfunction onchange(event: Event) {\n  const {key, provide, text} = (event as CustomEvent).detail\n  if (key !== '@') return\n  // do not allow multi-word mentions\n  if (text?.split(' ').length > 1) return\n  const menu = event.target as Element\n  const url = menu.getAttribute('data-mention-url')!\n  provide(mentionMenu(url, text))\n}\n\nasync function mentionMenu(url: string, query: string): Promise<{fragment: HTMLElement; matched: boolean}> {\n  const data: UserData[] = await cachedJSON(url)\n  const list = document.createElement('div')\n  const results = search(data, query).slice(0, 5)\n  renderResults(results, list)\n  const root = list.firstElementChild as HTMLElement\n  return {fragment: root, matched: results.length > 0}\n}\n\nconst cachedJSON = memoize(async function <T>(url: RequestInfo): Promise<T> {\n  const response = await self.fetch(url, {\n    headers: {\n      'X-Requested-With': 'XMLHttpRequest',\n      Accept: 'application/json'\n    }\n  })\n  if (!response.ok) {\n    const responseError = new Error()\n    const statusText = response.statusText ? ` ${response.statusText}` : ''\n    responseError.message = `HTTP ${response.status}${statusText}`\n    throw responseError\n  }\n  return response.json()\n})\n","import {compare, fuzzyScore} from '../../fuzzy-filter'\nimport {compose, fromEvent} from '../../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {persistResumableFields, restoreResumableFields} from '@github/session-resume'\nimport SlashCommandExpanderElement from '../../slash-command-expander-element'\nimport {fetchSafeDocumentFragment} from '../../fetch'\nimport {filterSort} from '../../filter-sort'\nimport {getPageID} from '../../session-resume-helpers'\nimport memoize from '@github/memoize'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nconst SLASH_COMMAND_STRING_BEGINNING = '/'\n\nfunction search(items: Element[], searchQuery: string): Element[] {\n  const query = searchQuery.toLowerCase().trim()\n  const key = (item: Element) => {\n    const text = (item.getAttribute('data-text') || '').trim().toLowerCase()\n    const score = fuzzyScore(text, query)\n    return score > 0 ? {score, text} : null\n  }\n\n  if (query) {\n    return filterSort(items, key, compare)\n  } else {\n    return items\n  }\n}\n\nobserve('slash-command-expander[data-slash-command-url]', {\n  subscribe: el =>\n    compose(fromEvent(el, 'text-expander-change', onChange), fromEvent(el, 'text-expander-value', onValue))\n})\n\n// Trigger the menu from the markdown toolbar button\non('click', '.js-slash-command-toolbar-button', async event => {\n  if (!(event.target instanceof Element)) return\n\n  const container = event.target.closest<HTMLElement>('.js-previewable-comment-form')\n  if (!container) return\n\n  const textarea = container.querySelector<HTMLTextAreaElement>('textarea.js-comment-field')\n  if (!textarea) return\n\n  // similar to the `insertText` utility behavior, but with different cursor positioning\n  const text = SLASH_COMMAND_STRING_BEGINNING\n  const point = textarea.selectionEnd || 0\n  const beginning = textarea.value.substring(0, point)\n  const remaining = textarea.value.substring(point)\n  const space = textarea.value === '' || beginning.match(/\\s$/) ? '' : ' '\n  const cursorPosition = point + text.length + 1 // place cursor after the slash\n\n  textarea.value = beginning + space + text + remaining\n  textarea.selectionStart = cursorPosition\n  textarea.selectionEnd = cursorPosition\n  textarea.focus()\n\n  fire(textarea, 'input')\n})\n\nasync function onValue(event: Event) {\n  const detail = (event as CustomEvent).detail\n  const {key, item}: {key: string; item: HTMLElement} = detail\n  if (key !== SLASH_COMMAND_STRING_BEGINNING) return\n\n  const url = item.getAttribute('data-url')\n  if (!url) return\n\n  // find form to hide\n  const currentTarget = event.currentTarget as SlashCommandExpanderElement\n\n  // Leaving this here so that a linter doesn't complain\n  const form = item.querySelector<HTMLFormElement>('.js-slash-command-suggestion-form')\n  if (!form) return\n\n  const token = form.querySelector<HTMLInputElement>('.js-data-url-csrf')\n  if (!token) return\n\n  const formData = new FormData(form)\n  currentTarget.isLoading()\n\n  try {\n    const response = await fetchSafeDocumentFragment(document, url, {\n      method: 'PATCH',\n      body: formData,\n      headers: {\n        Accept: 'text/html',\n        'Scoped-CSRF-Token': token.value\n      }\n    })\n\n    if (!response) return\n    handleResponse(currentTarget, response)\n  } catch {\n    currentTarget.showError()\n  }\n}\n\nfunction handleResponse(expander: SlashCommandExpanderElement, response: DocumentFragment) {\n  const component = response.firstElementChild\n  if (!component) return\n\n  if (response.children.length > 1) {\n    showFooter(response.lastElementChild as HTMLElement, expander)\n  }\n\n  if (component.hasAttribute('data-reload-suggestions')) {\n    // re-fetch the commands if the resource state has changed\n    cachedCommands = memoize(fetchSlashCommands)\n  }\n\n  const responseType = component.getAttribute('data-component-type')\n  if (responseType === 'fill') {\n    // if the content contains html tags, we'll use innerHTML\n    if (/<\\/?[a-z][\\s\\S]*>/i.test(component.innerHTML)) {\n      expander.setValue(component.innerHTML.trim())\n    } else {\n      // otherwise we'll use textContent so we aren't inserting unnecessary HTML entity characters\n      expander.setValue(component.textContent?.trim() || '')\n    }\n  } else if (responseType === 'menu' || responseType === 'error') {\n    expander.setMenu(component.querySelector('.js-slash-command-menu') as HTMLElement)\n  } else if (responseType === 'action') {\n    expander.closeMenu()\n  } else if (responseType === 'embedded_form') {\n    handleEmbeddedForm(expander, component)\n  } else if (responseType === 'dialog_form') {\n    handleDialogForm(expander, component)\n  } else if (responseType === 'modal_form') {\n    handleModalForm(expander, component)\n  }\n\n  restoreResumableFields(getPageID())\n}\n\nfunction submitOnCommandEnter(event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (!(event.metaKey && event.key === 'Enter')) return\n\n  event.preventDefault()\n  event.stopPropagation()\n\n  const input = event.target as HTMLInputElement | null\n  const form = input?.form as HTMLFormElement | null\n\n  if (!form) return\n\n  if (form.requestSubmit) {\n    form.requestSubmit()\n  } else {\n    // Handle browsers that don't support support `requestSubmit`, like Safari.\n    // This relies on the presence of a submit button. If absent, Cmd-Enter won't do anything.\n    const submitButton = form.querySelector(\"[type='submit']\") as HTMLElement\n    submitButton?.click()\n  }\n  /* eslint-enable no-restricted-syntax */\n}\n\nfunction getFormContents(form: HTMLFormElement) {\n  const formData = new FormData(form)\n  let contents = ''\n\n  for (const fieldPair of formData) {\n    contents = contents + fieldPair[0]\n    contents = contents + fieldPair[1].toString()\n  }\n\n  return contents\n}\n\nfunction focusFirstFormInput(formElement: HTMLFormElement) {\n  let inputFocused = false\n  for (const element of formElement.querySelectorAll('select,input,textarea')) {\n    const input = element as HTMLInputElement\n\n    if (input.type !== 'hidden') {\n      if (!inputFocused) {\n        input.focus()\n        inputFocused = true\n      }\n\n      input.addEventListener('keydown', submitOnCommandEnter)\n    }\n  }\n}\n\nfunction hookUpCancelActionListeners(element: HTMLElement, closeForm: () => void) {\n  const closeElements = element.querySelectorAll('[data-close-dialog]')\n  for (const closeElement of closeElements) {\n    closeElement.addEventListener('click', (event: Event) => {\n      event.preventDefault()\n      persistResumableFields(getPageID(), {selector: '.js-session-resumable'})\n      closeForm()\n    })\n  }\n}\n\nfunction addDismissAlertListener(\n  formElement: HTMLFormElement,\n  elementToListenOn: HTMLElement,\n  previouslyFocused: HTMLElement,\n  closeForm: () => void\n) {\n  const originalFormContents = getFormContents(formElement)\n  elementToListenOn.addEventListener('keydown', (event: KeyboardEvent) => {\n    // TODO: Refactor to use data-hotkey\n    /* eslint eslint-comments/no-use: off */\n    /* eslint-disable no-restricted-syntax */\n    if (event.key === 'Escape') {\n      // eslint-disable-next-line i18n-text/no-en\n      const confirmationMessage = 'Are you sure you want to dismiss the form?'\n      const currentFormContents = getFormContents(formElement)\n      const isUnchanged = originalFormContents === currentFormContents\n\n      if (isUnchanged || confirm(confirmationMessage)) {\n        persistResumableFields(getPageID(), {selector: '.js-session-resumable'})\n        closeForm()\n\n        if (previouslyFocused) {\n          previouslyFocused.focus()\n        }\n      }\n    }\n    /* eslint-enable no-restricted-syntax */\n  })\n}\n\nfunction addSubmitButtonListener(\n  formElement: HTMLFormElement,\n  expander: SlashCommandExpanderElement,\n  closeForm: () => void\n) {\n  formElement.addEventListener('submit', async (event: Event) => {\n    event.preventDefault()\n    const form = event.target as HTMLFormElement\n    const token = form.querySelector<HTMLInputElement>('.js-data-url-csrf')\n    if (!token) return\n\n    const url = form.getAttribute('action')\n    if (!url) return\n\n    reenableParentFormButtons(expander)\n\n    const formData = new FormData(form)\n    const response = await fetchSafeDocumentFragment(document, url, {\n      method: 'PATCH',\n      body: formData,\n      headers: {\n        Accept: 'text/html',\n        'Scoped-CSRF-Token': token.value\n      }\n    })\n    closeForm()\n    if (!response) return\n    handleResponse(expander, response)\n  })\n}\n\n/*\n  When a slash command form is \"submitted\", the parent form's buttons can become\n  inadvertently disabled if they have a `data-disable-with` attribute, due to the\n  behavior defined in the `disable-with` module, which binds its event listeners ahead\n  of slash commands and cannot be prevented using stopPropagation.\n\n  Therefore, the parent form's buttons will need to be manually re-enabled\n  when the nested slash command form has been submitted.\n*/\nfunction reenableParentFormButtons(expander: SlashCommandExpanderElement) {\n  const siblingSurface = expander.closest('.js-slash-command-surface') as HTMLElement\n  const formSurface = expander.closest('form') as HTMLElement\n  const surface = siblingSurface || formSurface\n\n  if (surface) {\n    for (const button of surface.querySelectorAll('[data-disable-with][disabled]')) {\n      ;(button as HTMLInputElement | HTMLButtonElement).disabled = false\n    }\n  }\n}\n\nfunction handleDialogForm(expander: SlashCommandExpanderElement, component: Element) {\n  const menu = component.querySelector('.js-slash-command-menu') as HTMLElement\n  expander.setMenu(menu, true)\n\n  const componentForm = menu.querySelector('form') as HTMLFormElement\n  const previouslyFocused = document.activeElement as HTMLElement\n\n  focusFirstFormInput(componentForm)\n\n  const closeForm = () => {\n    expander.closeMenu()\n  }\n\n  addDismissAlertListener(componentForm, componentForm, previouslyFocused, closeForm)\n\n  hookUpCancelActionListeners(componentForm, closeForm)\n\n  addSubmitButtonListener(componentForm, expander, closeForm)\n}\n\nfunction handleModalForm(expander: SlashCommandExpanderElement, component: Element) {\n  const surfaceForm = expander.closest('form')\n\n  if (!surfaceForm) return\n\n  const commandFormContainer = component.querySelector('[data-component=\"form\"]') as HTMLFormElement\n  surfaceForm.insertAdjacentElement('afterend', commandFormContainer)\n\n  const previouslyFocused = document.activeElement as HTMLElement\n\n  focusFirstFormInput(commandFormContainer)\n\n  const closeForm = () => {\n    surfaceForm.hidden = false\n    commandFormContainer.remove()\n  }\n\n  hookUpCancelActionListeners(commandFormContainer, closeForm)\n\n  const commandForm = commandFormContainer.getElementsByTagName('form')[0]\n  addDismissAlertListener(commandForm, commandFormContainer, previouslyFocused, closeForm)\n\n  addSubmitButtonListener(commandFormContainer, expander, closeForm)\n}\n\nfunction handleEmbeddedForm(expander: SlashCommandExpanderElement, component: Element) {\n  const siblingSurface = expander.closest('.js-slash-command-surface') as HTMLElement\n  const formSurface = expander.closest('form') as HTMLElement\n  const surface = siblingSurface || formSurface\n\n  if (!surface) return\n  surface.hidden = true\n\n  const commandFormContainer = component.querySelector('[data-component=\"form\"]') as HTMLFormElement\n  surface.insertAdjacentElement('afterend', commandFormContainer)\n\n  const previouslyFocused = document.activeElement as HTMLElement\n\n  focusFirstFormInput(commandFormContainer)\n\n  const closeForm = () => {\n    surface.hidden = false\n    commandFormContainer.remove()\n  }\n\n  hookUpCancelActionListeners(commandFormContainer, closeForm)\n\n  const commandForm = commandFormContainer.getElementsByTagName('form')[0]\n  addDismissAlertListener(commandForm, commandFormContainer, previouslyFocused, closeForm)\n\n  addSubmitButtonListener(commandFormContainer, expander, closeForm)\n}\n\nconst durationToDisplayNotice = 5000\nfunction showFooter(footer: HTMLElement, slashCommandExpander: SlashCommandExpanderElement) {\n  const commentArea = slashCommandExpander.parentElement?.parentElement\n  if (!commentArea) return\n\n  const defaultFooter = commentArea.querySelector('.drag-and-drop .default') as HTMLElement\n\n  let previousDefaultFooterHidden = false\n  if (defaultFooter) {\n    previousDefaultFooterHidden = defaultFooter.hidden\n    defaultFooter.hidden = true\n  }\n\n  defaultFooter?.parentElement?.prepend(footer)\n\n  setTimeout(() => {\n    if (defaultFooter) {\n      defaultFooter.hidden = previousDefaultFooterHidden\n    }\n    footer.remove()\n  }, durationToDisplayNotice)\n}\n\nfunction onChange(event: Event) {\n  const {key, provide, text} = (event as CustomEvent).detail\n  if (key !== SLASH_COMMAND_STRING_BEGINNING) return\n  const menu = event.target as SlashCommandExpanderElement\n  menu.isLoading()\n  const url = menu.getAttribute('data-slash-command-url')!\n  provide(slashCommandMenu(url, text, menu))\n}\n\nasync function slashCommandMenu(\n  url: string,\n  query: string,\n  target: SlashCommandExpanderElement\n): Promise<{fragment: HTMLElement; matched: boolean}> {\n  try {\n    const [root, children] = await cachedCommands(url)\n    const list = root.querySelector('.js-slash-command-menu-items') as HTMLElement\n    const results = search(children, query)\n\n    if (list) {\n      list.innerHTML = ''\n\n      // we loop over `children` to ensure that the group sort order is maintained\n      // and so that we can include the relevant group headers for any search results\n      for (const el of children) {\n        if (el.classList.contains('js-group-divider')) {\n          // if it's a divider row, only append it if there are results for this group\n          const groupId = el.getAttribute('data-group-id')\n          const groupResults = results.filter(r => r.getAttribute('data-group-id') === groupId)\n\n          if (groupResults.length > 0) {\n            list.append(el)\n          }\n        } else if (results.includes(el)) {\n          // append the element if it is contained in the results\n          list.append(el)\n        }\n      }\n    }\n\n    return {fragment: root, matched: results.length > 0}\n  } catch (error) {\n    target.showError()\n    throw new Error(error)\n  }\n}\n\nasync function fetchSlashCommands(url: string): Promise<[HTMLElement, Element[]]> {\n  const fragment = await fetchSafeDocumentFragment(document, url)\n  const root = fragment.firstElementChild as HTMLElement\n  const children = root.querySelectorAll('.js-slash-command-menu-items li')\n  return [root, [...children]]\n}\nlet cachedCommands = memoize(fetchSlashCommands)\n","// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\n\n// Handle \"Other\" text input for the early access survey.\n//\n// field - The field.\n// isOther - If true then the \"Other\" input will be set to required, and focussed.\nfunction handleOther(field: Element, isOther: boolean) {\n  const question = field.closest<HTMLElement>('.js-survey-question-form')!\n  const otherInput = question.querySelector<HTMLInputElement>('input.js-survey-other-text')!\n  const isOtherSelected = isOther && !question.classList.contains('is-other-selected')\n\n  question.classList.toggle('is-other-selected', isOtherSelected)\n  otherInput.hidden = !isOther\n  if (isOtherSelected) {\n    otherInput.required = true\n    otherInput.focus()\n  } else {\n    otherInput.required = false\n  }\n  fire(otherInput, 'change')\n}\n\non('change', 'input.js-survey-radio', function ({currentTarget}) {\n  handleOther(currentTarget, currentTarget.classList.contains('js-survey-radio-other'))\n})\n\non('change', 'input.js-survey-checkbox-enable-submit', function ({currentTarget}) {\n  const checked = (currentTarget as HTMLInputElement).checked\n  const submitButton = currentTarget\n    .closest<HTMLElement>('form')\n    ?.querySelector<HTMLButtonElement>('button[type=submit]')\n\n  submitButton!.disabled = !checked\n})\n\non('change', 'input.js-survey-contact-checkbox', function (event: Event) {\n  const currentTarget = event.currentTarget as HTMLInputElement\n  const question = currentTarget.closest<HTMLElement>('.js-survey-question-form')!\n  const hiddenInput = question.querySelector<HTMLElement>('.js-survey-contact-checkbox-hidden')!\n  if (currentTarget.checked) {\n    hiddenInput.setAttribute('disabled', 'true')\n  } else {\n    hiddenInput.removeAttribute('disabled')\n  }\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non(\n  'details-menu-selected',\n  '.js-sync-select-menu-text',\n  function (event) {\n    const button = document.querySelector<HTMLElement>('.js-sync-select-menu-button')!\n    const text = (event.detail.relatedTarget as Element).querySelector<HTMLElement>(\n      'span[data-menu-button-text]'\n    )!.textContent\n    button.textContent = text\n    button.focus()\n  },\n  {capture: true}\n)\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('click', 'tab-container [role=\"tab\"]', function (event) {\n  const {currentTarget} = event\n\n  const menu = currentTarget.closest<HTMLElement>('tab-container')!\n  const filter = menu.querySelector('.js-filterable-field, [data-filter-placeholder-input]')\n  if (filter instanceof HTMLInputElement) {\n    const placeholder = currentTarget.getAttribute('data-filter-placeholder')\n    if (placeholder) {\n      filter.setAttribute('placeholder', placeholder)\n    }\n    filter.focus()\n  }\n})\n\non('tab-container-changed', 'tab-container', function (event) {\n  const panel = event.detail.relatedTarget\n  const url = panel.getAttribute('data-fragment-url')\n  const includeFragment = panel.querySelector('include-fragment')\n  if (url && includeFragment && !includeFragment.hasAttribute('src')) {\n    includeFragment.src = url\n  }\n})\n","import {preservePosition} from 'scroll-anchoring'\n\ndocument.addEventListener('keydown', (event: KeyboardEvent) => {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (event.key !== 'Escape') return\n  if (event.target !== document.body) return\n\n  const element = document.querySelector('.js-targetable-element:target')\n  if (!element) return\n\n  preservePosition(element, () => {\n    // Clear the `:target` element\n    window.location.hash = ''\n    // Clear the hash part of the URL\n    window.history.replaceState(null, '', window.location.pathname + window.location.search)\n  })\n  /* eslint-enable no-restricted-syntax */\n})\n\ndocument.addEventListener('click', (event: MouseEvent) => {\n  // Return early if there is no highlighted element\n  const highlightedElement = document.querySelector('.js-targetable-element:target')\n  if (!highlightedElement) return\n\n  // Don't mess with the URL if we clicked on a link\n  if (event.target instanceof HTMLAnchorElement) return\n\n  // Don't do anything if the user clicked on the already highlighted element\n  if (!(event.target instanceof HTMLElement)) return\n  if (highlightedElement.contains(event.target)) return\n\n  preservePosition(highlightedElement, () => {\n    // Clear the `:target` element\n    window.location.hash = ''\n    // Clear the hash part of the URL\n    window.history.replaceState(null, '', window.location.pathname + window.location.search)\n  })\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Load team members to display in the mention's tooltip from the server on hover.\nasync function members(event: Event) {\n  const target = event.currentTarget as HTMLElement\n  if (teamHovercardEnabled(target)) {\n    target.classList.remove('tooltipped')\n    return\n  }\n  const url = target.getAttribute('data-url')\n  if (!url) return\n\n  const response = await fetch(url, {headers: {Accept: 'application/json'}})\n  if (!response.ok) return\n  const data = (await response.json()) as {total: number; members: string[]}\n\n  const id = target.getAttribute('data-id')!\n  const mentions = document.querySelectorAll(`.js-team-mention[data-id='${id}']`)\n  for (const el of mentions) {\n    el.removeAttribute('data-url')\n  }\n\n  try {\n    if (data.total === 0) {\n      // eslint-disable-next-line i18n-text/no-en\n      data.members.push('This team has no members')\n    } else if (data.total > data.members.length) {\n      data.members.push(`${data.total - data.members.length} more`)\n    }\n    tip(mentions, sentence(data.members))\n  } catch (error) {\n    const status = error.response ? error.response.status : 500\n    const message = target.getAttribute(status === 404 ? 'data-permission-text' : 'data-error-text')!\n    tip(mentions, message)\n  }\n}\n\n// Add a tooltip to the elements. Adds the text just before the tooltip classes so\n// the tooltip appears fully formed on mouse hover.\nfunction tip(elements: NodeList, text: string): void {\n  for (const el of elements) {\n    if (!(el instanceof HTMLElement)) continue\n    el.setAttribute('aria-label', text)\n    el.classList.add('tooltipped', 'tooltipped-s', 'tooltipped-multiline')\n  }\n}\n\n// Comma separate a list of strings with `and` at the end, like\n// Rails' to_sentence.\nfunction sentence(xs: string[]): string {\n  if ('ListFormat' in Intl) {\n    const lists = new Intl.ListFormat()\n    return lists.format(xs)\n  }\n\n  if (xs.length === 0) {\n    return ''\n  } else if (xs.length === 1) {\n    return xs[0]\n  } else if (xs.length === 2) {\n    return xs.join(' and ')\n  } else {\n    const last = xs[xs.length - 1]\n    return xs.slice(0, -1).concat(`and ${last}`).join(', ')\n  }\n}\n\nfunction teamHovercardEnabled(element: HTMLElement): boolean {\n  return !!element.getAttribute('data-hovercard-url') && !!element.closest('[data-team-hovercards-enabled]')\n}\n\nobserve('.js-team-mention', function (el) {\n  el.addEventListener('mouseenter', members)\n})\n","import {controller, target} from '@github/catalyst'\n\n@controller\nclass TextSuggesterElement extends HTMLElement {\n  @target input: HTMLInputElement\n  @target suggestionContainer: HTMLElement\n  @target suggestion: HTMLElement\n\n  acceptSuggestion() {\n    if (this.suggestion?.textContent) {\n      this.input.value = this.suggestion.textContent\n      this.input.dispatchEvent(new Event('input'))\n      if (this.suggestionContainer) this.suggestionContainer.hidden = true\n      this.input.focus()\n    }\n  }\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\n\ninterface Request {\n  url: string\n  headers: Headers\n}\n\nfunction getTimelineLastModified(): string | null {\n  const marker = document.querySelector('.js-timeline-marker')\n  return marker != null ? marker.getAttribute('data-last-modified') : null\n}\n\n// Add the X-Timeline-Last-Modified header to the request based on the\n// the last modified time from the timeline marker element.\nfunction addTimelineLastModifiedHeader(request: Request) {\n  if (isCrossDomain(request) || isPjax(request)) {\n    return\n  }\n\n  const lastModified = getTimelineLastModified()\n  if (lastModified) {\n    request.headers.set('X-Timeline-Last-Modified', lastModified)\n  }\n}\n\nfunction isPjax(request: Request): boolean {\n  return request.headers.get('X-PJAX') === 'true'\n}\n\nfunction isCrossDomain(request: Request): boolean {\n  let requestURL\n  try {\n    // eslint-disable-next-line no-restricted-syntax\n    requestURL = new URL(request.url)\n  } catch (urlError) {\n    return true\n  }\n  return requestURL.host !== window.location.host\n}\n\nremoteForm('.js-needs-timeline-marker-header', function (form, wants, request) {\n  addTimelineLastModifiedHeader(request)\n})\n\non('deprecatedAjaxSend', '[data-remote]', function (event) {\n  const {request} = event.detail\n  addTimelineLastModifiedHeader(request)\n})\n","import {isDetailsTargetExpanded, toggleDetailsTarget} from '../details'\nimport {fetchSafeDocumentFragment} from '../../fetch'\nimport hashChange from '../hash-change'\nimport {loadDeferredContent} from '../include-fragment'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nconst SCROLL_WAIT_MEDIA_TIMEOUT = 5000\nconst COMMENT_IMAGE = '.js-comment-body img'\nconst COMMENT_VIDEO = '.js-comment-body video'\n\nhashChange(function () {\n  focusOrLoadElement()\n})\n\nobserve('.js-timeline-progressive-focus-container', function (container) {\n  const anchor = urlAnchor()\n  if (!anchor) return\n\n  const pullTimeline = document.querySelector<HTMLElement>('.js-pull-discussion-timeline')\n  if (pullTimeline) return\n\n  const target = document.getElementById(anchor)\n\n  if (target && container.contains(target)) {\n    focusElement(target)\n  }\n})\n\nfunction focusOrLoadElement(shouldLoadElement = true): void {\n  const anchor = urlAnchor()\n  if (!anchor) return\n\n  const target = document.getElementById(anchor)\n  if (target) {\n    focusElement(target)\n  } else {\n    if (loadComments(anchor)) return\n\n    const loader = document.querySelector<HTMLElement>('#js-timeline-progressive-loader')\n\n    if (loader && shouldLoadElement) {\n      loadElement(anchor, loader)\n    }\n  }\n}\n\nfunction loadComments(anchor: string): boolean {\n  return (\n    loadResolvedComments(anchor) ||\n    loadHiddenComments(anchor, '.js-thread-hidden-comment-ids') ||\n    loadHiddenComments(anchor, '.js-review-hidden-comment-ids')\n  )\n}\n\nfunction loadResolvedComments(anchor: string): boolean {\n  const commentContainer = findCommentContainer(anchor, '.js-comment-container')\n  if (!commentContainer) return false\n\n  loadDeferredContent(commentContainer)\n  return true\n}\n\nfunction loadHiddenComments(anchor: string, selector: string): boolean {\n  const commentContainer = findCommentContainer(anchor, selector)\n  if (!commentContainer) return false\n\n  commentContainer.addEventListener('page:loaded', function () {\n    focusOrLoadElement()\n  })\n  commentContainer.querySelector<HTMLButtonElement>('button[type=submit]')!.click()\n  return true\n}\n\nfunction findCommentContainer(anchor: string, selector: string): Element | null {\n  const commentContainers = document.querySelectorAll(selector)\n\n  for (const commentContainer of commentContainers) {\n    const threadCommentIds = commentContainer.getAttribute('data-hidden-comment-ids')\n\n    if (threadCommentIds) {\n      const commentIds = threadCommentIds.split(',')\n      const anchorCommentId = anchor.match(/\\d+/g)?.[0]\n\n      if (anchorCommentId && commentIds.includes(anchorCommentId)) {\n        return commentContainer\n      }\n    }\n  }\n  return null\n}\n\nobserve('.js-inline-comments-container', function (container) {\n  const anchor = urlAnchor()\n  if (!anchor) return\n\n  const target = document.getElementById(anchor)\n\n  if (target && container.contains(target)) {\n    focusElement(target)\n  }\n})\n\n// adds support for deep-link loading discussion comments when the comment thread is nested\nobserve('#js-discussions-timeline-anchor-loader', {\n  constructor: HTMLElement,\n  add: element => {\n    const existingProgressiveLoader = document.querySelector('#js-timeline-progressive-loader')\n    if (existingProgressiveLoader) return\n\n    const anchor = urlAnchor()\n    if (!anchor) return\n\n    const target = document.getElementById(anchor)\n    if (!target) {\n      loadElement(anchor, element)\n    }\n  }\n})\n\n// resolves when comment body videos have loaded enough data to render the preview image\nasync function videosReady(): Promise<unknown> {\n  const videos: NodeListOf<HTMLVideoElement> = document.querySelectorAll(COMMENT_VIDEO)\n  const videoLoads = Array.from(videos).map(v => {\n    return new Promise<HTMLVideoElement>(resolve => {\n      if (v.readyState >= v.HAVE_METADATA) {\n        resolve(v)\n      } else {\n        // don't wait forever :)\n        const timeout = setTimeout(() => resolve(v), SCROLL_WAIT_MEDIA_TIMEOUT)\n        const done = () => {\n          clearTimeout(timeout)\n          resolve(v)\n        }\n        v.addEventListener('loadeddata', () => {\n          if (v.readyState >= v.HAVE_METADATA) done()\n        })\n        v.addEventListener('error', () => done())\n      }\n    })\n  })\n  return Promise.all(videoLoads)\n}\n\n// resolves when comment body images are loaded\nasync function imagesReady(): Promise<unknown> {\n  const images: NodeListOf<HTMLImageElement> = document.querySelectorAll(COMMENT_IMAGE)\n  const imageLoads = Array.from(images).map(i => {\n    new Promise<HTMLImageElement>(resolve => {\n      if (i.complete) {\n        resolve(i)\n      } else {\n        const timeout = setTimeout(() => resolve(i), SCROLL_WAIT_MEDIA_TIMEOUT)\n        const done = () => {\n          clearTimeout(timeout)\n          resolve(i)\n        }\n        i.addEventListener('load', () => done())\n        i.addEventListener('error', () => done())\n      }\n    })\n  })\n  return Promise.all(imageLoads)\n}\n\nasync function mediaLoaded(): Promise<unknown> {\n  return Promise.all([videosReady(), imagesReady()])\n}\n\nasync function focusElement(element: HTMLElement): Promise<void> {\n  await mediaLoaded()\n  expandDetailsIfPresent(element)\n  const link = element.querySelector<HTMLElement>(`[href='#${element.id}']`)\n  if (link) {\n    const oldValue = link.getAttribute('data-turbo')\n    link.setAttribute('data-turbo', 'false')\n    link.click()\n    if (oldValue === null) {\n      link.removeAttribute('data-turbo')\n    } else {\n      link.setAttribute('data-turbo', oldValue)\n    }\n  }\n}\n\nasync function loadElement(anchor: string, loader: HTMLElement): Promise<void> {\n  if (!loader) return\n\n  const path = loader.getAttribute('data-timeline-item-src')\n  if (!path) return\n\n  const url = new URL(path, window.location.origin)\n  const params = new URLSearchParams(url.search.slice(1))\n  params.append('anchor', anchor)\n  url.search = params.toString()\n\n  let html\n  try {\n    html = await fetchSafeDocumentFragment(document, url.toString())\n  } catch (err) {\n    return\n  }\n\n  const newTimelineItem = html.querySelector('.js-timeline-item')\n  if (!newTimelineItem) return\n\n  const gid = newTimelineItem.getAttribute('data-gid')\n  if (!gid) return\n\n  const currentTimelineItem = document.querySelector(`.js-timeline-item[data-gid='${gid}']`)\n\n  if (currentTimelineItem) {\n    currentTimelineItem.replaceWith(newTimelineItem)\n\n    focusOrLoadElement(false)\n  } else {\n    const container = document.getElementById('js-progressive-timeline-item-container')\n    if (container) container.replaceWith(html)\n    focusOrLoadElement(false)\n  }\n}\n\nfunction expandDetailsIfPresent(element: HTMLElement): void {\n  const detailsContainer = element.closest<HTMLElement>('details, .js-details-container')\n  if (!detailsContainer) return\n  if (detailsContainer.nodeName === 'DETAILS') {\n    detailsContainer.setAttribute('open', 'open')\n  } else if (!isDetailsTargetExpanded(detailsContainer)) {\n    toggleDetailsTarget(detailsContainer)\n  }\n}\n\nfunction urlAnchor(): string {\n  return window.location.hash.slice(1)\n}\n","import {announceFromElement} from '../../aria-live'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('.js-discussion', announceTimelineEvents)\n\nfunction announceTimelineEvents() {\n  let existingTimelineItems: WeakSet<Element> = new WeakSet()\n  setExistingTimelineItems()\n\n  document.addEventListener('pjax:end', setExistingTimelineItems)\n\n  observe('.js-timeline-item', el => {\n    if (!(el instanceof HTMLElement)) return\n    if (existingTimelineItems.has(el)) return\n\n    announceFromElement(el)\n  })\n\n  function setExistingTimelineItems() {\n    existingTimelineItems = new WeakSet(document.querySelectorAll('.js-timeline-item'))\n  }\n}\n","import {getCLS, getFCP, getFID, getLCP, getTTFB} from 'web-vitals'\nimport type {Metric} from 'web-vitals'\nimport {loaded} from '../document-ready'\nimport {sendStats} from '../stats'\n\nfunction sendVitals(metric: Metric) {\n  const {name, value} = metric\n  const stat: PlatformBrowserPerformanceWebVitalTiming = {name: window.location.href}\n  switch (name) {\n    case 'CLS':\n      stat.cls = value\n      break\n    case 'FCP':\n      stat.fcp = value\n      break\n    case 'FID':\n      stat.fid = value\n      break\n    case 'LCP':\n      stat.lcp = value\n      break\n    case 'TTFB':\n      stat.ttfb = value\n      break\n  }\n  sendStats({webVitalTimings: [stat]})\n\n  updateStaffBar(name, value)\n}\n\nfunction updateStaffBar(name: string, value: number) {\n  const staffBarContainer = document.querySelector('#staff-bar-web-vitals')\n  const metricContainer = staffBarContainer?.querySelector(`[data-metric=${name.toLowerCase()}]`)\n\n  if (!metricContainer) {\n    return\n  }\n\n  metricContainer.textContent = value.toPrecision(6)\n}\n\nfunction isTimingSuppported(): boolean {\n  return !!(window.performance && window.performance.timing && window.performance.getEntriesByType)\n}\n\nasync function sendTimingResults() {\n  if (!isTimingSuppported()) return\n\n  await loaded\n  await new Promise(resolve => setTimeout(resolve))\n\n  const resourceTimings = window.performance.getEntriesByType('resource')\n  if (resourceTimings.length) {\n    sendStats({resourceTimings})\n  }\n\n  const navigationTimings = window.performance.getEntriesByType('navigation')\n  if (navigationTimings.length) {\n    sendStats({navigationTimings})\n  }\n}\n\nsendTimingResults()\ngetCLS(sendVitals)\ngetFCP(sendVitals)\ngetFID(sendVitals)\ngetLCP(sendVitals)\ngetTTFB(sendVitals)\n","// Toggler Behavior\n//\n// target    - Element with a \".js-toggler-target\" class name, clicking\n//             triggers toggle.\n// container - Element with a \".js-toggler-container\" class name,\n//             contains one or more targets.\n//\n// The toggle state is defined as \"off\" or \"on\". A \".on\" class name is\n// added to the container when the state is \"on\". \".on\" is removed if\n// the state is \"off\".\n//\n// Some extra AJAX states are available if any target makes use of\n// `data-remote`.\n//\n// loading - Added to the container before the request is sent and\n//           after it finishes.\n// success - Added to the container after a successful response\n//           returns.\n// error   - Added to the container after any bad responses.\n//\n// Examples\n//\n//   .starring-container .unstarred { display: block; }\n//   .starring-container.on .unstarred { display: none; }\n//   .starring-container .starred { display: none; }\n//   .starring-container.on .starred { display: block; }\n//\n//   <div class=\"js-toggler-container starring-container\">\n//     <button type=\"button\" href=\"#\" class=\"starred js-toggler-target\">Unstar repository</button>\n//     <button type=\"button\" class=\"unstarred js-toggler-target\">Star repository</button>\n//   </div>\n//\n\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {remoteForm} from '@github/remote-form'\n\non('click', '.js-toggler-container .js-toggler-target', function (event) {\n  // Ignore right-click events.\n  if (event.button !== 0) return\n\n  const container = event.currentTarget.closest('.js-toggler-container')\n  if (container) container.classList.toggle('on')\n})\n\nremoteForm('.js-toggler-container', async (form, wants) => {\n  form.classList.remove('success', 'error')\n  form.classList.add('loading')\n\n  try {\n    await wants.text()\n    form.classList.add('success')\n  } catch (responseError) {\n    form.classList.add('error')\n  } finally {\n    form.classList.remove('loading')\n  }\n})\n","import {ready} from '../document-ready'\n;(async function () {\n  if ('serviceWorker' in navigator) {\n    await ready\n    const serviceWorkerPath = document.querySelector<HTMLLinkElement>('link[rel=\"service-worker-src\"]')?.href\n    if (serviceWorkerPath) {\n      navigator.serviceWorker.register(serviceWorkerPath, {scope: '/'})\n    } else {\n      await unregisterAllServiceWorkers()\n    }\n  }\n})()\n\nasync function unregisterAllServiceWorkers() {\n  let registrations: readonly ServiceWorkerRegistration[] = []\n  try {\n    registrations = await navigator.serviceWorker.getRegistrations()\n  } catch (error) {\n    if (error.name === 'SecurityError') return\n  }\n\n  for (const registration of registrations) {\n    registration.unregister()\n  }\n}\n","import {\n  endSoftNav,\n  hasSoftNavFailure,\n  inSoftNavigation,\n  setSoftNavFailReason,\n  softNavFailed,\n  softNavInitial,\n  softNavSucceeded,\n  startSoftNav\n} from '../soft-nav-helpers'\nimport {isFeatureEnabled} from '../features'\ninterface ProgressBar {\n  setValue(n: number): void\n  hide(): void\n  show(): void\n}\ninterface BrowserAdapter {\n  progressBar: ProgressBar\n}\ninterface HeadSnapshot {\n  detailsByOuterHTML: {\n    [outerHTML: string]: {\n      tracked: boolean\n      elements: Element[]\n    }\n  }\n}\n\nif (isFeatureEnabled('TURBO')) {\n  ;(async () => {\n    const {PageRenderer, session} = await import('@hotwired/turbo')\n    const adapter = session.adapter as typeof session.adapter & BrowserAdapter\n\n    document.addEventListener('turbo:before-fetch-request', event => {\n      const frame = event.target\n      if ((frame as Element)?.tagName === 'TURBO-FRAME') {\n        adapter.progressBar.setValue(0)\n        adapter.progressBar.show()\n      }\n    })\n\n    document.addEventListener('turbo:frame-render', event => {\n      const frame = event.target\n      if ((frame as Element)?.tagName === 'TURBO-FRAME') {\n        adapter.progressBar.setValue(100)\n        adapter.progressBar.hide()\n      }\n    })\n\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    const originalTrackedElementsAreIdentical = Object.getOwnPropertyDescriptor(\n      PageRenderer.prototype,\n      'trackedElementsAreIdentical'\n    ).get!\n    Object.defineProperty(PageRenderer.prototype, 'trackedElementsAreIdentical', {\n      get() {\n        const identical = originalTrackedElementsAreIdentical.call(this)\n        if (!identical)\n          setReasonForTurboFail(this.currentHeadSnapshot as HeadSnapshot, this.newHeadSnapshot as HeadSnapshot)\n        return identical\n      }\n    })\n\n    function setReasonForTurboFail(current: HeadSnapshot, next: HeadSnapshot) {\n      const currentTracked = Object.fromEntries(getSnapshotSignatures(current))\n      for (const [key, value] of getSnapshotSignatures(next)) {\n        if (currentTracked[key] !== value) {\n          setSoftNavFailReason(`${key.replace(/^x-/, '')} changed`)\n          break\n        }\n      }\n    }\n\n    function* getSnapshotSignatures(snapshot: HeadSnapshot): IterableIterator<[string, string]> {\n      for (const detail of Object.values(snapshot.detailsByOuterHTML)) {\n        if (detail.tracked) {\n          for (const element of detail.elements) {\n            if (element instanceof HTMLMetaElement && element.getAttribute('http-equiv')) {\n              yield [element.getAttribute('http-equiv') || '', element.getAttribute('content') || '']\n            }\n          }\n        }\n      }\n    }\n  })()\n\n  const isIntraPageNavigation = (currentUrl: string, targetUrl: string): boolean => {\n    const current = new URL(currentUrl, window.location.origin)\n    const target = new URL(targetUrl, window.location.origin)\n\n    return current.host === target.host && current.pathname === target.pathname\n  }\n\n  document.addEventListener('turbo:click', function (event) {\n    if (!(event.target instanceof HTMLElement)) return\n\n    const el = event.target.closest('[data-turbo-frame]')\n    if (el instanceof HTMLElement) {\n      event.target.setAttribute('data-turbo-frame', el.getAttribute('data-turbo-frame') || '')\n    }\n\n    if (!(event instanceof CustomEvent)) return\n    // https://github.com/hotwired/turbo/issues/539\n    // If we are doing an intra-page navigation, we want to prevent Turbo from performing a visit\n    // so it won't mess with focus styles.\n    if (isIntraPageNavigation(location.href, event.detail.url)) {\n      event.preventDefault()\n    }\n  })\n\n  document.addEventListener('turbo:before-render', event => {\n    if (!(event instanceof CustomEvent)) return\n\n    const newDocument: HTMLHtmlElement = event.detail.newBody.ownerDocument.documentElement\n    const currentDocument = document.documentElement\n\n    for (const attr of currentDocument.attributes) {\n      if (!newDocument.hasAttribute(attr.nodeName) && attr.nodeName !== 'aria-busy') {\n        currentDocument.removeAttribute(attr.nodeName)\n      }\n    }\n\n    for (const attr of newDocument.attributes) {\n      if (currentDocument.getAttribute(attr.nodeName) !== attr.nodeValue) {\n        currentDocument.setAttribute(attr.nodeName, attr.nodeValue!)\n      }\n    }\n  })\n\n  document.addEventListener('turbo:visit', startSoftNav)\n  document.addEventListener('turbo:render', endSoftNav)\n  document.addEventListener('beforeunload', endSoftNav)\n\n  document.addEventListener('turbo:load', event => {\n    const isHardLoad = Object.keys((event as CustomEvent).detail.timing).length === 0\n    if (!isHardLoad) {\n      softNavSucceeded()\n    } else if (hasSoftNavFailure() || inSoftNavigation()) {\n      softNavFailed()\n    } else {\n      softNavInitial()\n    }\n  })\n}\n","export default function timezone(): string | void {\n  if ('Intl' in window) {\n    try {\n      const format = new window.Intl.DateTimeFormat()\n      return format.resolvedOptions().timeZone\n    } catch {\n      // ignore\n    }\n  }\n}\n","import {setCookie} from '../cookies'\nimport timezone from '../timezone'\n\nwindow.requestIdleCallback(() => {\n  const value = timezone()\n  if (value) {\n    setCookie('tz', encodeURIComponent(value))\n  }\n})\n","import {attr, controller, target, targets} from '@github/catalyst'\nimport {get, supported} from '@github/webauthn-json'\nimport type {CredentialRequestOptionsJSON} from '@github/webauthn-json'\nimport {requestSubmit} from '../form'\n\nenum State {\n  Initializing = 'initializing',\n  Unsupported = 'unsupported',\n  Ready = 'ready',\n  Waiting = 'waiting',\n  Error = 'error',\n  Submitting = 'submitting'\n}\n\n@controller\nexport class WebauthnGetElement extends HTMLElement {\n  state: State = State.Initializing\n  @target button: HTMLButtonElement\n  // `messages` contains all the message elements.\n  @targets messages: HTMLElement[]\n  @target unsupportedMessage: HTMLElement\n  @target waitingMessage: HTMLElement\n  @target errorMessage: HTMLElement\n\n  @attr json = ''\n  // We can't call this `autofocus`, since that's already an `HTMLElement` property.\n  @attr autofocusWhenReady = false\n  @attr autoPrompt = false\n\n  private originalButtonText: string | null\n  private hasErrored = false\n\n  connectedCallback(): void {\n    this.originalButtonText = this.button.textContent\n    this.setState(supported() ? State.Ready : State.Unsupported)\n\n    if (this.autoPrompt) {\n      this.prompt(undefined, true)\n    }\n  }\n\n  setState(state: State): void {\n    // Reset to defaults\n    this.button.textContent = this.hasErrored ? this.button.getAttribute('data-retry-message') : this.originalButtonText\n    this.button.disabled = false\n    this.button.hidden = false\n    for (const elem of this.messages) {\n      elem.hidden = true\n    }\n\n    switch (state) {\n      case State.Initializing:\n        this.button.disabled = true\n        break\n      case State.Unsupported:\n        this.button.disabled = true\n        this.unsupportedMessage.hidden = false\n        break\n      case State.Ready:\n        if (this.autofocusWhenReady) {\n          this.button.focus()\n        }\n        break\n      case State.Waiting:\n        this.waitingMessage.hidden = false\n        this.button.hidden = true\n        break\n      case State.Error:\n        this.errorMessage.hidden = false\n        break\n      case State.Submitting:\n        this.button.textContent = 'Verifying'\n        this.button.disabled = true\n        break\n      default:\n        throw new Error('invalid state')\n    }\n\n    this.state = state\n  }\n\n  // silent_unless_success: don't show waiting or error status. This is for automatically attempting a prompt at\n  // page/modal load time, without showing confusing UI if the browser rejects the attempt due to a missing user\n  // gesture. Most browsers allow at least one such prompt per page load, but we can't rely on it. In theory we could\n  // try to show an error to the user depending on the `get` rejection, but the spec is still in flux and browsers\n  // constantly change their mind (and have bugs). So we err on the side of not showing an error.\n  async prompt(event?: Event, silent_unless_success?: boolean): Promise<void> {\n    event?.preventDefault() // prevent default page form submission\n    this.dispatchEvent(new CustomEvent('webauthn-get-prompt'))\n    try {\n      if (!silent_unless_success) {\n        this.setState(State.Waiting)\n      }\n\n      const json: CredentialRequestOptionsJSON = JSON.parse(this.json)\n      const signResponse = await get(json)\n      this.setState(State.Submitting)\n\n      // Each `<webauthn-get>` element is currently embedded in a form (not\n      // the other way around), so we have to query for for the form outside of it.\n      const form = this.closest<HTMLFormElement>('.js-webauthn-form')!\n      const responseField = form.querySelector<HTMLInputElement>('.js-webauthn-response')!\n      responseField.value = JSON.stringify(signResponse)\n      requestSubmit(form)\n    } catch (error) {\n      if (!silent_unless_success) {\n        this.hasErrored = true\n        this.setState(State.Error)\n        throw error\n      }\n    }\n  }\n}\n\nenum SudoPasswordElementState {\n  Initializing = 'initializing',\n  ShowingForm = 'showing-form',\n  ShowingRevealer = 'showing-revealer'\n}\n\n@controller\nexport class SudoPasswordElement extends HTMLElement {\n  @attr state: SudoPasswordElementState = SudoPasswordElementState.ShowingForm\n\n  @target revealer: HTMLElement\n  @target form: HTMLElement\n  @target passwordField: HTMLInputElement\n\n  // Note: The form is revealed in the DOM by default, because we want to make\n  // sure that the form loads when JS is not working.\n  connectedCallback(): void {\n    // Update the DOM from its default (showing the password for, in case JS\n    // doesn't work) to the initial state.\n    this.setState(this.state)\n  }\n\n  setState(state: SudoPasswordElementState): void {\n    // Reset to defaults\n    this.revealer.hidden = true\n    this.form.hidden = false\n\n    switch (state) {\n      case SudoPasswordElementState.Initializing:\n        break\n      case SudoPasswordElementState.ShowingForm:\n        this.passwordField.focus()\n        this.dispatchEvent(new CustomEvent('sudo-password-showing-form'))\n        break\n      case SudoPasswordElementState.ShowingRevealer:\n        this.revealer.hidden = false\n        this.form.hidden = true\n        break\n      default:\n        throw new Error('invalid state')\n    }\n\n    this.state = state\n  }\n\n  reveal(): void {\n    this.setState(SudoPasswordElementState.ShowingForm)\n  }\n}\n\n@controller\nexport class SudoAuthElement extends HTMLElement {\n  // `<webauthn-get>` is only in the DOM if the user has has a necessary\n  // registration.\n  @target webauthnGet: WebauthnGetElement\n  @target sudoPassword: SudoPasswordElement\n\n  connectedCallback(): void {\n    this.webauthnGet?.addEventListener('webauthn-get-prompt', () => {\n      this.sudoPassword.setState(SudoPasswordElementState.ShowingRevealer)\n    })\n\n    this.sudoPassword.addEventListener('sudo-password-showing-form', () => {\n      this.webauthnGet?.setState(State.Ready)\n    })\n  }\n}\n","import {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {requestSubmit} from '../form'\n\nlet unreadCount = 0\n\nfunction markThreadAsRead() {\n  if (!document.hasFocus()) return\n  const form = document.querySelector('.js-timeline-marker-form')\n  if (form && form instanceof HTMLFormElement) requestSubmit(form)\n}\n\nconst observer =\n  'IntersectionObserver' in window\n    ? new IntersectionObserver(\n        function (entries) {\n          for (const entry of entries) {\n            if (entry.isIntersecting) {\n              clearUnread(entry.target)\n            }\n          }\n        },\n        {\n          root: null,\n          rootMargin: '0px',\n          threshold: 1.0\n        }\n      )\n    : null\n\nobserve('.js-unread-item', {\n  constructor: HTMLElement,\n  add(el) {\n    unreadCount++\n    if (observer) {\n      observer.observe(el)\n    }\n  },\n  remove(el) {\n    unreadCount--\n    if (observer) {\n      observer.unobserve(el)\n    }\n    if (unreadCount === 0) {\n      markThreadAsRead()\n    }\n  }\n})\n\nfunction clearUnread(el: Element) {\n  el.classList.remove('js-unread-item', 'unread-item')\n}\n\n// Mark any unread comments as read if the user has marked the thread as read\n// in another tab or remotely via email notification.\nobserve('.js-discussion[data-channel-target]', {\n  subscribe: el =>\n    fromEvent(el, 'socket:message', function (event: Event) {\n      const target = event.target as Element\n      const data = (event as CustomEvent).detail.data\n      if (target.getAttribute('data-channel-target') === data.gid) {\n        for (const item of document.querySelectorAll('.js-unread-item')) {\n          clearUnread(item)\n        }\n      }\n    })\n})\n","// Unread Item Counter\n//\n// Keeps count of how many unread items are present throughout the page. The\n// count is reflected in the page title automatically.\n//\n// To increase or decrease the page title counter, it's as simple as adding or\n// removing the `.js-unread-item` class from an element. The counter is reset and\n// the page title is cleared when there are no more elements with the\n// `.js-unread-item` class present.\n//\n// Markup\n//\n// ``` html\n// <div class=\"comment js-comment js-unread-item\">\n//   :metal:\n// </div>\n// ```\n//\n\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nlet unreadCounter = 0\nconst titleRe = /^\\(\\d+\\)\\s+/\n\nfunction updateTitle() {\n  const prefix = unreadCounter ? `(${unreadCounter}) ` : ''\n  if (document.title.match(titleRe)) {\n    document.title = document.title.replace(titleRe, prefix)\n  } else {\n    document.title = `${prefix}${document.title}`\n  }\n}\n\nobserve('.js-unread-item', {\n  add() {\n    unreadCounter++\n    updateTitle()\n  },\n  remove() {\n    unreadCounter--\n    updateTitle()\n  }\n})\n","//\n// Updatable Content\n//\n// Markup\n//\n//     <div class=\"js-socket-channel js-updatable-content\"\n//          data-channel=\"pull:123\"\n//          data-url=\"/pull/123?partial=commits\">\n//     </div>\n//\n\nimport {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {updateContent} from '../updatable-content'\n\nobserve('.js-socket-channel.js-updatable-content', {\n  subscribe: el =>\n    fromEvent(el, 'socket:message', function (event: Event) {\n      const {gid, wait} = (event as CustomEvent).detail.data\n      const container = event.target as HTMLElement\n      const target = gid ? findByGid(container, gid) : container\n      if (target) setTimeout(updateContent, wait || 0, target)\n    })\n})\n\nfunction findByGid(root: HTMLElement, gid: string): HTMLElement | null {\n  if (root.getAttribute('data-gid') === gid) return root\n  for (const el of root.querySelectorAll<HTMLElement>(`[data-url][data-gid]`)) {\n    if (el.getAttribute('data-gid') === gid) {\n      return el\n    }\n  }\n  return null\n}\n","import {registerStaleRecords, replaceContent} from '../updatable-content'\nimport {ready} from '../document-ready'\nimport {replaceState} from '../history'\n\nasync function reapplyPreviouslyUpdatedContent() {\n  if (!history.state || !history.state.staleRecords) return\n  await ready\n  for (const url in history.state.staleRecords) {\n    for (const urlTarget of document.querySelectorAll(\n      `.js-updatable-content [data-url='${url}'], .js-updatable-content[data-url='${url}']`\n    )) {\n      const data = history.state.staleRecords[url]\n      if (urlTarget instanceof HTMLElement) replaceContent(urlTarget, data, true)\n    }\n  }\n  replaceState(null, '', location.href)\n}\n\nwindow.addEventListener('pagehide', registerStaleRecords)\n\ntry {\n  reapplyPreviouslyUpdatedContent()\n} catch {\n  // ignore\n}\n","import {dialog} from '../details-dialog'\nimport {fetchSafeDocumentFragment} from '../fetch'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\non('upload:setup', '.js-upload-avatar-image', function (event) {\n  const {form} = event.detail\n  const orgId = event.currentTarget.getAttribute('data-alambic-organization')\n  const ownerType = event.currentTarget.getAttribute('data-alambic-owner-type')\n  const ownerId = event.currentTarget.getAttribute('data-alambic-owner-id')\n  if (orgId) {\n    form.append('organization_id', orgId)\n  }\n  if (ownerType) {\n    form.append('owner_type', ownerType)\n  }\n  if (ownerId) {\n    form.append('owner_id', ownerId)\n  }\n})\n\non('upload:complete', '.js-upload-avatar-image', function (event) {\n  const {attachment} = event.detail\n  const url = `/settings/avatars/${attachment.id}`\n  dialog({content: fetchSafeDocumentFragment(document, url)})\n})\n","// Support linking to named anchors in user content\n//\n// Named elements in user content are prefixed with \"user-content-\" to prevent\n// DOM clobbering. This allows users to link to the unprefixed named anchors by\n// listening for hashchange and, when when no elements with an ID or name of the\n// given hash exist, looks for an element with a prefixed name.\n//\n// See https://github.com/github/github/issues/23103 for more information.\n\nimport {decodeFragmentValue, findElementByFragmentName} from '../fragment-target'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {ready} from '../document-ready'\nimport {scrollIntoView} from '../sticky-scroll-into-view'\n\nfunction hashchange() {\n  if (document.querySelector(':target')) {\n    return\n  }\n  const hash = decodeFragmentValue(location.hash).toLowerCase()\n  const target = findElementByFragmentName(document, `user-content-${hash}`)\n  if (target) {\n    scrollIntoView(target)\n  }\n}\n\n// Scroll to anchor when clicked on page.\nwindow.addEventListener('hashchange', hashchange)\n\n// Scroll to anchor on pjax navigation\ndocument.addEventListener('pjax:success', hashchange)\n\n// Scroll to anchor on page load.\n;(async function () {\n  await ready\n  hashchange()\n})()\n\n// Scroll to anchor when clicking on a link that has the exact same fragment\n// identifier as already present in the URL. This won't trigger `hashchange`,\n// so we need to scroll manually.\non('click', 'a[href]', function (event) {\n  const {currentTarget} = event\n  if (!(currentTarget instanceof HTMLAnchorElement)) return\n\n  if (currentTarget.href === location.href && location.hash.length > 1) {\n    setTimeout(function () {\n      if (!event.defaultPrevented) hashchange()\n    })\n  }\n})\n","import {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nasync function load(event: Event) {\n  const container = event.currentTarget as HTMLElement\n  const {init} = await import('../user-status-submit')\n  init(container)\n}\n\nobserve('.js-user-status-container', {\n  subscribe: el => fromEvent(el, 'click', load, {once: true})\n})\n","// User list dialogs\n//\n// Handle user list creation, deletion, and editing.\n\n// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport type {SimpleResponse} from '@github/remote-form'\nimport {TemplateInstance} from '@github/template-parts'\nimport {dialog} from '../details-dialog'\nimport {hasDirtyFields} from '../has-interactions'\nimport {onInput} from '../onfocus'\nimport {parseHTML} from '../parse-html'\nimport {remoteForm} from '@github/remote-form'\nimport {requestSubmit} from '../form'\nimport {showGlobalError} from './ajax-error'\nimport {updateContent} from '../updatable-content'\nimport {updateSocialCounts} from './social'\n\n// Communicate a generic error, not associated with a specific attribute, to the user. This is used if the\n// server does something unexpected, like returning a 500 error or reporting an unrecognized attribute.\nfunction setFlashError(form: HTMLFormElement, message?: string) {\n  const flash = form.querySelector<HTMLElement>('.js-user-list-base')\n  if (flash) {\n    flash.textContent = message || flash.getAttribute('data-generic-message')\n    flash.hidden = false\n  }\n}\n\n// Clear any validation errors from the form. If a specific formGroup is provided, only clear errors from that\n// group. Otherwise, clear errors from all groups. In either case, flash errors should be cleared as well.\nfunction resetValidation(form: HTMLFormElement, formGroup?: HTMLElement) {\n  const container = formGroup || form\n  const notes = container.querySelectorAll<HTMLElement>('.js-user-list-error')\n  for (const note of notes) {\n    note.hidden = true\n  }\n\n  const groups = formGroup ? [formGroup] : form.querySelectorAll<HTMLElement>('.errored.js-user-list-input-container')\n  for (const group of groups) {\n    group.classList.remove('errored')\n  }\n\n  const flash = form.querySelector<HTMLElement>('.js-user-list-base')\n  if (flash) {\n    flash.hidden = true\n  }\n}\n\n// Wire up remote form submission. Clear preexisting validation errors from the form, submit it with XHR, and interpret\n// the server's response. On success, reload the page. On failure, attempt to interpret the response as validation\n// errors and display them next to the appropriate inputs.\nremoteForm('.js-user-list-form', async function (form, wants) {\n  resetValidation(form)\n\n  const submitButton = form.querySelector<HTMLButtonElement>('[data-submitting-message]')\n  const originalButtonText = submitButton?.textContent\n  if (submitButton) {\n    // We can't use data-disable-with here because the button is re-enabled immediately after the response is received,\n    // but before we have a chance to handle it and redirect or swap out the form contents. This results in a\n    // disorienting jitter.\n    submitButton.textContent = submitButton.getAttribute('data-submitting-message')\n    submitButton.disabled = true\n  }\n\n  for (const input of form.querySelectorAll<HTMLInputElement>('.js-user-list-input')) {\n    input.disabled = true\n  }\n\n  try {\n    const response = await wants.html()\n\n    // Let a containing element determine how to handle the response.\n    fire(form, 'user-list-form:success', response.html)\n  } catch (error) {\n    if (error.response?.status === 422) {\n      form.replaceWith(error.response.html)\n    } else {\n      setFlashError(form)\n\n      if (submitButton) {\n        if (originalButtonText) submitButton.textContent = originalButtonText\n        submitButton.disabled = false\n      }\n\n      for (const input of form.querySelectorAll<HTMLInputElement>('.js-user-list-input')) {\n        input.disabled = false\n      }\n    }\n  }\n})\n\non('user-list-form:success', '.js-follow-list', event => {\n  const responseBody = event.detail\n  const targetUrl =\n    responseBody instanceof DocumentFragment ? responseBody.querySelector<HTMLElement>('.js-target-url') : null\n  if (targetUrl?.textContent) {\n    location.href = targetUrl.textContent\n  } else {\n    location.reload()\n  }\n})\n\n// Dismiss a validation error from a form input when you start changing it.\nfunction clearErrorsFromInput(event: Event) {\n  if (!(event.currentTarget instanceof HTMLElement)) {\n    return\n  }\n\n  const form = event.currentTarget.closest<HTMLFormElement>('.js-user-list-form')\n  const formGroup = event.currentTarget.closest<HTMLElement>('.js-user-list-input-container')\n  if (form && formGroup) {\n    resetValidation(form, formGroup)\n  }\n}\n\nonInput('.js-user-list-form input', clearErrorsFromInput)\nonInput('.js-user-list-form textarea', clearErrorsFromInput)\n\n// Unhide the .note element containing the validation error reported by <auto-check> when there's an error to show.\non('auto-check-error', '.js-user-list-form input', function (event) {\n  const formGroup = event.currentTarget.closest<HTMLElement>('.js-user-list-input-container')\n  const note = formGroup?.querySelector<HTMLElement>('.js-user-list-error')\n  if (note) {\n    note.hidden = false\n  }\n})\n\n// Star button UserList menu\n\n// Given a collection of UserList menu root elements, construct a map grouping them by the repository ID each\n// corresponds to.\nfunction groupRootsByRepositoryId(roots: Iterable<HTMLElement>): Map<string, HTMLElement[]> {\n  const rootsByRepositoryId = new Map<string, HTMLElement[]>()\n  for (const root of roots) {\n    const repositoryId = root\n      .querySelector<HTMLInputElement>('.js-user-lists-create-trigger')\n      ?.getAttribute('data-repository-id')\n    if (repositoryId) {\n      const existingRoots = rootsByRepositoryId.get(repositoryId)\n      if (existingRoots) {\n        existingRoots.push(root)\n      } else {\n        rootsByRepositoryId.set(repositoryId, [root])\n      }\n    }\n  }\n  return rootsByRepositoryId\n}\n\n// Perform a POST request to the batch-render endpoint to render a collection of UserList menus corresponding to the\n// repositories. Asynchronously returns a Map<repository ID> => rendered HTML generated for that repository.\n//\n// Rejects its promise on network errors, but returns an empty map on server errors.\nasync function requestMenuBatchRender(\n  batchUpdateUrl: string,\n  csrfToken: string,\n  repositoryIds: Iterable<string>\n): Promise<Map<string, DocumentFragment>> {\n  const postData = new FormData()\n\n  // eslint-disable-next-line github/authenticity-token\n  postData.set('authenticity_token', csrfToken)\n  for (const repositoryId of repositoryIds) {\n    postData.append('repository_ids[]', repositoryId)\n  }\n\n  const response = await fetch(batchUpdateUrl, {\n    method: 'POST',\n    body: postData,\n    headers: {\n      Accept: 'application/json',\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n\n  const updatedMenuContents = new Map<string, DocumentFragment>()\n  if (response.ok) {\n    const json = await response.json()\n    for (const key in json) {\n      updatedMenuContents.set(key, parseHTML(document, json[key]))\n    }\n  }\n  return updatedMenuContents\n}\n\n// Replace the contents of UserList menus in the DOM with the updated, rendered HTML generated for each by the batch\n// render endpoint.\nfunction replaceUserListMenuRoots(\n  renderedMenuContents: Map<string, DocumentFragment>,\n  rootsByRepositoryId: Map<string, HTMLElement[]>\n) {\n  for (const [repositoryId, updatedMenu] of renderedMenuContents.entries()) {\n    const matchingRoots = rootsByRepositoryId.get(repositoryId) || []\n    for (const root of matchingRoots) {\n      root.replaceWith(matchingRoots.length === 1 ? updatedMenu : updatedMenu.cloneNode(true))\n    }\n  }\n}\n\n// Perform a single request to replace all UserList menus currently present in the DOM with updated versions from the\n// server.\n//\n// Expects a response in form of:\n//\n// {\n//   \"<repo id 0>\": \"<div> <!-- markup for menu for repo 0 --></div>\",\n//   \"<repo id 1>\": \"<div> <!-- markup for menu for repo 1 --></div>\",\n//   \"<repo id 2>\": \"<div> <!-- markup for menu for repo 2 --></div>\"\n// }\nasync function updateAllUserListMenus() {\n  const roots = document.querySelectorAll<HTMLElement>('.js-user-list-menu-content-root')\n  if (roots.length === 0) return\n\n  const batchUpdateUrl = roots[0].getAttribute('data-batch-update-url')\n  if (!batchUpdateUrl) return\n\n  const csrfToken = roots[0].querySelector<HTMLInputElement>('.js-user-list-batch-update-csrf')?.value\n  if (!csrfToken) return\n\n  const rootsByRepositoryId = groupRootsByRepositoryId(roots)\n  const repositoryIds = rootsByRepositoryId.keys()\n  const renderedMenuContents = await requestMenuBatchRender(batchUpdateUrl, csrfToken, repositoryIds)\n  if (renderedMenuContents.size > 0) {\n    replaceUserListMenuRoots(renderedMenuContents, rootsByRepositoryId)\n  }\n}\n\nfunction requestUserListMenuFormSubmit(form: HTMLFormElement) {\n  const promise = new Promise<void>((resolve, reject) => {\n    form.addEventListener('user-list-menu-form:success', () => resolve())\n    form.addEventListener('user-list-menu-form:error', error => reject(error))\n  })\n  requestSubmit(form)\n  return promise\n}\n\nfunction submitUserListFormOnToggle(event: Event) {\n  const detailsElement = event.target\n  if (!(detailsElement instanceof HTMLDetailsElement)) return\n  if (detailsElement.hasAttribute('open')) return\n\n  const form = detailsElement.querySelector<HTMLFormElement>('.js-user-list-menu-form')\n  if (form && hasDirtyFields(form)) requestSubmit(form)\n\n  const triggerText = detailsElement.querySelector('.js-user-list-create-trigger-text')\n  if (triggerText) triggerText.textContent = ''\n}\n\non('toggle', '.js-user-list-menu', submitUserListFormOnToggle, {capture: true})\n\nonInput('.js-user-lists-menu-filter', (event: Event) => {\n  const target = event.currentTarget as HTMLInputElement\n  const value = target.value.trim()\n  const root = target.closest('.js-user-list-menu-content-root')\n  const triggerText = root?.querySelector('.js-user-list-create-trigger-text')\n\n  if (!triggerText) return\n  triggerText.textContent = value ? `\"${value}\"` : ''\n})\n\nremoteForm('.js-user-list-menu-form', async function (form, wants) {\n  let response: SimpleResponse\n  try {\n    response = await wants.json()\n  } catch (error) {\n    showGlobalError()\n    fire(form, 'user-list-menu-form:error', error)\n    return\n  }\n\n  // Update the star button state and counts if necessary.\n  // We only update the star count if the repo was just starred. Otherwise the count could jump every time you dismiss\n  // the menu, which would be jarring.\n  if (response.json.didStar) {\n    const togglerContainer = form.closest<HTMLElement>('.js-toggler-container')\n    if (togglerContainer) togglerContainer.classList.add('on')\n\n    const starCount = response.json.starCount\n    if (starCount) {\n      const socialContainer = form.closest<HTMLElement>('.js-social-container')\n      if (socialContainer) updateSocialCounts(socialContainer, starCount)\n    }\n  }\n\n  const menuContentRoot = form.closest<HTMLElement>('.js-user-list-menu-content-root[data-update-after-submit]')\n  if (menuContentRoot) {\n    // Reset checkbox state before potentially calling updateContent() to avoid the checkboxes being detected as \"dirty\"\n    // and terminating the update. They'll be checked in the updated content, assuming the repo was in fact added\n    // successfully.\n    for (const input of form.querySelectorAll<HTMLInputElement>('.js-user-list-menu-item')) {\n      input.checked = input.defaultChecked\n    }\n  }\n\n  if (response.json.didCreate) {\n    // There's a new UserList to include in the menus now. Let's batch-update them all.\n    await updateAllUserListMenus()\n  } else if (menuContentRoot) {\n    // Otherwise, only update our local menu.\n    await updateContent(menuContentRoot)\n  }\n\n  fire(form, 'user-list-menu-form:success')\n})\n\n// Delete dialog\n\non('click', '.js-user-list-delete-confirmation-trigger', event => {\n  const {currentTarget} = event\n  const templateID = currentTarget.getAttribute('data-template-id')\n  if (!templateID) return\n\n  const template = document.getElementById(templateID)\n  if (!template || !(template instanceof HTMLTemplateElement)) return\n\n  const editDialog = currentTarget.closest<HTMLDetailsElement>('.js-edit-user-list-dialog')\n  if (editDialog) {\n    editDialog.open = false\n  }\n  const content = template.content.cloneNode(true)\n  const labelledBy = template.getAttribute('data-labelledby')!\n\n  dialog({content, labelledBy})\n})\n\n// Create dialog\n\non('click', '.js-user-lists-create-trigger', async function (event) {\n  const {currentTarget} = event\n  const template = document.querySelector<HTMLTemplateElement>('.js-user-list-create-dialog-template')\n  const repositoryId = event.currentTarget.getAttribute('data-repository-id')\n  const userListMenuRoot = currentTarget.closest<HTMLElement>('.js-user-list-menu-content-root')\n  const filter = userListMenuRoot?.querySelector<HTMLInputElement>('.js-user-lists-menu-filter')\n  const placeholderName = filter?.value.trim()\n\n  if (!template || !(template instanceof HTMLTemplateElement) || !repositoryId) {\n    // No template rendered on the page, or malformed button markup.\n    // Disable the button as something marginally better than silently doing nothing.\n    if (currentTarget instanceof HTMLButtonElement) {\n      currentTarget.disabled = true\n    }\n    return\n  }\n\n  const label = template.getAttribute('data-label')!\n\n  // Submit the form first if there are any dirty fields.\n  if (userListMenuRoot && hasDirtyFields(userListMenuRoot)) {\n    const userListMenuForm = userListMenuRoot.querySelector<HTMLFormElement>('.js-user-list-menu-form')\n    if (userListMenuForm) await requestUserListMenuFormSubmit(userListMenuForm)\n  }\n\n  const content = new TemplateInstance(template, {repositoryId, placeholderName})\n  const dialogElement = await dialog({content, label})\n\n  dialogElement.addEventListener('user-list-form:success', async () => {\n    // Update all currently loaded user list menu contents to include the created list.\n    await updateAllUserListMenus()\n\n    // Then, dismiss the dialog.\n    const detailsElement = dialogElement.closest<HTMLDetailsElement>('details')\n    if (detailsElement) detailsElement.open = false\n  })\n})\n","import {controller, target} from '@github/catalyst'\n\n@controller\nclass VisiblePasswordElement extends HTMLElement {\n  @target input: HTMLInputElement\n  @target showButton: HTMLElement\n  @target hideButton: HTMLElement\n\n  show() {\n    this.input.type = 'text'\n    this.input.focus()\n    this.showButton.hidden = true\n    this.hideButton.hidden = false\n  }\n\n  hide() {\n    this.input.type = 'password'\n    this.input.focus()\n    this.hideButton.hidden = true\n    this.showButton.hidden = false\n  }\n}\n","import {hasDirtyFields} from '../has-interactions'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Add the 'data-warn-unsaved-changes' attribute to any form/container element\n// and it will be monitored for changes. If the user attempts to\n// navigate away from the page without first saving their changes, an alert\n// will warn them.\nobserve('[data-warn-unsaved-changes]', {\n  add(container) {\n    container.addEventListener('input', prepareUnsavedChangesWarning)\n    container.addEventListener('change', prepareUnsavedChangesWarning)\n    container.addEventListener('submit', disableSaveChangesReminder)\n\n    const dialog = container.closest('details-dialog')\n    if (dialog) {\n      dialog.closest<HTMLElement>('details')!.addEventListener('toggle', disableSaveChangesReminderOnClosedDialogs)\n      dialog.addEventListener('details-dialog-close', promptOnDialogClosing)\n    }\n  },\n  remove(container) {\n    container.removeEventListener('input', prepareUnsavedChangesWarning)\n    container.removeEventListener('change', prepareUnsavedChangesWarning)\n    container.removeEventListener('submit', disableSaveChangesReminder)\n\n    const dialog = container.closest('details-dialog')\n    if (dialog) {\n      dialog.closest<HTMLElement>('details')!.removeEventListener('toggle', disableSaveChangesReminderOnClosedDialogs)\n      dialog.removeEventListener('details-dialog-close', promptOnDialogClosing)\n      disableSaveChangesReminder()\n    }\n  }\n})\n\nfunction prepareUnsavedChangesWarning(event: Event) {\n  const currentTarget = event.currentTarget as Element\n\n  if (hasDirtyFields(currentTarget)) {\n    enableSaveChangesReminder(currentTarget)\n  } else {\n    disableSaveChangesReminder()\n  }\n}\n\nfunction enableSaveChangesReminder(container: Element) {\n  // This message is ignored by most browsers.\n  // eslint-disable-next-line i18n-text/no-en\n  const message = container.getAttribute('data-warn-unsaved-changes') || 'Changes you made may not be saved.'\n\n  window.onbeforeunload = function (event: BeforeUnloadEvent): string {\n    event.returnValue = message\n    return message\n  }\n}\n\nfunction disableSaveChangesReminder() {\n  window.onbeforeunload = null\n}\n\nfunction disableSaveChangesReminderOnClosedDialogs({currentTarget}: Event) {\n  if (!(currentTarget as Element).hasAttribute('open')) {\n    disableSaveChangesReminder()\n  }\n}\n\nfunction promptOnDialogClosing(event: Event) {\n  const dialog = event.currentTarget as Element\n  const details = dialog.closest('details[open]')\n  if (!details) {\n    return\n  }\n\n  let confirmed = true\n  const confirmationForms = dialog.querySelectorAll<HTMLFormElement>('form[data-warn-unsaved-changes]')\n  for (const form of confirmationForms) {\n    if (hasDirtyFields(form)) {\n      const message = form.getAttribute('data-warn-unsaved-changes')!\n      confirmed = confirm(message)\n      break\n    }\n  }\n\n  if (!confirmed) {\n    event.preventDefault()\n  }\n}\n","// Perform CSS transition once\n//\n// Examples\n//\n//   .foo.will-transition-once {\n//     transition: color ...;\n//   }\n//\n//   .foo.is-successful {\n//     background: green;\n//   }\n//\n\nimport {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nobserve('.will-transition-once', {\n  constructor: HTMLElement,\n  subscribe: el => fromEvent(el, 'transitionend', onTransitionEnd)\n})\n\nfunction onTransitionEnd(event: Event) {\n  const target = event.target as Element\n  target.classList.remove('will-transition-once')\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Like scrollIntoView() but better because:\n// 1. It doesn't change scroll position if element already fits into viewport.\n// 2. It supports the option padding value.\nfunction adjustViewport(element: HTMLElement, padding = 0) {\n  const position = element.getBoundingClientRect()\n  const scrollAdjustUp = position.top - padding\n  const scrollAdjustDown = position.bottom - window.innerHeight + padding\n\n  if (scrollAdjustUp < 0) {\n    window.scrollBy(0, scrollAdjustUp)\n  } else if (scrollAdjustDown > 0) {\n    window.scrollBy(0, scrollAdjustDown)\n  }\n}\n\non('click', '.js-video-play, .js-video-close', function (event) {\n  const playTarget = event.currentTarget\n  const container = playTarget.closest<HTMLElement>('.js-video-container')!\n  const iframe = container.querySelector<HTMLIFrameElement>('.js-video-iframe')!\n\n  if (container.tagName.toLowerCase() === 'details') {\n    container.addEventListener('details-dialog-close', function () {\n      iframe.removeAttribute('src')\n\n      window.setTimeout(function () {\n        container.classList.remove('is-expanded')\n      }, 10)\n    })\n  }\n\n  if (!container.classList.contains('is-expanded')) {\n    iframe.src = iframe.getAttribute('data-src') || ''\n    container.classList.add('is-expanded')\n  } else {\n    iframe.removeAttribute('src')\n    container.classList.remove('is-expanded')\n  }\n\n  adjustViewport(iframe, 20)\n})\n","import {fromEvent} from '../subscription'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\n// Load issue/PR/discussion references to display the title for the tooltip from the server on hover.\n// If hovercards are enabled for the referenced type on this part of the DOM,\n// this behavior is bypassed in favor of the hovercard.\nasync function issueLabel(event: Event) {\n  const currentTarget = event.currentTarget as HTMLElement\n  const url = currentTarget.getAttribute('data-url')\n  if (!url || isHovercardEnabled(currentTarget)) {\n    return\n  }\n\n  const id = currentTarget.getAttribute('data-id') || ''\n  const text = currentTarget.textContent\n  const elements = document.querySelectorAll(`.js-issue-link[data-id='${id}']`)\n\n  for (const el of elements) {\n    el.removeAttribute('data-url')\n  }\n\n  try {\n    const titleUrl = `${url}/title`\n    const response = await fetch(titleUrl, {\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest',\n        Accept: 'application/json'\n      }\n    })\n    if (!response.ok) {\n      const responseError = new Error()\n      const statusText = response.statusText ? ` ${response.statusText}` : ''\n      responseError.message = `HTTP ${response.status}${statusText}`\n      throw responseError\n    }\n    const data = await response.json()\n    setLabel(elements, `${text}, ${data.title}`)\n  } catch (error) {\n    const status = (error.response != null ? error.response.status : undefined) || 500\n\n    const message = (() => {\n      switch (status) {\n        case 404:\n          return currentTarget.getAttribute('data-permission-text')\n        default:\n          return currentTarget.getAttribute('data-error-text')\n      }\n    })()\n\n    setLabel(elements, message || '')\n  }\n}\n\nfunction setLabel(elements: NodeList, text: string) {\n  for (const el of elements) {\n    if (!(el instanceof HTMLElement)) continue\n    el.classList.add('tooltipped', 'tooltipped-ne')\n    el.setAttribute('aria-label', text)\n  }\n}\n\nfunction isHovercardEnabled(element: HTMLElement): boolean {\n  const hovercardType = element.getAttribute('data-hovercard-type')\n  switch (hovercardType) {\n    case 'issue':\n    case 'pull_request':\n      return !!element.closest('[data-issue-and-pr-hovercards-enabled]')\n    case 'discussion':\n      return !!element.closest('[data-discussion-hovercards-enabled]')\n    default:\n      return false\n  }\n}\n\nobserve('.js-issue-link', {\n  subscribe: el => fromEvent(el, 'mouseenter', issueLabel)\n})\n","// eslint-disable-next-line no-restricted-imports\nimport {fire, on} from 'delegated-events'\nimport {onFocus, onInput, onKey} from '../onfocus'\nimport {resetCharactersRemainingCounts, updateInputRemainingCharacters} from '../behaviors/characters-remaining'\nimport {RGB} from 'color-convert/conversions'\nimport {changeValue} from '../form'\nimport convert from 'color-convert'\nimport {debounce} from '@github/mini-throttle'\nimport {dialog} from '../details-dialog'\nimport {fetchSafeDocumentFragment} from '../fetch'\nimport {getUtf8StringLength} from '../text'\nimport {remoteForm} from '@github/remote-form'\nimport {toggleDetailsTarget} from '../behaviors/details'\n\nfunction randomRGBColor(): RGB {\n  return [\n    Math.floor(Math.random() * (255 - 0) + 0),\n    Math.floor(Math.random() * (255 - 0) + 0),\n    Math.floor(Math.random() * (255 - 0) + 0)\n  ]\n}\n\n// Given a button element and a hex color code, this will style the button and\n// the octicon within it based on the given color.\nfunction setColorSwatch(colorButton: HTMLButtonElement, rgb: RGB) {\n  const hsl = convert.rgb.hsl(rgb)\n  colorButton.style.setProperty('--label-r', rgb[0].toString())\n  colorButton.style.setProperty('--label-g', rgb[1].toString())\n  colorButton.style.setProperty('--label-b', rgb[2].toString())\n\n  colorButton.style.setProperty('--label-h', hsl[0].toString())\n  colorButton.style.setProperty('--label-s', hsl[1].toString())\n  colorButton.style.setProperty('--label-l', hsl[2].toString())\n}\n\n// Fill the color input field in the 'new label' modal when a button is clicked.\n// Sets the color of the button that acts as the preview of the chosen color.\nfunction setInputColorFromButton(clickedButton: HTMLButtonElement, rgb: RGB) {\n  // eslint-disable-next-line github/no-blur\n  clickedButton.blur()\n\n  const container = clickedButton.closest<HTMLElement>('form')!\n\n  const colorInput = container.querySelector<HTMLInputElement>('.js-new-label-color-input')!\n  changeValue(colorInput, `#${convert.rgb.hex(rgb)}`)\n\n  const colorButton = container.querySelector<HTMLButtonElement>('.js-new-label-color')!\n  setColorSwatch(colorButton, rgb)\n}\n\nfunction addErrorToField(errorEl: HTMLElement, errorMessage: string) {\n  const container = errorEl.closest<HTMLElement>('.js-label-error-container')!\n  container.classList.add('errored')\n  errorEl.textContent = errorMessage\n  errorEl.hidden = false\n}\n\nfunction removeErrorFromField(errorEl: HTMLElement) {\n  const container = errorEl.closest<HTMLElement>('.js-label-error-container')!\n  container.classList.remove('errored')\n  errorEl.hidden = true\n}\n\nfunction showOrHideLabelError(errorSelector: string, form: HTMLFormElement, errorMessages?: string[] | null) {\n  const errorEl = form.querySelector<HTMLElement>(errorSelector)\n  if (!errorEl) {\n    return\n  }\n\n  if (errorMessages) {\n    addErrorToField(errorEl, errorMessages[0])\n  } else {\n    removeErrorFromField(errorEl)\n  }\n}\n\ninterface labelError {\n  name?: string[]\n  description?: string[]\n  color?: string[]\n}\n\nfunction showLabelErrors(form: HTMLFormElement, json: labelError) {\n  showOrHideLabelError('.js-label-name-error', form, json.name)\n  showOrHideLabelError('.js-label-description-error', form, json.description)\n  showOrHideLabelError('.js-label-color-error', form, json.color)\n}\n\nfunction hideLabelErrors(form: HTMLFormElement) {\n  showOrHideLabelError('.js-label-name-error', form, null)\n  showOrHideLabelError('.js-label-description-error', form, null)\n  showOrHideLabelError('.js-label-color-error', form, null)\n}\n\nfunction labelPreviewUrl(\n  baseUrl: string,\n  name: string,\n  color: string,\n  description: string | null,\n  labelID: string | null\n): string {\n  const url = new URL(`${baseUrl}${encodeURIComponent(name)}`, window.location.origin)\n  const params = new URLSearchParams(url.search.slice(1))\n  params.append('color', color)\n  if (description) {\n    params.append('description', description)\n  }\n  if (labelID) {\n    params.append('id', labelID)\n  }\n  url.search = params.toString()\n  return url.toString()\n}\n\nfunction labelDescriptionFrom(form: HTMLFormElement): string | null {\n  let description = null\n  const descriptionInput = form.querySelector('.js-new-label-description-input')\n  if (descriptionInput instanceof HTMLInputElement && descriptionInput.value.trim().length > 0) {\n    description = descriptionInput.value.trim()\n  }\n  return description\n}\n\nfunction labelColorFrom(form: HTMLFormElement): string {\n  const colorInput = form.querySelector<HTMLInputElement>('.js-new-label-color-input')!\n  if (colorInput.checkValidity()) {\n    return colorInput.value.trim().replace(/^#/, '')\n  }\n  return 'ededed'\n}\n\nfunction labelNameFrom(form: HTMLFormElement, previewArea: HTMLElement): string {\n  const nameInput = form.querySelector<HTMLInputElement>('.js-new-label-name-input')!\n  let name = nameInput.value.trim()\n  if (name.length < 1) {\n    name = previewArea.getAttribute('data-default-name')!\n  }\n  return name\n}\n\nasync function updateLabelPreview(startEl: HTMLElement) {\n  const previewContainer = startEl.closest('.js-label-preview-container')\n  if (!previewContainer) {\n    return\n  }\n\n  const form = startEl.closest<HTMLFormElement>('.js-label-form')!\n  const fullErrorMessageEl = form.querySelector<HTMLElement>('.js-new-label-error')\n  const labelID = form.getAttribute('data-label-id')\n  const previewArea = previewContainer.querySelector<HTMLElement>('.js-label-preview')!\n  const name = labelNameFrom(form, previewArea)\n\n  // Default case of \"Label preview\" is also counted as 'invalid' but we still want to update the preview.\n  if (!form.checkValidity() && name !== 'Label preview') {\n    return\n  }\n\n  const color = labelColorFrom(form)\n  const description = labelDescriptionFrom(form)\n\n  const urlTemplate = previewArea.getAttribute('data-url-template')!\n  const url = labelPreviewUrl(urlTemplate, name, color, description, labelID)\n\n  if (previewContainer.hasAttribute('data-last-preview-url')) {\n    const lastPreviewUrl = previewContainer.getAttribute('data-last-preview-url')!\n    if (url === lastPreviewUrl) {\n      return\n    }\n  }\n\n  let fragment\n  try {\n    fragment = await fetchSafeDocumentFragment(document, url)\n  } catch (error) {\n    const json = await error.response.json()\n    showLabelErrors(form, json)\n\n    if (fullErrorMessageEl) {\n      fullErrorMessageEl.textContent = json.message\n      fullErrorMessageEl.hidden = false\n    }\n\n    return\n  }\n\n  if (fullErrorMessageEl) {\n    fullErrorMessageEl.textContent = ''\n    fullErrorMessageEl.hidden = true\n  }\n\n  hideLabelErrors(form)\n\n  previewArea.innerHTML = ''\n  previewArea.appendChild(fragment)\n  previewContainer.setAttribute('data-last-preview-url', url)\n}\n\nfunction onLabelFormInputChange(event: Event) {\n  updateLabelPreview(event.target as HTMLInputElement)\n}\n\nfunction toggleBlankSlate(el: Element, show: boolean) {\n  const detailsContainer = el.closest<HTMLElement>('.js-details-container')!\n  detailsContainer.classList.toggle('is-empty', show)\n}\n\nfunction updateCount(delta: number) {\n  const counter = document.querySelector<HTMLElement>('.js-labels-count')!\n  const oldCount = Number(counter.textContent!)\n  const newCount = oldCount + delta\n  counter.textContent = newCount.toString()\n\n  const label = document.querySelector<HTMLElement>('.js-labels-label')!\n  label.textContent = label.getAttribute(newCount === 1 ? 'data-singular-string' : 'data-plural-string')\n  return newCount\n}\n\n// Update the preview text of the new label based on what the user types in the\n// label filter input.\nonInput('.js-label-filter-field', function (event) {\n  const filterInput = event.target as HTMLInputElement\n  const container = filterInput.closest<HTMLElement>('details-menu')!\n  const labelNameEl = container.querySelector('.js-new-label-name')\n  if (!labelNameEl) {\n    return\n  }\n  const labelName = filterInput.value.trim()\n  labelNameEl.textContent = labelName\n})\n\n// As the user filters existing labels, make sure the 'Add new label' and 'Edit labels'\n// links are visible as appropriate.\non('filterable:change', '.js-filterable-issue-labels', function (event) {\n  const menu = event.currentTarget.closest<HTMLElement>('details-menu')!\n  const addLabelButton = menu.querySelector<HTMLElement>('.js-add-label-button')\n  if (!addLabelButton) return\n\n  const filterInput = event.detail.inputField\n  const newLabelName = filterInput.value.trim().toLowerCase()\n\n  // TODO This could use namedItems.\n  let matchingExistingLabel = false\n  for (const input of menu.querySelectorAll('input[data-label-name]')) {\n    const labelName = input.getAttribute('data-label-name') || ''\n    if (labelName.toLowerCase() === newLabelName) {\n      matchingExistingLabel = true\n      break\n    }\n  }\n\n  addLabelButton.hidden = newLabelName.length === 0 || matchingExistingLabel\n})\n\n// Show the color swatches when the user focuses the color input field.\nonFocus('.js-new-label-color-input', function (input) {\n  const container = input.closest<HTMLElement>('form')!\n  const swatchesContainer = container.querySelector<HTMLElement>('.js-new-label-swatches')!\n  swatchesContainer.hidden = false\n\n  input.addEventListener(\n    'blur',\n    function () {\n      swatchesContainer.hidden = true\n    },\n    {once: true}\n  )\n})\n\n// Update the color swatch as the user types new hex color codes manually into\n// the input.\nonInput('.js-new-label-color-input', function (event) {\n  const input = event.target as HTMLInputElement\n  let color = input.value.trim()\n  if (color.length < 1) {\n    return\n  }\n\n  if (color.indexOf('#') !== 0) {\n    color = `#${color}`\n    input.value = color\n  }\n\n  if (input.checkValidity()) {\n    input.classList.remove('color-fg-danger')\n    const container = input.closest<HTMLElement>('form')!\n    const colorButton = container.querySelector<HTMLButtonElement>('.js-new-label-color')!\n    setColorSwatch(colorButton, convert.hex.rgb(color))\n  } else {\n    input.classList.add('color-fg-danger')\n  }\n})\n\n// Disable save button as the user types if they enter an invalid hex color code.\nonKey('keyup', '.js-new-label-color-input', function (event) {\n  const input = event.target as HTMLInputElement\n  let color = input.value.trim()\n\n  if (color.indexOf('#') !== 0) {\n    color = `#${color}`\n    input.value = color\n  }\n\n  if (input.checkValidity()) {\n    const container = input.closest<HTMLElement>('form')!\n    const colorButton = container.querySelector<HTMLButtonElement>('.js-new-label-color')!\n    setColorSwatch(colorButton, convert.hex.rgb(color))\n  }\n  fire(input, 'change', false)\n\n  const form = input.closest<HTMLFormElement>('form')!\n  hideLabelErrors(form)\n})\n\nonKey('keyup', '.js-new-label-description-input', function (event) {\n  const input = event.target as HTMLInputElement\n  const form = input.form!\n  hideLabelErrors(form)\n})\n\nonKey('keyup', '.js-new-label-color-input', function (event) {\n  const input = event.target as HTMLInputElement\n  const form = input.form!\n  hideLabelErrors(form)\n})\n\n// Get a random color for the new label when the user hits the button that acts as\n// a preview of the selected color.\non('click', '.js-new-label-color', async function (event) {\n  const colorButton = event.currentTarget as HTMLButtonElement\n  const rgb = randomRGBColor()\n  setInputColorFromButton(colorButton, rgb)\n  updateLabelPreview(colorButton)\n})\n\n// Choose one of the predefined colors when it's clicked.\non('mousedown', '.js-new-label-color-swatch', function (event) {\n  const swatchButton = event.currentTarget as HTMLButtonElement\n  const color = swatchButton.getAttribute('data-color')!\n  setInputColorFromButton(swatchButton, convert.hex.rgb(color))\n  updateLabelPreview(swatchButton)\n\n  const swatchesContainer = swatchButton.closest<HTMLElement>('.js-new-label-swatches')!\n  swatchesContainer.hidden = true\n})\n\non(\n  'toggle',\n  '.js-new-label-modal',\n  function (event) {\n    if ((event.target as Element).hasAttribute('open')) {\n      initLabelModal(event.target as Element)\n    }\n  },\n  {capture: true}\n)\n\n// When the new label form is displayed in the modal, set the label and its color\n// in the form fields. Also update the color of the color swatch.\nasync function initLabelModal(modal: Element) {\n  const labelNameInput = modal.querySelector<HTMLInputElement>('.js-new-label-name-input')\n  if (!labelNameInput) return\n\n  const colorInput = modal.querySelector<HTMLInputElement>('.js-new-label-color-input')!\n  const rgb = randomRGBColor()\n  const hex = `#${convert.rgb.hex(rgb)}`\n  colorInput.value = hex\n  const colorButton = modal.querySelector<HTMLButtonElement>('.js-new-label-color')!\n  setColorSwatch(colorButton, rgb)\n\n  const labelNameEl = document.querySelector<HTMLElement>('.js-new-label-name')!\n  const labelName = labelNameEl.textContent!\n  changeValue(labelNameInput, labelName)\n  updateInputRemainingCharacters(labelNameInput)\n\n  updateLabelPreview(colorButton)\n}\n\n// When the user creates a new label, close the modal containing the 'new label'\n// form. Also update the list of available labels to choose from, so the user\n// can immediately apply their new label.\nremoteForm('.js-new-label-modal-form', async function (form, wants) {\n  const errorEl = form.querySelector<HTMLElement>('.js-new-label-error')!\n\n  let response\n  try {\n    response = await wants.html()\n  } catch (error) {\n    const json = error.response.json\n    errorEl.textContent = json.message\n    errorEl.hidden = false\n  }\n\n  if (!response) {\n    return\n  }\n\n  errorEl.hidden = true // Hide error message for the form\n\n  // close modal containing the label form\n  document.querySelector<HTMLElement>('.js-new-label-modal')!.removeAttribute('open')\n\n  const list = document.querySelector<HTMLElement>('.js-filterable-issue-labels')!\n  const input = response.html.querySelector('input')\n  list.prepend(response.html)\n  // A selected menu item is inserted programmatically so we need to trigger a\n  // change event, which when trigger a details-menu-selected event.\n  if (input) input.dispatchEvent(new Event('change', {bubbles: true}))\n\n  const field = document.querySelector<HTMLInputElement>('.js-label-filter-field')!\n  field.value = field.defaultValue\n  field.focus()\n})\n\n// New and Edit remote form\n// Click \"Cancel\" leaves \"edit mode\"\non('click', '.js-edit-label-cancel', function (event) {\n  const form = (event.target as Element).closest<HTMLFormElement>('form')!\n  hideLabelErrors(form)\n  form.reset()\n\n  // Grab the color we just resetted to and set the background color of the\n  // refresh button to that color since resetting the form doesn't do that for us\n  const colorInput = form.querySelector<HTMLInputElement>('.js-new-label-color-input')!\n  const color = colorInput.value\n  const refreshButton = form.querySelector<HTMLButtonElement>('.js-new-label-color')!\n  setColorSwatch(refreshButton, convert.hex.rgb(color))\n\n  resetCharactersRemainingCounts(form)\n  updateLabelPreview(colorInput)\n\n  // If editing an existing label, hide the form on Cancel:\n  const item = event.currentTarget.closest('.js-labels-list-item')\n  if (item) {\n    const editForm = item.querySelector<HTMLElement>('.js-update-label')!\n    /* eslint-disable-next-line github/no-d-none */\n    editForm.classList.add('d-none')\n\n    const labelPreview = item.querySelector('.js-label-preview')\n    if (labelPreview) {\n      /* eslint-disable-next-line github/no-d-none */\n      labelPreview.classList.add('d-none')\n\n      const labelLink = item.querySelector<HTMLElement>('.js-label-link')!\n      /* eslint-disable-next-line github/no-d-none */\n      labelLink.classList.remove('d-none')\n    }\n\n    const elementsToShow = item.querySelectorAll<HTMLElement>('.js-hide-on-label-edit')\n    for (const el of elementsToShow) {\n      el.hidden = !el.hidden\n    }\n  }\n})\n\n// Replace item row with contents from server on Edit\nremoteForm('.js-update-label', async function (form, wants) {\n  let response\n\n  try {\n    response = await wants.html()\n  } catch (error) {\n    const json = error.response.json\n    showLabelErrors(form, json)\n    return\n  }\n\n  hideLabelErrors(form)\n\n  const item = form.closest<HTMLElement>('.js-labels-list-item')!\n  item.replaceWith(response.html)\n})\n\n// Add new label to list and clear out the form\nremoteForm('.js-create-label', async function (form, wants) {\n  let response\n\n  try {\n    response = await wants.html()\n  } catch (error) {\n    const json = error.response.json\n    showLabelErrors(form, json)\n    return\n  }\n\n  form.reset()\n  hideLabelErrors(form)\n\n  document.querySelector<HTMLElement>('.js-label-list')!.prepend(response.html)\n\n  updateCount(+1)\n\n  toggleBlankSlate(form, false)\n\n  const colorButton = form.querySelector<HTMLButtonElement>('.js-new-label-color')!\n  const rgb = randomRGBColor()\n  setInputColorFromButton(colorButton, rgb)\n  updateLabelPreview(form.querySelector<HTMLInputElement>('.js-new-label-name-input')!)\n\n  resetCharactersRemainingCounts(form)\n\n  const detailsContainer = form.closest('.js-details-container')\n  if (detailsContainer instanceof HTMLElement) {\n    toggleDetailsTarget(detailsContainer)\n  }\n})\n\n// Click 'New label' button\non('click', '.js-details-target-new-label', function () {\n  const createForm = document.querySelector<HTMLElement>('.js-create-label')!\n  const nameInput = createForm.querySelector<HTMLInputElement>('.js-new-label-name-input')!\n  nameInput.focus()\n})\n\n// Click \"Edit\" enters \"edit mode\"\non('click', '.js-edit-label', function (event) {\n  const item = event.currentTarget.closest<HTMLElement>('.js-labels-list-item')!\n  const editForm = item.querySelector<HTMLElement>('.js-update-label')!\n  /* eslint-disable-next-line github/no-d-none */\n  editForm.classList.remove('d-none')\n  const nameInput = editForm.querySelector<HTMLInputElement>('.js-new-label-name-input')!\n  nameInput.focus()\n\n  const labelPreview = item.querySelector('.js-label-preview')\n  if (labelPreview) {\n    /* eslint-disable-next-line github/no-d-none */\n    labelPreview.classList.remove('d-none')\n\n    const labelLink = item.querySelector<HTMLElement>('.js-label-link')!\n    /* eslint-disable-next-line github/no-d-none */\n    labelLink.classList.add('d-none')\n  }\n\n  const elementsToHide = item.querySelectorAll<HTMLElement>('.js-hide-on-label-edit')\n  for (const el of elementsToHide) {\n    el.hidden = !el.hidden\n  }\n})\n\n// Delete remote form\nremoteForm('.js-delete-label', async function (form, wants) {\n  const row = form.closest<HTMLElement>('.js-labels-list-item')!\n  row.querySelector<HTMLElement>('.js-label-delete-spinner')!.hidden = false\n  await wants.text()\n  const newCount = updateCount(-1)\n  toggleBlankSlate(form, newCount === 0)\n  row.remove()\n})\n\nconst delayedOnLabelFormInputChange = debounce(onLabelFormInputChange, 500)\n\n// Handle the user typing in label fields:\non('suggester:complete', '.js-new-label-name-input', delayedOnLabelFormInputChange)\nonInput('.js-new-label-name-input', delayedOnLabelFormInputChange)\nonInput('.js-new-label-description-input', delayedOnLabelFormInputChange)\nonInput('.js-new-label-color-input', delayedOnLabelFormInputChange)\n\n// Limit length of label names in the way Rails does with model validations; allows emoji:\nonKey('keypress', '.js-new-label-name-input', function (event) {\n  const input = event.target as HTMLInputElement\n  const limit = parseInt(input.getAttribute('data-maxlength')!)\n\n  if (getUtf8StringLength(input.value) >= limit) {\n    event.preventDefault()\n  }\n})\n\n// Exclude labels on the issues page label filter\non('click', '.js-issues-label-select-menu-item', function (event) {\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (!event.altKey && !event.shiftKey) return\n\n  event.preventDefault()\n  event.stopPropagation()\n\n  if (event.altKey) {\n    window.location.href = event.currentTarget.getAttribute('data-excluded-url')!\n  }\n\n  // Users can shift click to add more labels to a group\n  if (event.shiftKey) {\n    window.location.href = event.currentTarget.getAttribute('data-included-url')!\n  }\n  /* eslint-enable no-restricted-syntax */\n})\n\nonKey('keydown', '.js-issues-label-select-menu-item', function (event: KeyboardEvent) {\n  // TODO: Refactor to use data-hotkey\n  /* eslint eslint-comments/no-use: off */\n  /* eslint-disable no-restricted-syntax */\n  if (event.key !== 'Enter') return\n  if (!event.altKey && !event.shiftKey) return\n\n  const anchor = event.currentTarget\n  event.preventDefault()\n  event.stopPropagation()\n  if (anchor instanceof HTMLAnchorElement) {\n    if (event.altKey) {\n      window.location.href = anchor.getAttribute('data-excluded-url')!\n    }\n\n    if (event.shiftKey) {\n      window.location.href = anchor.getAttribute('data-included-url')!\n    }\n  }\n  /* eslint-enable no-restricted-syntax */\n})\n\non(\n  'click',\n  '.js-open-label-creation-modal',\n  async function (event) {\n    // Prevent menu from closing\n    event.stopImmediatePropagation()\n    const modal = await dialog({\n      content: document.querySelector<HTMLTemplateElement>('.js-label-creation-template')!.content.cloneNode(true),\n      detailsClass: 'js-new-label-modal'\n    })\n    initLabelModal(modal)\n  },\n  {capture: true}\n)\n","// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\n// Show/hide event settings when the user's overall thread subscription option changes.\non('change', '.js-thread-notification-setting', toggleEventSettings)\n\n// Validate event settings when the user's event selection changes.\non('change', '.js-custom-thread-notification-option', toggleEventSettings)\n\n// Show/hide event settings when the user dismisses the form.\non('reset', '.js-custom-thread-settings-form', toggleEventSettings)\n\nfunction toggleEventSettings() {\n  const eventSettingsVisible = document.querySelector<HTMLInputElement>('.js-reveal-custom-thread-settings')!.checked\n  const noEventSelected = !document.querySelector('.js-custom-thread-notification-option:checked')\n\n  const eventSettingsContainer = document.querySelector<HTMLElement>('.js-custom-thread-settings')!\n  const checkbox = document.querySelector<HTMLInputElement>('[data-custom-option-required-text]')!\n  const message =\n    eventSettingsVisible && noEventSelected ? checkbox.getAttribute('data-custom-option-required-text')! : ''\n\n  checkbox.setCustomValidity(message)\n  eventSettingsContainer.hidden = !eventSettingsVisible\n}\n","import {controller, target} from '@github/catalyst'\n\n/**\n * CollapsibleSidebarWidget creates a widget in the sidebar of which\n * content is collapsible and is loaded upon opening.\n *\n * Four classes must be set, they are scoped to the HTML element <collapsible-sidebar-widget>\n *  - .collapsible-sidebar-widget-button (the button toggling open/close state)\n *  - .collapsible-sidebar-widget-content (the inner HTML to load)\n *  - .collapsible-sidebar-widget-loader (the element that is shown while loading)\n *  - .collapsible-sidebar-widget-indicator (the element that indicates open/close)\n *\n * One class is optional\n * - .collapsible-sidebar-widget-active-hidden (hides an element when the content is open)\n *\n * Notice: This is not done in pure CSS, because we need to guard\n * the loading of the content.\n *\n * @example\n * ```html\n * <collapsible-sidebar-widget url=\"/your/url\">\n *  <div>\n *   <button type=\"button\" class=\"collapsible-sidebar-widget-button\" data-action=\"mousedown:collapsible-sidebar-widget#onMouseDown keydown:collapsible-sidebar-widget#onKeyDown\">Open</button>\n *    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"collapsible-sidebar-widget-indicator\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M12.78 6.22a.75.75 0 010 1.06l-4.25 4.25a.75.75 0 01-1.06 0L3.22 7.28a.75.75 0 011.06-1.06L8 9.94l3.72-3.72a.75.75 0 011.06 0z\"></path></svg>\n *    <svg class=\"collapsible-sidebar-widget-loader anim-rotate\" viewBox=\"0 0 16 16\" fill=\"none\" width=\"16\" height=\"16\" ><circle cx=\"8\" cy=\"8\" r=\"7\" stroke=\"currentColor\" stroke-opacity=\"0.25\" stroke-width=\"2\" vector-effect=\"non-scaling-stroke\"></circle><path d=\"M15 8a7.002 7.002 0 00-7-7\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" vector-effect=\"non-scaling-stroke\"></path></svg>\n *    <div class=\"collapsible-sidebar-widget-active-hidden\">Hidden content when active</div>\n *   </button>\n *   <div class=\"collapsible-sidebar-widget-content\" data-target=\"collapsible-sidebar-widget.collapsible\">Lorem Ipsum</div>\n *  </div>\n * </collapsible-sidebar-widget>\n * ```\n */\n@controller\nclass CollapsibleSidebarWidgetElement extends HTMLElement {\n  @target collapsible: HTMLElement\n\n  pendingRequest: AbortController | null\n\n  get activeClass(): string {\n    return this.getAttribute('active-class') || 'collapsible-sidebar-widget-active'\n  }\n\n  get loadingClass(): string {\n    return this.getAttribute('loading-class') || 'collapsible-sidebar-widget-loading'\n  }\n\n  get url(): string {\n    return this.getAttribute('url') || ''\n  }\n\n  get isOpen(): boolean {\n    return this.hasAttribute('open')\n  }\n\n  set isOpen(open: boolean) {\n    open ? this.setAttribute('open', '') : this.removeAttribute('open')\n  }\n\n  /* eslint-disable-next-line custom-elements/no-method-prefixed-with-on */\n  onKeyDown(e: KeyboardEvent) {\n    if (e.code === 'Enter' || e.code === 'Space') {\n      e.preventDefault()\n\n      return this.load()\n    }\n  }\n\n  /* eslint-disable-next-line custom-elements/no-method-prefixed-with-on */\n  onMouseDown(e: MouseEvent) {\n    e.preventDefault()\n\n    return this.load()\n  }\n\n  load() {\n    if (this.pendingRequest) {\n      return this.pendingRequest.abort()\n    }\n\n    if (!this.collapsible.hasAttribute('loaded')) {\n      this.setLoading()\n\n      return this.updateCollapsible()\n    }\n\n    if (!this.isOpen) {\n      return this.setOpen()\n    }\n\n    return this.setClose()\n  }\n\n  setLoading() {\n    this.classList.add(this.loadingClass)\n    this.classList.remove(this.activeClass)\n  }\n\n  setOpen() {\n    this.classList.add(this.activeClass)\n    this.classList.remove(this.loadingClass)\n    this.isOpen = true\n  }\n\n  setClose() {\n    this.classList.remove(this.activeClass)\n    this.classList.remove(this.loadingClass)\n    this.isOpen = false\n  }\n\n  handleAbort() {\n    this.pendingRequest = null\n    this.setClose()\n  }\n\n  async updateCollapsible() {\n    try {\n      this.pendingRequest = new AbortController()\n      this.pendingRequest.signal.addEventListener('abort', () => this.handleAbort())\n\n      const response = await fetch(this.url, {\n        signal: this.pendingRequest?.signal,\n        headers: {\n          Accept: 'text/html',\n          'X-Requested-With': 'XMLHttpRequest'\n        }\n      })\n      this.pendingRequest = null\n\n      if (!response.ok) {\n        return this.setClose()\n      }\n\n      const content = await response.text()\n      this.collapsible.innerHTML = content\n      this.collapsible.setAttribute('loaded', '')\n\n      this.setOpen()\n    } catch {\n      // The errors are not yet surfaced.\n      this.pendingRequest = null\n      return this.setClose()\n    }\n  }\n}\n","import {attr, controller, target, targets} from '@github/catalyst'\n\n/**\n * A web component that allows inline editing of <input> fields.\n * The fields work without an outer <form>.\n *\n * @type HTMLElement\n * @example\n * ```html\n * <sidebar-memex-input data-url=\"http://localhost\" data-csrf=\"1234567890\" data-column=\"1\">\n *  <input type=\"date name=\"memexProjectColumnValues[][value]\" value=\"\" data-target=\"sidebar-memex-input.read\" data-action=\" blur:sidebar-memex-input#onBlur keydown:sidebar-memex-input#onKeyDown disabled />\n * </sidebar-memex-input>\n * ```\n */\n@controller\nclass SidebarMemexInputElement extends HTMLElement {\n  @attr url = ''\n  @attr csrf = ''\n  @attr instrument = ''\n  @attr column = 1\n\n  @targets inputs: NodeListOf<HTMLInputElement>\n  @target read: HTMLInputElement\n  @target write: HTMLElement\n  @targets parameters: NodeListOf<HTMLInputElement>\n\n  get isDisabled(): boolean {\n    return this.read?.hasAttribute('disabled')\n  }\n\n  set hasErrored(value: boolean) {\n    value ? this.setAttribute('errored', '') : this.removeAttribute('errored')\n  }\n\n  set disabled(value: boolean) {\n    value ? this.setAttribute('disabled', '') : this.removeAttribute('disabled')\n  }\n\n  get hasExpanded(): boolean {\n    return this.read.getAttribute('aria-expanded') === 'true'\n  }\n\n  connectedCallback() {\n    this.disabled = this.read?.disabled ?? true\n\n    // this is a hack, until the dropdown has been refactored\n    /* eslint-disable-next-line custom-elements/no-dom-traversal-in-connectedcallback */\n    if (this.querySelector('details') !== null) {\n      this.classList.toggle('no-pointer')\n    }\n  }\n\n  handleDetailsSelect(e: Event) {\n    const custom = e as CustomEvent\n    const details = e.target as HTMLElement\n    const el = custom.detail?.relatedTarget as HTMLElement\n    const opened = details.closest('details')\n    const button = opened?.querySelector('[data-menu-button]')\n\n    if (el.getAttribute('aria-checked') === 'true') {\n      el.setAttribute('aria-checked', 'false')\n      e.preventDefault()\n\n      for (const input of this.inputs) {\n        if (el.contains(input)) {\n          this.updateCell(input.name, '')\n\n          if (button?.innerHTML) {\n            button.innerHTML = input.placeholder\n          }\n\n          break\n        }\n      }\n\n      opened?.removeAttribute('open')\n    }\n  }\n\n  handleDetailsSelected(e: Event) {\n    const custom = e as CustomEvent\n    const el = custom.detail?.relatedTarget as HTMLElement\n    for (const input of this.inputs) {\n      if (el.contains(input)) {\n        this.updateCell(input.name, input.value)\n        break\n      }\n    }\n  }\n\n  mouseDownFocus(e: Event) {\n    if (!this.isDisabled) {\n      return\n    }\n\n    this.onFocus(e)\n  }\n\n  keyDownFocus(e: KeyboardEvent) {\n    if (e.code === 'Enter' || e.code === 'Space') {\n      if (this.read !== document.activeElement) {\n        this.onFocus(e)\n      }\n    }\n  }\n\n  /* eslint-disable-next-line custom-elements/no-method-prefixed-with-on */\n  onChange(e: Event) {\n    const el = e.target as HTMLElement\n    if (el.getAttribute('type') === 'date') {\n      return\n    }\n\n    this.updateCell(this.read?.name, this.read?.value)\n  }\n\n  /* eslint-disable-next-line custom-elements/no-method-prefixed-with-on */\n  onFocus(e: KeyboardEvent | Event) {\n    e.preventDefault()\n\n    this.disabled = false\n    this.read.disabled = false\n    this.read.focus()\n  }\n\n  /* eslint-disable-next-line custom-elements/no-method-prefixed-with-on */\n  onBlur(e: Event) {\n    if (this.hasExpanded) {\n      e.preventDefault()\n      return\n    }\n\n    const el = e.target as HTMLElement\n    if (el.getAttribute('type') === 'date') {\n      this.updateCell(this.read?.name, this.read?.value)\n    }\n\n    this.read.disabled = true\n    this.disabled = true\n  }\n\n  /* eslint-disable-next-line custom-elements/no-method-prefixed-with-on */\n  onKeyDown(e: KeyboardEvent) {\n    if (e.code === 'Enter' || e.code === 'Tab') {\n      e.preventDefault()\n      e.stopPropagation()\n\n      if (this.hasExpanded) {\n        return\n      }\n\n      // eslint-disable-next-line github/no-blur\n      this.read.blur()\n    }\n  }\n\n  async updateCell(name = '', value = '') {\n    const data = new FormData()\n    data.set(name, value)\n    data.set('ui', this.instrument)\n\n    for (const input of this.parameters) {\n      data.set(input.name, input.value)\n    }\n\n    const format = Intl.DateTimeFormat('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      timeZone: 'UTC'\n    })\n\n    try {\n      // this is an opportunistic update\n      if (this.write) {\n        const update = this.read.value\n        const formatted = this.read.type === 'date' && update ? format.format(Date.parse(update)) : update\n        this.write.textContent = update ? formatted : this.read.placeholder\n      }\n\n      const response = await fetch(this.url, {\n        method: 'PUT',\n        body: data,\n        headers: {\n          Accept: 'application/json',\n          'X-Requested-With': 'XMLHttpRequest',\n          'Scoped-CSRF-Token': `${this.csrf}`\n        }\n      })\n\n      if (!response.ok) {\n        throw new Error('connection error')\n      }\n\n      // if there is no target to update,\n      // break here and leave the opportunistic update of the field\n      if (!this.write) {\n        return\n      }\n\n      // this is the reconciliation\n      const content = await response.json()\n      const column = content['memexProjectItem']['memexProjectColumnValues'].find(\n        (e: Record<string, unknown>) => e['memexProjectColumnId'] === Number(this.column)\n      )\n\n      const commit = column['value']\n      const update = this.read.type === 'date' ? Date.parse(commit['value']) : commit['html']\n      const formatted = this.read.type === 'date' && update ? format.format(update) : update\n      this.write.innerHTML = value ? formatted : this.read.placeholder\n    } catch (e) {\n      this.hasErrored = true\n    }\n  }\n}\n","import '../notifications/configure-thread-subscription-dialog'\nimport './sidebar-widget'\nimport './sidebar-memex-input'\n\nimport {getPageID} from '../session-resume-helpers'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\nimport {parseHTML} from '../parse-html'\nimport {remoteForm} from '@github/remote-form'\nimport {requestSubmit} from '../form'\n\nfunction submitForm(form: Element, skipTeamsCheck = false) {\n  if (skipTeamsCheck || !reviewerTeamsCheckRequired(form)) {\n    if (form instanceof HTMLFormElement) {\n      requestSubmit(form)\n    } else {\n      previewSubmit(form)\n    }\n  }\n}\n\nfunction submitOnMenuClose(event: Event) {\n  const currentTarget = event.currentTarget as Element\n  const form = currentTarget.closest('.js-issue-sidebar-form') || currentTarget.querySelector('.js-issue-sidebar-form')\n  submitForm(form!)\n}\n\n// On item selection, submit the form\non(\n  'details-menu-selected',\n  '.js-discussion-sidebar-menu',\n  function (event) {\n    const item = event.detail.relatedTarget\n    const menu = event.currentTarget\n    const form = item.closest('.js-issue-sidebar-form')\n    const multiple = menu.hasAttribute('data-multiple')\n\n    if (item.hasAttribute('data-clear-assignees')) {\n      const selectedInputs = menu.querySelectorAll<HTMLInputElement>('input[name=\"issue[user_assignee_ids][]\"]:checked')\n      for (const el of selectedInputs) {\n        el.disabled = false\n        el.checked = false\n      }\n\n      submitForm(form)\n    } else if (multiple) {\n      menu.closest<HTMLElement>('details')!.addEventListener('toggle', submitOnMenuClose, {once: true})\n    } else {\n      submitForm(form)\n    }\n  },\n  {capture: true}\n)\n\nfunction updateSidebar(container: Element, html: string) {\n  container.replaceWith(parseHTML(document, html))\n}\n\nfunction returnFocusToTrigger(menuTriggerId: string) {\n  const currentSidebarTriggerEl = document.querySelector<HTMLElement>(`[data-menu-trigger=\"${menuTriggerId}\"]`)\n\n  // Returns focus to triggering element after HTML is replaced\n  currentSidebarTriggerEl?.focus()\n}\n\n// TODO Replace with data-replace-remote-form behavior.\nremoteForm('.js-issue-sidebar-form', async function (form, wants) {\n  const response = await wants.html()\n  // Gets the specific sidebar element (i.e. assignees, labels) before the HTML is replaced inside\n  const currentSidebarItemEl = form.closest<HTMLElement>('.js-discussion-sidebar-item')\n  // Gets the unique ID of the current sidebar element to use to reference the trigger\n  const currentSidebarDetailsId = currentSidebarItemEl?.querySelector<HTMLElement>('.select-menu')?.getAttribute('id')\n\n  currentSidebarItemEl!.replaceWith(response.html)\n\n  if (currentSidebarDetailsId) returnFocusToTrigger(currentSidebarDetailsId)\n})\n\n// Prevent suggested reviewer button on new pull request form from submitting the main form.\non('click', 'div.js-issue-sidebar-form .js-suggested-reviewer', function (event) {\n  const button = event.currentTarget as HTMLButtonElement\n\n  const form = button.closest<HTMLElement>('.js-issue-sidebar-form')!\n  previewSubmit(form, 'post', {name: button.name, value: button.value})\n  event.preventDefault()\n})\n\n// Prevent \"assign yourself\" button on the issue#new form from submitting the main form.\non('click', 'div.js-issue-sidebar-form .js-issue-assign-self', function (event) {\n  const button = event.currentTarget as HTMLButtonElement\n\n  const form = button.closest<HTMLElement>('.js-issue-sidebar-form')!\n  previewSubmit(form, 'post', {name: button.name, value: button.value})\n  button.remove()\n  // do not persist in the UI\n  document.querySelector('form#new_issue .is-submit-button-value')?.remove()\n  event.preventDefault()\n})\n\n// Allow \"unassign me\" to submit form with method DELETE\non('click', '.js-issue-unassign-self', function (event) {\n  const form = event.currentTarget.closest<HTMLElement>('.js-issue-sidebar-form')!\n  previewSubmit(form, 'delete')\n  event.preventDefault()\n})\n\nremoteForm('.js-pages-preview-toggle-form', async function (form, wants) {\n  const response = await wants.json()\n  form.querySelector<HTMLElement>('button.btn')!.textContent = response.json.new_button_value\n})\n\nfunction getCacheKey(el: Element, pageId: string) {\n  const formName = el.getAttribute('data-cache-name')\n  return `${pageId}:sidebar:${formName}`\n}\n\nfunction cacheValues(form: Element, formData: FormData, cacheKey: string) {\n  const formName = form.getAttribute('data-cache-name')\n  if (!formName) return\n\n  const data: Array<[string, FormDataEntryValue]> = []\n  for (const [key, value] of formData.entries()) {\n    if (key.indexOf(formName) === -1) continue\n    data.push([key, value])\n  }\n\n  const updated = data.filter(datum => datum[1] !== '')\n  if (updated.length > 0) {\n    sessionStorage.setItem(cacheKey, JSON.stringify(updated))\n  } else {\n    sessionStorage.removeItem(cacheKey)\n  }\n}\n\nconst hasFired = new Set<string>()\nfunction clearHasFired() {\n  hasFired.clear()\n}\n\nasync function restoreCachedValues(el: Element, cacheKey: string) {\n  const formName = el.getAttribute('data-cache-name')\n  const cache = sessionStorage.getItem(cacheKey)\n  if (!formName || !cache || hasFired.has(formName)) return\n  hasFired.add(formName)\n  const formData: Array<[string, FormDataEntryValue]> = JSON.parse(cache)\n  const inputs: HTMLInputElement[] = []\n  for (const [key, value] of formData) {\n    // Only cache string values\n    if (Object.prototype.toString.call(value) !== '[object String]') continue\n\n    const newInput = document.createElement('input')\n    newInput.type = 'hidden'\n    // The guard clause above ensures that this is a string, but the TS complier doesn't know that.\n    newInput.value = value as string\n    newInput.name = key\n    el.appendChild(newInput)\n    inputs.push(newInput)\n  }\n  try {\n    await requestPreview(el)\n    for (const input of inputs) {\n      input.remove()\n    }\n  } catch (error) {\n    hasFired.delete(formName)\n  }\n}\n\nfunction cacheValuesOnHide(form: Element, cacheKey: string) {\n  const body = scopedFormData(form)\n  cacheValues(form, body, cacheKey)\n  clearHasFired()\n}\n\nobserve('[data-cacher]', {\n  add(el) {\n    const cacheKey = getCacheKey(el, getPageID())\n    restoreCachedValues(el, cacheKey)\n    window.addEventListener('pagehide', () => cacheValuesOnHide(el, cacheKey))\n    window.addEventListener('pjax:beforeReplace', () => cacheValuesOnHide(el, cacheKey))\n    window.addEventListener('turbo:before-visit', () => cacheValuesOnHide(el, cacheKey))\n    window.addEventListener(\n      'submit',\n      event => {\n        if (!event.defaultPrevented) {\n          // Defer the write operation to the next tick\n          setTimeout(() => {\n            for (const key of Object.keys(sessionStorage)) {\n              if (key.indexOf(cacheKey) === -1) continue\n              sessionStorage.removeItem(key)\n              clearHasFired()\n            }\n          }, 0)\n        }\n      },\n      {capture: true}\n    )\n  }\n})\n\n// Submit dummy sidebar preview \"form\".\n//\n// form - DIV element tagged with .js-issue-sidebar-form\n// extra - Array of extra form data to pass along\nasync function previewSubmit(form: Element, method = 'post', extra?: {name: string; value: string}) {\n  await requestPreview(form, method, extra)\n  // Gets the specific sidebar element (i.e. assignees, labels) before the HTML is replaced inside\n  const currentSidebarItemEl = form.closest<HTMLElement>('.js-discussion-sidebar-item')\n  // Gets the unique ID of the current sidebar element to use to reference the trigger\n  const currentSidebarDetailsId = currentSidebarItemEl?.querySelector<HTMLElement>('.select-menu')?.getAttribute('id')\n\n  if (currentSidebarDetailsId) returnFocusToTrigger(currentSidebarDetailsId)\n}\n\nasync function requestPreview(form: Element, method = 'post', extra?: {name: string; value: string}) {\n  const body = scopedFormData(form)\n  if (extra) {\n    body.append(extra.name, extra.value)\n  }\n\n  const url = form.getAttribute('data-url')!\n  if (!url) return\n\n  const token = form.querySelector<HTMLInputElement>('.js-data-url-csrf')!\n\n  const response = await fetch(url, {\n    method,\n    body: method === 'delete' ? '' : body,\n    mode: 'same-origin',\n    headers: {\n      'Scoped-CSRF-Token': token.value,\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n  if (!response.ok) {\n    return\n  }\n  const html = await response.text()\n  updateSidebar(form.closest<HTMLElement>('.js-discussion-sidebar-item')!, html)\n}\n\n// Returns true (and triggers a reviewer check for \"notification spam\") if the\n// form (or div, in new PRs) contains at least one new review request for a team\nfunction reviewerTeamsCheckRequired(form: Element) {\n  // We only care about reviewers...\n  const url = form.getAttribute('data-reviewers-team-size-check-url')\n  if (!url) return false\n\n  // ...and whether there is at least one newly-selected team\n  const previouslyRequestedTeams = [...document.querySelectorAll<HTMLElement>('.js-reviewer-team')].map(elem =>\n    elem.getAttribute('data-id')\n  )\n  const formData = form instanceof HTMLFormElement ? new FormData(form) : scopedFormData(form)\n  const allSelectedTeams = new URLSearchParams(formData as FormData & Record<string, string>).getAll(\n    'reviewer_team_ids[]'\n  )\n  const newlySelectedTeams = allSelectedTeams.filter(team => !previouslyRequestedTeams.includes(team))\n  if (newlySelectedTeams.length === 0) return false\n\n  const params = new URLSearchParams(newlySelectedTeams.map(s => ['reviewer_team_ids[]', s]))\n  triggerTeamReviewerCheck(form, `${url}?${params}`)\n  return true\n}\n\n// Asks the server if any of the newly-selected teams is too large;\n// show the dialog if so, move on and request reviews otherwise.\nasync function triggerTeamReviewerCheck(form: Element, reviewerCheckUrl: string) {\n  const response = await fetch(reviewerCheckUrl)\n  if (!response.ok) {\n    return\n  }\n\n  const dialogHtml = await response.text()\n  if (dialogHtml.match(/[^\\w-]js-large-team[^\\w-]/)) {\n    showTeamReviewerConfirmationDialog(form, dialogHtml)\n  } else {\n    submitForm(form, true)\n    return\n  }\n}\n\n// Shows dialog that requests confirmation for review requests to large teams\nfunction showTeamReviewerConfirmationDialog(form: Element, dialogHtml: string) {\n  // Add dialog to DOM\n  const container = form.querySelector<HTMLElement>('.js-large-teams-check-warning-container')!\n  while (container.firstChild) {\n    container.removeChild(container.firstChild)\n  }\n  container.appendChild(parseHTML(document, dialogHtml))\n\n  // Wire dialog actions and open it\n  const dialog = container.querySelector<HTMLDetailsElement>('details')!\n  function dialogAction(event: Event) {\n    if (!(event.target instanceof Element)) return\n    dialog.open = false\n    // Unless the user explicitly confirms, un-select the large teams before submitting\n    if (!event.target.classList.contains('js-large-teams-request-button')) {\n      const reviewerInputs = form.querySelectorAll<HTMLInputElement>(\"input[name='reviewer_team_ids[]']\")\n      for (const reviewerInput of reviewerInputs) {\n        if (container.querySelector(`.js-large-team[data-id='${reviewerInput.value}']`)) {\n          reviewerInput.checked = false\n        }\n      }\n    }\n    submitForm(form, true)\n    event.preventDefault()\n  }\n  container\n    .querySelector<HTMLElement>('.js-large-teams-request-button')!\n    .addEventListener('click', dialogAction, {once: true})\n  container\n    .querySelector<HTMLElement>('.js-large-teams-do-not-request-button')!\n    .addEventListener('click', dialogAction, {once: true})\n  dialog.addEventListener('details-dialog-close', dialogAction, {once: true})\n  dialog.open = true\n}\n\non('click', 'div.js-project-column-menu-container .js-project-column-menu-item button', async function (event) {\n  const currentTarget = event.currentTarget\n  updateProjectColumnMenuSummary(currentTarget)\n  const moveUrl = currentTarget.getAttribute('data-url')!\n  const token = currentTarget.parentElement!.querySelector<HTMLInputElement>('.js-data-url-csrf')!\n  const cardId = currentTarget.getAttribute('data-card-id')!\n  const form = new FormData()\n\n  form.append('card_id', cardId)\n  form.append('use_automation_prioritization', 'true')\n\n  event.preventDefault()\n  const response = await fetch(moveUrl, {\n    method: 'PUT',\n    mode: 'same-origin',\n    body: form,\n    headers: {\n      'Scoped-CSRF-Token': token.value,\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n  if (!response.ok) {\n    return\n  }\n  // blur any active elements if they are contained within the detail\n  // to allow update-content to reload the dropdown\n  const activeElement = document.activeElement as HTMLElement\n  const container = currentTarget.closest<HTMLElement>('.js-project-column-menu-dropdown')!\n  if (activeElement && container.contains(activeElement)) {\n    try {\n      // eslint-disable-next-line github/no-blur\n      activeElement.blur()\n    } catch (e) {\n      // ignore\n    }\n  }\n})\n\nfunction updateProjectColumnMenuSummary(element: Element) {\n  const dropdown = element.closest<HTMLElement>('.js-project-column-menu-dropdown')!\n  const summary = dropdown.querySelector<HTMLElement>('.js-project-column-menu-summary')!\n  const columnName = element.getAttribute('data-column-name')!\n\n  summary.textContent = columnName\n}\n\non('click', '.js-prompt-dismiss', function (event) {\n  event.currentTarget.closest<HTMLElement>('.js-prompt')!.remove()\n})\n\n// Similar to serializeArray, but maybe scoped to a non-form.\n//\n// container - Element contained by a form to serialize the child fields for\nfunction scopedFormData(container: Element): FormData {\n  const form = container.closest<HTMLFormElement>('form')!\n  if (!form) return new FormData()\n  const formData = new FormData(form)\n  const params = formData.entries()\n  const results = new FormData()\n  for (const [name, value] of params) {\n    if (form.contains(findParam(form, name, value.toString()))) {\n      results.append(name, value)\n    }\n  }\n  return results\n}\n\nfunction findParam(form: HTMLFormElement, name: string, value: string): Element | null {\n  for (const el of form.elements) {\n    if (el instanceof HTMLInputElement || el instanceof HTMLTextAreaElement || el instanceof HTMLButtonElement) {\n      if (el.name === name && el.value === value) {\n        return el\n      }\n    }\n  }\n  return null\n}\n\non('click', '.js-convert-to-draft', function (event) {\n  const convertToDraftUrl = event.currentTarget.getAttribute('data-url')!\n  const token = event.currentTarget.parentElement!.querySelector<HTMLInputElement>('.js-data-url-csrf')!\n\n  fetch(convertToDraftUrl, {\n    method: 'POST',\n    mode: 'same-origin',\n    headers: {\n      'Scoped-CSRF-Token': token.value,\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n})\n\non('click', 'div.js-restore-item', async function (event) {\n  const unarchiveItemUrl = event.currentTarget.getAttribute('data-url')!\n  const projectItemID = event.currentTarget.getAttribute('data-column')!\n  const token = event.currentTarget.querySelector<HTMLInputElement>('.js-data-url-csrf')!\n  const form = new FormData()\n\n  form.set('memexProjectItemIds[]', projectItemID)\n\n  const result = await fetch(unarchiveItemUrl, {\n    method: 'PUT',\n    mode: 'same-origin',\n    body: form,\n    headers: {\n      'Scoped-CSRF-Token': token.value,\n      'X-Requested-With': 'XMLHttpRequest'\n    }\n  })\n\n  if (!result.ok) {\n    throw new Error('connection error')\n  }\n\n  submitOnMenuClose(event)\n})\n","function queryLast<T extends Element>(selector: string): T | undefined {\n  const list = document.querySelectorAll<T>(selector)\n  if (list.length > 0) {\n    return list[list.length - 1]\n  }\n}\n\nfunction pagePathname() {\n  const locationOverride = queryLast<HTMLMetaElement>('meta[name=analytics-location]')\n  if (locationOverride) {\n    return locationOverride.content\n  } else {\n    return window.location.pathname\n  }\n}\n\nfunction pageQuery() {\n  const stripParams = queryLast<HTMLMetaElement>('meta[name=analytics-location-query-strip]')\n  let search = ''\n\n  if (!stripParams) {\n    search = window.location.search\n  }\n\n  const extraParams = queryLast<HTMLMetaElement>('meta[name=analytics-location-params]')\n  if (extraParams) {\n    search += (search ? '&' : '?') + extraParams.content\n  }\n\n  for (const meta of document.querySelectorAll<HTMLMetaElement>('meta[name=analytics-param-rename]')) {\n    const names = meta.content.split(':', 2)\n    search = search.replace(new RegExp(`(^|[?&])${names[0]}($|=)`, 'g'), `$1${names[1]}$2`)\n  }\n\n  return search\n}\n\nexport function requestUri() {\n  return `${window.location.protocol}//${window.location.host}${pagePathname() + pageQuery()}`\n}\n","let lastActiveElement: Element | null\nlet currentInputIsMouse = false\n\nfunction setClass() {\n  lastActiveElement = document.activeElement\n  if (document.body) {\n    document.body.classList.toggle('intent-mouse', currentInputIsMouse)\n  }\n}\n\n// Use mousedown event to make sure outline is remove for holding and dragging\ndocument.addEventListener(\n  'mousedown',\n  function () {\n    currentInputIsMouse = true\n    if (lastActiveElement === document.activeElement) setClass()\n  },\n  {capture: true}\n)\n\ndocument.addEventListener(\n  'keydown',\n  function () {\n    currentInputIsMouse = false\n  },\n  {capture: true}\n)\n\ndocument.addEventListener('focusin', setClass, {capture: true})\n","import {getUtf8StringLength} from '../text'\nimport {onFocus} from '../onfocus'\n\nfunction showRemainingCharacterCount(value: string, limit: number, field: HTMLTextAreaElement | HTMLInputElement) {\n  const container = field.closest('.js-characters-remaining-container')\n  if (!container) {\n    return\n  }\n\n  const remainingEl = container.querySelector<HTMLElement>('.js-characters-remaining')!\n  const suffix = String(remainingEl.getAttribute('data-suffix'))\n  const valueLength = getUtf8StringLength(value)\n  const remainingCount = limit - valueLength\n\n  if (remainingCount <= 20) {\n    remainingEl.textContent = `${remainingCount} ${suffix}`\n    remainingEl.classList.toggle('color-fg-danger', remainingCount <= 5)\n    remainingEl.hidden = false\n  } else {\n    remainingEl.hidden = true\n  }\n}\n\nfunction getFieldLimit(input: HTMLTextAreaElement | HTMLInputElement): number {\n  if (input.hasAttribute('data-maxlength')) {\n    return parseInt(input.getAttribute('data-maxlength') || '')\n  }\n\n  return input.maxLength\n}\n\nexport function hasExceededCharacterLimit(input: HTMLTextAreaElement | HTMLInputElement): boolean {\n  const limit = getFieldLimit(input)\n  const valueLength = getUtf8StringLength(input.value)\n  const remainingCount = limit - valueLength\n\n  return remainingCount < 0\n}\n\nexport function updateInputRemainingCharacters(input: HTMLTextAreaElement | HTMLInputElement) {\n  const limit = getFieldLimit(input)\n  showRemainingCharacterCount(input.value, limit, input)\n}\n\nexport function resetCharactersRemainingCounts(container: Element) {\n  const charContainers = container.querySelectorAll('.js-characters-remaining-container')\n\n  for (const charContainer of charContainers) {\n    const input = charContainer.querySelector<HTMLInputElement>('.js-characters-remaining-field')!\n    updateInputRemainingCharacters(input)\n  }\n}\n\nonFocus('.js-characters-remaining-field', function (input) {\n  function onInput() {\n    if (input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement) {\n      updateInputRemainingCharacters(input)\n    }\n  }\n  onInput()\n\n  input.addEventListener('input', onInput)\n  input.addEventListener(\n    'blur',\n    () => {\n      input.removeEventListener('input', onInput)\n    },\n    {once: true}\n  )\n})\n","// Confirm\n//\n// Prompts native confirm dialog before activating link.\n//\n// data-confirm - Message to pass to confirm().\n//\n//   <button type=\"submit\" data-confirm=\"Are you sure?\">Delete</a>\n\ndocument.addEventListener(\n  'click',\n  function (event) {\n    if (!(event.target instanceof Element)) return\n\n    const selector =\n      'a[data-confirm], input[type=submit][data-confirm], input[type=checkbox][data-confirm], button[data-confirm]'\n\n    const currentTarget = event.target.closest(selector)\n    if (!currentTarget) return\n\n    const message = currentTarget.getAttribute('data-confirm')\n    if (!message) return\n\n    if (\n      currentTarget instanceof HTMLInputElement &&\n      currentTarget.hasAttribute('data-confirm-checked') &&\n      !currentTarget.checked\n    ) {\n      return\n    }\n\n    if (!confirm(message)) {\n      event.stopImmediatePropagation()\n      event.preventDefault()\n    }\n  },\n  true\n)\n","// Toggle hidden attribute on elements inside <include-fragment> and\n// <poll-include-fragment> elements that have the data-hide-on-error and\n// data-show-on-error attributes on them when error events are fired.\n\nimport {compose, fromEvent} from '../subscription'\nimport type IncludeFragmentElement from '@github/include-fragment-element'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nobserve('include-fragment, poll-include-fragment', {\n  subscribe: el => compose(fromEvent(el, 'error', onError), fromEvent(el, 'loadstart', onLoad))\n})\n\non('click', 'include-fragment button[data-retry-button]', ({currentTarget}) => {\n  const includeFragment = currentTarget.closest<IncludeFragmentElement>('include-fragment')!\n  const url = includeFragment.src\n  includeFragment.src = ''\n  includeFragment.src = url\n})\n\nfunction toggleElements(event: Event, showError: boolean) {\n  const fragment = event.currentTarget\n  if (!(fragment instanceof Element)) return\n\n  for (const el of fragment.querySelectorAll('[data-show-on-error]')) {\n    if (el instanceof HTMLElement) el.hidden = !showError\n  }\n  for (const el of fragment.querySelectorAll('[data-hide-on-error]')) {\n    if (el instanceof HTMLElement) el.hidden = showError\n  }\n}\n\nfunction onLoad(event: Event) {\n  toggleElements(event, false)\n}\n\nfunction onError(event: Event) {\n  toggleElements(event, true)\n}\n\nexport function loadDeferredContentByEvent({currentTarget}: Event) {\n  if (!(currentTarget instanceof Element)) return\n\n  loadDeferredContent(currentTarget)\n}\n\nexport function loadDeferredContent(element: Element) {\n  const details = element.closest<HTMLElement>('details')\n  if (details) {\n    setIncludeFragmentSrc(details)\n  }\n}\n\nfunction setIncludeFragmentSrc(detailsElement: HTMLElement) {\n  const url = detailsElement.getAttribute('data-deferred-details-content-url')\n  if (url) {\n    detailsElement.removeAttribute('data-deferred-details-content-url')\n    const includeFragmentElement = detailsElement.querySelector<IncludeFragmentElement>(\n      'include-fragment, poll-include-fragment'\n    )\n    if (includeFragmentElement) {\n      includeFragmentElement.src = url\n    }\n  }\n}\n","// Ignore pjax if window.onbeforeunload is set, since we may not be able to\n// safely navigate away from the current page.\ndocument.addEventListener('pjax:click', function (event) {\n  if (window.onbeforeunload) {\n    return event.preventDefault()\n  }\n})\n","import {fromEvent} from '../subscription'\nimport {loaded} from '../document-ready'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\nimport {positionedOffset} from '../dimensions'\n\nobserve('.js-responsive-underlinenav', {\n  constructor: HTMLElement,\n  subscribe: nav => {\n    asyncCalculateVisibility(nav)\n    return fromEvent(window, 'resize', () => calculateVisibility(nav))\n  }\n})\n\nexport async function asyncCalculateVisibility(nav: HTMLElement) {\n  await loaded\n  calculateVisibility(nav)\n}\n\nfunction toggleItem(item: HTMLElement, hidden: boolean) {\n  // Set visibility to hidden, instead of .hidden attribute\n  // so we can still calculate distance accurately\n  item.style.visibility = hidden ? 'hidden' : ''\n  // Get tab-item name, if present, so we can match it up with the dropdown menu\n  const itemName = item.getAttribute('data-tab-item')\n  if (itemName) {\n    const itemToHide = document.querySelector<HTMLElement>(`[data-menu-item=${itemName}]`)\n    if (itemToHide instanceof HTMLElement) {\n      itemToHide.hidden = !hidden\n    }\n  }\n}\n\nfunction calculateVisibility(nav: HTMLElement) {\n  const items = nav.querySelectorAll<HTMLElement>('.js-responsive-underlinenav-item')\n  const overflowContainer = nav.querySelector<HTMLElement>('.js-responsive-underlinenav-overflow')!\n  const overflowOffset = positionedOffset(overflowContainer, nav)\n  if (!overflowOffset) {\n    return\n  }\n\n  let anyHidden = false\n  for (const item of items) {\n    const itemOffset = positionedOffset(item, nav)\n    if (itemOffset) {\n      const hidden = itemOffset.left + item.offsetWidth >= overflowOffset.left\n      toggleItem(item, hidden)\n      anyHidden = anyHidden || hidden\n    }\n  }\n  overflowContainer.style.visibility = anyHidden ? '' : 'hidden'\n}\n","// Deal with selected_link_to on repository and gist pages\ndocument.addEventListener('pjax:end', function () {\n  const meta = document.querySelector('meta[name=\"selected-link\"]')\n  const selection = meta && meta.getAttribute('value')\n  if (!selection) {\n    return\n  }\n  for (const item of document.querySelectorAll('.js-sidenav-container-pjax .js-selected-navigation-item')) {\n    const isSelected = (item.getAttribute('data-selected-links') || '').split(' ').indexOf(selection) >= 0\n    isSelected ? item.setAttribute('aria-current', 'page') : item.removeAttribute('aria-current')\n    item.classList.toggle('selected', isSelected)\n  }\n})\n","// Detects signout/signin events via `flash[:stale_session_signedin]` and\n// notifies other browser tabs so that they can:\n//\n// 1. display the \"You signed out in another tab\" banner; and\n// 2. disable pjaxing and form submission.\n//\n// On browsers that don't support BroadcastChannel, the `logged-in`\n// localStorage key is used to send messages between tabs.\n\nfunction sessionChanged(loggedIn: string) {\n  const flash = document.querySelector<HTMLElement>('.js-stale-session-flash')!\n  const flashSignedIn = flash.querySelector<HTMLElement>('.js-stale-session-flash-signed-in')!\n  const flashSignedOut = flash.querySelector<HTMLElement>('.js-stale-session-flash-signed-out')!\n\n  flash.hidden = false\n  flashSignedIn.hidden = loggedIn === 'false'\n  flashSignedOut.hidden = loggedIn === 'true'\n\n  window.addEventListener('popstate', function (event: PopStateEvent) {\n    if (event.state && event.state.container != null) {\n      location.reload()\n    }\n  })\n\n  document.addEventListener('submit', function (event: Event) {\n    event.preventDefault()\n  })\n}\n\nlet bc\nif (typeof BroadcastChannel === 'function') {\n  try {\n    bc = new BroadcastChannel('stale-session')\n    bc.onmessage = event => {\n      if (typeof event.data === 'string') sessionChanged(event.data)\n    }\n  } catch {\n    // ignore\n  }\n}\nif (!bc) {\n  let postingMessage = false\n\n  bc = {\n    postMessage(message: string) {\n      postingMessage = true\n      try {\n        window.localStorage.setItem('logged-in', message)\n      } finally {\n        postingMessage = false\n      }\n    }\n  }\n\n  window.addEventListener('storage', function (event) {\n    /* eslint eslint-comments/no-use: off */\n    /* eslint-disable no-restricted-syntax */\n    if (!postingMessage && event.storageArea === window.localStorage && event.key === 'logged-in') {\n      try {\n        if (event.newValue === 'true' || event.newValue === 'false') {\n          sessionChanged(event.newValue)\n        }\n      } finally {\n        window.localStorage.removeItem(event.key)\n      }\n    }\n    /* eslint-enable no-restricted-syntax */\n  })\n}\n\nconst element = document.querySelector('.js-stale-session-flash[data-signedin]')\nif (element) {\n  const value = element.getAttribute('data-signedin') || ''\n  bc.postMessage(value)\n}\n","// Populate a form input from a suggested list of tags.\n//\n// Markup example:\n//\n//    <!-- Tag input container -->\n//    <div class=\"tag-input-container js-tag-input-container\">\n//\n//      <!-- Tag <input> wrapper -->\n//      <div class=\"tag-input js-tag-input-wrapper\">\n//\n//        <!-- List of selected tags -->\n//        <ul class=\"js-tag-input-selected-tags\">\n//\n//          <!-- Template used to generate new selected tags -->\n//          <li class=\"js-tag-input-tag js-template d-none\">\n//            <span class=\"js-placeholder-tag-name\"></span>\n//            <a class=\"remove js-remove\" tabindex=\"-1\">&times;</a>\n//            <input type=\"hidden\" name=\"attribute[]\" value=\"tag-value\">\n//          </li>\n//\n//          <!-- List of pre-selected tags (optional) -->\n//          <li class=\"js-tag-input-tag\">\n//            <span class=\"js-tag-input-tag-name\">ruby-on-rails</span>\n//            <a class=\"remove js-remove\" tabindex=\"-1\">&times;</a>\n//            <input type=\"hidden\" name=\"attribute[]\" value=\"ruby-on-rails\">\n//          </li>\n//        </ul>\n//\n//        <auto-complete src=\"<%= url %>\" for=\"popup\">\n//          <input type=\"text\" class=\"tag-input-inner\" autocomplete=\"off\" autofocus>\n//          <div class=\"js-navigation-container js-active-navigation-container\">\n//            <ul class=\"suggester\" id=\"popup\"></ul>\n//          </div>\n//        </auto-complete>\n//      </div>\n//    </div>\n//\n\nimport AutocompleteElement from '@github/auto-complete-element'\nimport {eventToHotkeyString} from '@github/hotkey'\n// eslint-disable-next-line no-restricted-imports\nimport {fire} from 'delegated-events'\n// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\ninterface TagInputOptions {\n  container: HTMLElement\n  selections: HTMLElement\n  inputWrap: HTMLElement\n  input: HTMLInputElement\n  tagTemplate: HTMLElement\n  autoComplete: AutocompleteElement\n  multiTagInput: boolean\n}\n\nclass TagInput {\n  container: HTMLElement\n  selections: HTMLElement\n  inputWrap: HTMLElement\n  input: HTMLInputElement\n  form: HTMLFormElement\n  tagTemplate: HTMLElement\n  autoComplete: AutocompleteElement\n  multiTagInput: boolean\n\n  constructor(options: TagInputOptions) {\n    this.container = options.container\n    this.selections = options.selections\n    this.inputWrap = options.inputWrap\n    this.input = options.input\n    this.tagTemplate = options.tagTemplate\n    this.form = this.input.form!\n    this.autoComplete = options.autoComplete\n    this.multiTagInput = options.multiTagInput\n  }\n\n  // Bind a tag input to the DOM.\n  setup() {\n    this.container.addEventListener('click', (event: MouseEvent) => {\n      const target = event.target as Element\n      if (target.closest('.js-remove')) {\n        this.removeTag(event)\n      } else {\n        this.onFocus()\n      }\n    })\n    this.input.addEventListener('focus', this.onFocus.bind(this))\n    this.input.addEventListener('blur', this.onBlur.bind(this))\n    this.input.addEventListener('keydown', this.onKeyDown.bind(this))\n    this.form.addEventListener('submit', this.onSubmit.bind(this))\n\n    this.autoComplete.addEventListener('auto-complete-change', () => {\n      this.selectTag(this.autoComplete.value)\n    })\n  }\n\n  // Make the tag input container look like a focused input.\n  onFocus() {\n    this.inputWrap.classList.add('focus')\n    if (this.input !== document.activeElement) this.input.focus()\n  }\n\n  // Make the tag input container *not* look like a focused input. Also submit\n  // the form if there is text in the input and the suggester is hidden.\n  onBlur() {\n    this.inputWrap.classList.remove('focus')\n    if (!this.autoComplete.open) {\n      this.onSubmit()\n    }\n  }\n\n  // Taggify the last thing the user typed in case they didn't hit Enter, Tab,\n  // or a comma before clicking the form's submit button.\n  onSubmit() {\n    if (this.input.value) {\n      this.selectTag(this.input.value)\n      this.autoComplete.open = false\n    }\n  }\n\n  onKeyDown(event: KeyboardEvent) {\n    switch (eventToHotkeyString(event)) {\n      case 'Backspace':\n        this.onBackspace()\n        break\n      case 'Enter':\n      case 'Tab':\n        this.taggifyValueWhenSuggesterHidden(event)\n        break\n      case ',':\n      case ' ': // (Space)\n        this.taggifyValue(event)\n        break\n    }\n  }\n\n  // Taggifies the entered value when the suggester is not visible. Called after an Enter\n  // or Tab is entered.\n  taggifyValueWhenSuggesterHidden(event: Event) {\n    if (!this.autoComplete.open && this.input.value) {\n      event.preventDefault()\n      this.selectTag(this.input.value)\n    }\n  }\n\n  // Taggifies the entered value if it exists; called after a comma or space is entered.\n  taggifyValue(event: Event) {\n    if (this.input.value) {\n      event.preventDefault()\n      this.selectTag(this.input.value)\n      this.autoComplete.open = false\n    }\n  }\n\n  // Add a new tag to the list of selections if it has not already been added.\n  selectTag(text: string) {\n    const tags = this.normalizeTag(text)\n    const selections = this.selectedTags()\n\n    let tagsAdded = false\n    for (let i = 0; i < tags.length; i++) {\n      const tag = tags[i]\n      if (selections.indexOf(tag) < 0) {\n        this.selections.appendChild(this.templateTag(tag))\n        tagsAdded = true\n      }\n    }\n\n    if (tagsAdded) {\n      this.input.value = ''\n      fire(this.form, 'tags:changed')\n    }\n  }\n\n  // Remove a tag from the list of selections.\n  removeTag(event: Event) {\n    const target = event.target as Element\n    event.preventDefault()\n    const inputTag = target.closest<HTMLElement>('.js-tag-input-tag')!\n    inputTag.remove()\n    fire(this.form, 'tags:changed')\n  }\n\n  // Generate a new tag Node.\n  templateTag(tag: string): Element {\n    const el = this.tagTemplate.cloneNode(true) as Element\n\n    el.querySelector<HTMLInputElement>('input')!.value = tag\n    const tagName = el.querySelector<HTMLElement>('.js-placeholder-tag-name')!\n    tagName.replaceWith(tag)\n    /* eslint-disable-next-line github/no-d-none */\n    el.classList.remove('d-none', 'js-template')\n\n    return el\n  }\n\n  // Sanitize user input to remove invalid tag characters.\n  normalizeTag(text: string): string[] {\n    const sanitizedText = text.toLowerCase().trim()\n\n    if (!sanitizedText) return []\n    if (this.multiTagInput) return sanitizedText.split(/[\\s,']+/)\n\n    return [sanitizedText.replace(/[\\s,']+/g, '-')]\n  }\n\n  // Remove a tag on backspace if the input is empty.\n  onBackspace() {\n    if (!this.input.value) {\n      const lastSelection = this.selections.querySelector('li:last-child .js-remove')\n      if (lastSelection instanceof HTMLElement) lastSelection.click()\n    }\n  }\n\n  // Map matched input content to a suggester query.\n  selectedTags(): string[] {\n    const inputs = this.selections.querySelectorAll<HTMLInputElement>('input')\n    return Array.from(inputs)\n      .map(el => el.value)\n      .filter(value => value.length > 0)\n  }\n}\n\nobserve('.js-tag-input-container', {\n  constructor: HTMLElement,\n  initialize(el) {\n    new TagInput({\n      container: el,\n      inputWrap: el.querySelector<HTMLElement>('.js-tag-input-wrapper')!,\n      input: el.querySelector<HTMLInputElement>('input[type=\"text\"], input:not([type])')!,\n      selections: el.querySelector<HTMLElement>('.js-tag-input-selected-tags')!,\n      tagTemplate: el.querySelector<HTMLElement>('.js-template')!,\n      autoComplete: el.querySelector<AutocompleteElement>('auto-complete')!,\n      multiTagInput: false\n    }).setup()\n  }\n})\n\nobserve('.js-multi-tag-input-container', {\n  constructor: HTMLElement,\n  initialize(el) {\n    new TagInput({\n      container: el,\n      inputWrap: el.querySelector<HTMLElement>('.js-tag-input-wrapper')!,\n      input: el.querySelector<HTMLInputElement>('input[type=\"text\"], input:not([type])')!,\n      selections: el.querySelector<HTMLElement>('.js-tag-input-selected-tags')!,\n      tagTemplate: el.querySelector<HTMLElement>('.js-template')!,\n      autoComplete: el.querySelector<AutocompleteElement>('auto-complete')!,\n      multiTagInput: true\n    }).setup()\n  }\n})\n","import type {CodeEditor} from './editor/code-editor'\n// eslint-disable-next-line no-restricted-imports\nimport {on} from 'delegated-events'\n\nconst editors: WeakMap<HTMLElement, CodeEditor> = new WeakMap()\n\nexport function getCodeEditor(el: HTMLElement): CodeEditor | undefined {\n  return editors.get(el)\n}\n\nexport async function getAsyncCodeEditor(el: HTMLElement): Promise<CodeEditor> {\n  return editors.get(el) || onEditorFromEvent(await nextEvent(el, 'codeEditor:ready'))\n}\n\nfunction onEditorFromEvent(event: Event): CodeEditor {\n  if (!(event instanceof CustomEvent)) throw new Error('assert: event is not a CustomEvent')\n  const editor: CodeEditor = event.detail.editor\n  if (!event.target) throw new Error('assert: event.target is null')\n  editors.set(event.target as HTMLElement, editor)\n  return editor\n}\n\non('codeEditor:ready', '.js-code-editor', onEditorFromEvent)\n\nfunction nextEvent(target: EventTarget, event: string): Promise<Event> {\n  return new Promise(resolve => {\n    target.addEventListener(event, resolve, {once: true})\n  })\n}\n","interface Cookie {\n  key: string\n  value: string\n}\n\n/**\n * Get a cookie by name.\n * @param name\n * @returns a cookie object or undefined if not found.\n */\nexport function getCookie(name: string): Cookie | undefined {\n  return getCookies(name)[0]\n}\n\n/**\n * Get all cookies by name.\n * @param name\n * @returns\n */\nexport function getCookies(name: string): Cookie[] {\n  const cookies = []\n  for (const cookie of readCookies()) {\n    const [key, value] = cookie.trim().split('=')\n    if (name === key && typeof value !== 'undefined') {\n      cookies.push({key, value})\n    }\n  }\n  return cookies\n}\n\nfunction readCookies(): string[] {\n  try {\n    return document.cookie.split(';')\n  } catch {\n    // Cookie access disabled.\n    return []\n  }\n}\n\n/**\n * Set a new cookie with sensible defaults like secure.\n * @param name\n * @param value\n * @param expiration\n * @param strictDomain\n * @param samesite\n */\nexport function setCookie(\n  name: string,\n  value: string,\n  expiration: string | null = null,\n  strictDomain = false,\n  samesite = 'lax'\n) {\n  let domain = document.domain\n  if (domain == null) {\n    throw new Error('Unable to get document domain')\n  }\n\n  // Share cookies with test environments.\n  if (domain.endsWith('.github.com')) {\n    domain = 'github.com'\n  }\n\n  const secure = location.protocol === 'https:' ? '; secure' : ''\n  const expire = expiration ? `; expires=${expiration}` : ''\n  if (strictDomain === false) {\n    domain = `.${domain}`\n  }\n  try {\n    document.cookie = `${name}=${value}; path=/; domain=${domain}${expire}${secure}; samesite=${samesite}`\n  } catch {\n    // Cookie access disabled.\n  }\n}\n\n/**\n * Delete a given cookie with sensible defaults like secure.\n * This sets the expires value to a second ago to delete the cookie.\n * @param name\n * @param strictDomain\n */\nexport function deleteCookie(name: string, strictDomain = false) {\n  let domain = document.domain\n  if (domain == null) {\n    throw new Error('Unable to get document domain')\n  }\n\n  // Share cookies with test environments.\n  if (domain.endsWith('.github.com')) {\n    domain = 'github.com'\n  }\n\n  const time = new Date().getTime()\n  const expiration = new Date(time - 1).toUTCString()\n  const secure = location.protocol === 'https:' ? '; secure' : ''\n  const expire = `; expires=${expiration}`\n  if (strictDomain === false) {\n    domain = `.${domain}`\n  }\n  try {\n    document.cookie = `${name}=''; path=/; domain=${domain}${expire}${secure}`\n  } catch {\n    // Cookie access disabled.\n  }\n}\n","// Report uncaught JS errors to Sentry\n//   https://sentry.io/github/github-js\n\nimport {SOFT_NAV_STATE, getSoftNavReferrer} from './soft-nav-helpers'\nimport detectProxySite from './proxy-site-detection'\nimport {getOrCreateClientId} from '@github/hydro-analytics-client'\nimport {isSupported} from '@github/browser-support'\nimport {parse} from 'stacktrace-parser'\nimport {requestUri} from './analytics-overrides'\n\nlet extensionErrors = false\nlet errorsReported = 0\nconst loadTime = Date.now()\n\ntype ErrorContext = {\n  message?: string\n}\n\n// Report error event to Sentry.\n//\n// Example:\n//   window.addEventListener('error', event => { reportEvent(event) })\nexport function reportEvent(event: ErrorEvent) {\n  if (event.error) {\n    report(errorContext(formatError(event.error)))\n  }\n}\n\n// Report error from a rejected Promise to Sentry.\n//\n// Example:\n//   window.onunhandledrejection(event => { reportEvent(event) })\nexport async function reportPromiseRejectionEvent(event: PromiseRejectionEvent) {\n  if (!event.promise) return\n  try {\n    await event.promise\n  } catch (error) {\n    report(errorContext(formatError(error)))\n  }\n}\n\n// @deprecated Re-throw the caught exception instead.\nexport function reportError(error: Error, context: ErrorContext = {}) {\n  if (error && error.name !== 'AbortError') {\n    report(errorContext(formatError(error), context))\n  }\n}\n\n// Report context info to Sentry.\nasync function report(context: PlatformReportBrowserErrorInput) {\n  if (!reportable()) return\n\n  const url = document.head?.querySelector<HTMLMetaElement>('meta[name=\"browser-errors-url\"]')?.content\n  if (!url) return\n\n  if (isExtensionError(context.error.stacktrace)) {\n    extensionErrors = true\n    return\n  }\n\n  errorsReported++\n\n  try {\n    await fetch(url, {method: 'post', body: JSON.stringify(context)})\n  } catch {\n    // Error reporting failed so do nothing.\n  }\n}\n\nfunction formatError(error: Error): PlatformJavascriptError {\n  return {type: error.name, value: error.message, stacktrace: stacktrace(error)}\n}\n\nfunction errorContext(error: PlatformJavascriptError, context: ErrorContext = {}): PlatformReportBrowserErrorInput {\n  return Object.assign(\n    {\n      error,\n      sanitizedUrl: requestUri() || window.location.href,\n      readyState: document.readyState,\n      referrer: getSoftNavReferrer(),\n      timeSinceLoad: Math.round(Date.now() - loadTime),\n      user: pageUser() || undefined,\n      bundler: bundlerName()\n    },\n    context\n  )\n}\n\nexport function stacktrace(error: Error): PlatformStackframe[] {\n  return parse(error.stack || '').map(frame => ({\n    filename: frame.file || '',\n    function: String(frame.methodName),\n    lineno: (frame.lineNumber || 0).toString(),\n    colno: (frame.column || 0).toString()\n  }))\n}\n\nconst extensions = /(chrome|moz|safari)-extension:\\/\\//\n\n// Does this stack trace contain frames from browser extensions?\nfunction isExtensionError(stack: PlatformStackframe[]): boolean {\n  return stack.some(frame => extensions.test(frame.filename) || extensions.test(frame.function))\n}\n\nexport function pageUser() {\n  const login = document.head?.querySelector<HTMLMetaElement>('meta[name=\"user-login\"]')?.content\n  if (login) return login\n\n  const clientId = getOrCreateClientId()\n  return `anonymous-${clientId}`\n}\n\nlet unloaded = false\nwindow.addEventListener('pageshow', () => (unloaded = false))\nwindow.addEventListener('pagehide', () => (unloaded = true))\n\ndocument.addEventListener(SOFT_NAV_STATE.ERROR, event => {\n  report(\n    errorContext({\n      type: 'SoftNavError',\n      value: (event as CustomEvent).detail,\n      stacktrace: stacktrace(new Error())\n    })\n  )\n})\n\nfunction reportable() {\n  return !unloaded && !extensionErrors && errorsReported < 10 && isSupported() && !detectProxySite(document)\n}\n\nfunction bundlerName() {\n  return 'webpack'\n}\n\nif (typeof BroadcastChannel === 'function') {\n  const sharedWorkerErrorChannel = new BroadcastChannel('shared-worker-error')\n  sharedWorkerErrorChannel.addEventListener('message', event => {\n    // SharedWorker will emit a formatted error\n    reportError(event.data.error)\n  })\n}\n","import {AnalyticsClient, getOptionsFromMeta} from '@github/hydro-analytics-client'\nimport type {Context} from '@github/hydro-analytics-client'\n\nconst dimensionPrefix = 'dimension_'\nlet hydroAnalyticsClient: AnalyticsClient | undefined\n\ntry {\n  const options = getOptionsFromMeta('octolytics')\n\n  // Remove the base context because meta tags can change as the user navigates with Turbo\n  // These will be folded in for each event & page view\n  delete options.baseContext\n\n  hydroAnalyticsClient = new AnalyticsClient(options)\n} catch (_) {\n  // Failed to get options from meta tags.  This most likely means analytics are disabled.\n}\n\nfunction extendBaseContext(context?: Context) {\n  const baseContext = getOptionsFromMeta('octolytics').baseContext || {}\n\n  if (baseContext) {\n    delete baseContext.app_id\n    delete baseContext.event_url\n    delete baseContext.host\n\n    for (const key in baseContext) {\n      // some octolytics meta tags are prefixed with dimension-, which we don't need with the new hydro-analytics-client\n      if (key.startsWith(dimensionPrefix)) {\n        baseContext[key.replace(dimensionPrefix, '')] = baseContext[key]\n        delete baseContext[key]\n      }\n    }\n  }\n\n  const visitorMeta = document.querySelector<HTMLMetaElement>('meta[name=visitor-payload]')\n  if (visitorMeta) {\n    const visitorHash = JSON.parse(atob(visitorMeta.content))\n    Object.assign(baseContext, visitorHash)\n  }\n\n  return Object.assign(baseContext, context)\n}\n\nexport function sendPageView(context?: Context) {\n  hydroAnalyticsClient?.sendPageView(extendBaseContext(context))\n}\n\nexport function sendEvent(type: string, context: Record<string, string | number | boolean | undefined | null>) {\n  const service = document.head?.querySelector<HTMLMetaElement>('meta[name=\"current-catalog-service\"]')?.content\n\n  const cleanContext: Context = service ? {service} : {}\n\n  for (const [key, value] of Object.entries(context)) {\n    if (value !== undefined && value !== null) {\n      cleanContext[key] = `${value}`\n    }\n  }\n\n  hydroAnalyticsClient?.sendEvent(type || 'unknown', extendBaseContext(cleanContext))\n}\n","import {sendStats} from './stats'\n\nexport function sendData(hydroEventPayload: string, hydroEventHmac: string, hydroClientContext: string): void {\n  const data = {\n    hydroEventPayload,\n    hydroEventHmac,\n    visitorPayload: '',\n    visitorHmac: '',\n    hydroClientContext\n  }\n\n  const visitorPayload = document.querySelector('meta[name=visitor-payload]')\n  if (visitorPayload instanceof HTMLMetaElement) {\n    data['visitorPayload'] = visitorPayload.content\n  }\n  const visitorHmac = document.querySelector('meta[name=visitor-hmac]') || ''\n  if (visitorHmac instanceof HTMLMetaElement) {\n    data['visitorHmac'] = visitorHmac.content\n  }\n\n  sendStats(data, true)\n}\n\nexport function trackView(el: HTMLElement) {\n  const payload = el.getAttribute('data-hydro-view') || ''\n  const hmac = el.getAttribute('data-hydro-view-hmac') || ''\n  const hydroClientContext = el.getAttribute('data-hydro-client-context') || ''\n  sendData(payload, hmac, hydroClientContext)\n}\n\nexport function sendHydroEvent(el: HTMLElement) {\n  const payload = el.getAttribute('data-hydro-click-payload') || ''\n  const hmac = el.getAttribute('data-hydro-click-hmac') || ''\n  const hydroClientContext = el.getAttribute('data-hydro-client-context') || ''\n  sendData(payload, hmac, hydroClientContext)\n}\n","import '@github/include-fragment-element'\n\nwindow.IncludeFragmentElement.prototype.fetch = (request: Request) => {\n  request.headers.append('X-Requested-With', 'XMLHttpRequest')\n  return window.fetch(request)\n}\n","import type {PageViews} from './page-views'\n\nconst FEATURE_WEIGHTS = {frequency: 0.6, recency: 0.4}\n\nfunction sortBy<T>(items: T[], map: (item: T) => number): T[] {\n  return items.sort((a, b) => map(a) - map(b))\n}\n\ntype Scorer = (pageKey: string) => number\nexport function scorer(pageViews: PageViews): Scorer {\n  const frequencies = frequencyMap(pageViews)\n  const recencies = recencyMap(pageViews)\n  return function (pageKey: string): number {\n    return score(frequencies.get(pageKey) || 0, recencies.get(pageKey) || 0)\n  }\n}\n\nfunction score(frequency: number, recency: number): number {\n  return frequency * FEATURE_WEIGHTS.frequency + recency * FEATURE_WEIGHTS.recency\n}\n\n// Scores a relative frequency in the interval [0, 1] where higher means more frequent.\nfunction frequencyMap(pageViews: PageViews): Map<string, number> {\n  const totalVisits = [...Object.values(pageViews)].reduce((total, view) => total + view.visitCount, 0)\n  return new Map(Object.keys(pageViews).map(pageKey => [pageKey, pageViews[pageKey].visitCount / totalVisits]))\n}\n\n// Scores a relative recency value in the interval [0, 1] where higher means more recent.\nfunction recencyMap(pageViews: PageViews): Map<string, number> {\n  const recencyList = sortBy([...Object.keys(pageViews)], key => pageViews[key].lastVisitedAt)\n  const totalUniqueVisits = recencyList.length\n  return new Map(recencyList.map((key, index) => [key, (index + 1) / totalUniqueVisits]))\n}\n","import {scorer} from './ranking'\nexport {scorer} from './ranking'\n\ntype PageViewSummary = {\n  lastVisitedAt: number\n  visitCount: number\n}\n\nexport type PageViews = {[page_key: string]: PageViewSummary}\n\nconst TEAM_PAGE_REGEX = /^\\/orgs\\/([a-z0-9-]+)\\/teams\\/([\\w-]+)/\n\n// Of course this list is incomplete, but it should be good enough for the purposes of this prototype.\nconst REPOSITORY_PAGE_REGEXES = [\n  // This will overcount some things, but since every page view is ultimately compared to entities\n  // we can jump to it should be fine. Of course if we ever tried to add users or orgs to this it\n  // would break.\n  /^\\/([^/]+)\\/([^/]+)\\/?$/,\n\n  /^\\/([^/]+)\\/([^/]+)\\/blob/,\n  /^\\/([^/]+)\\/([^/]+)\\/tree/,\n  /^\\/([^/]+)\\/([^/]+)\\/issues/,\n  /^\\/([^/]+)\\/([^/]+)\\/pulls?/,\n  /^\\/([^/]+)\\/([^/]+)\\/pulse/\n]\n\nconst PROJECT_PAGE_REGEXES = [\n  ['organization', /^\\/orgs\\/([a-z0-9-]+)\\/projects\\/([0-9-]+)/],\n  ['repository', /^\\/([^/]+)\\/([^/]+)\\/projects\\/([0-9-]+)/]\n]\n\nconst MAX_PAGE_VIEWS_TO_STORE_IN_LOCAL_STORAGE = 100\n\nexport function logPageView(path: string) {\n  const teamPageMatch = path.match(TEAM_PAGE_REGEX)\n  if (teamPageMatch) {\n    logPageViewByKey(buildTeamKey(teamPageMatch[1], teamPageMatch[2]))\n    return\n  }\n\n  let projectPageMatch\n  for (let i = 0, len = PROJECT_PAGE_REGEXES.length; i < len; i++) {\n    const [ownerType, projectRegex] = PROJECT_PAGE_REGEXES[i]\n    projectPageMatch = path.match(projectRegex)\n    if (projectPageMatch) {\n      let ownerSlug: string | null = null\n      let number: string | null = null\n      switch (ownerType) {\n        case 'organization':\n          ownerSlug = projectPageMatch[1]\n          number = projectPageMatch[2]\n          break\n        case 'repository':\n          ownerSlug = `${projectPageMatch[1]}/${projectPageMatch[2]}`\n          number = projectPageMatch[3]\n          break\n        default:\n        // Should never get here.\n      }\n      if (ownerSlug && number) {\n        logPageViewByKey(buildProjectKey(ownerSlug, number))\n      }\n      return\n    }\n  }\n\n  let repositoryPageMatch\n  for (let i = 0, len = REPOSITORY_PAGE_REGEXES.length; i < len; i++) {\n    repositoryPageMatch = path.match(REPOSITORY_PAGE_REGEXES[i])\n    if (repositoryPageMatch) {\n      logPageViewByKey(buildRepositoryKey(repositoryPageMatch[1], repositoryPageMatch[2]))\n      return\n    }\n  }\n}\n\n// Limits localStorage entries to 100 MAX_PAGE_VIEWS_TO_STORE_IN_LOCAL_STORAGE\nfunction limitedPageViews(pageViews: PageViews) {\n  const keys = Object.keys(pageViews)\n  if (keys.length <= MAX_PAGE_VIEWS_TO_STORE_IN_LOCAL_STORAGE) {\n    return pageViews\n  }\n  const scorePage = scorer(pageViews)\n  const ranked = keys.sort((a, b) => scorePage(b) - scorePage(a)).slice(0, MAX_PAGE_VIEWS_TO_STORE_IN_LOCAL_STORAGE / 2)\n  return Object.fromEntries(ranked.map(key => [key, pageViews[key]]))\n}\n\nfunction logPageViewByKey(key: string) {\n  const views = getPageViewsMap()\n  const now = currentEpochTimeInSeconds()\n  const hit = views[key] || {lastVisitedAt: now, visitCount: 0}\n  hit.visitCount += 1\n  hit.lastVisitedAt = now\n  views[key] = hit\n  setPageViewsMap(limitedPageViews(views))\n}\n\nfunction currentEpochTimeInSeconds(): number {\n  return Math.floor(Date.now() / 1000)\n}\n\nexport function buildTeamKey(organizationLogin: string, teamSlug: string): string {\n  return `team:${organizationLogin}/${teamSlug}`\n}\n\nexport function buildRepositoryKey(ownerLogin: string, name: string): string {\n  return `repository:${ownerLogin}/${name}`\n}\n\nexport function buildProjectKey(ownerSlug: string, number: string): string {\n  return `project:${ownerSlug}/${number}`\n}\n\nconst PAGE_VIEW_KEY_REGEX = /^(team|repository|project):[^/]+\\/[^/]+(\\/([^/]+))?$/\nconst VIEWS_KEY = 'jump_to:page_views'\n\nfunction setPageViewsMap(views: PageViews) {\n  setItem(VIEWS_KEY, JSON.stringify(views))\n}\n\nexport function getPageViewsMap(): PageViews {\n  const rawData = getItem(VIEWS_KEY)\n  if (!rawData) return {}\n\n  let json\n  try {\n    json = JSON.parse(rawData)\n  } catch {\n    // Clear localStorage since we know it's bad\n    setPageViewsMap({})\n    return {}\n  }\n\n  const pageViewMap: PageViews = {}\n  for (const key in json) {\n    if (key.match(PAGE_VIEW_KEY_REGEX)) {\n      pageViewMap[key] = json[key]\n    }\n  }\n  return pageViewMap\n}\n\nfunction setItem(key: string, value: string) {\n  try {\n    window.localStorage.setItem(key, value)\n  } catch {\n    // Storage quota exceeded.\n  }\n}\n\nfunction getItem(key: string): string | null {\n  try {\n    return window.localStorage.getItem(key)\n  } catch {\n    // Storage unavailable.\n    return null\n  }\n}\n","/*\n * Applies state updates from a form (e.g. Mark as read/archive/unsubscribe/star) to the element\n * that represents the notification (e.g. The notification item in the list view, or the\n * notification shelf on an Issue page).\n */\nexport function updateNotificationStates(element: HTMLElement, form: HTMLFormElement) {\n  const notification = element.closest<HTMLElement>('[data-notification-id]')!\n\n  // Toggles read/unread/archive status\n  if (form.hasAttribute('data-status')) {\n    toggleNotificationStatus(notification, form.getAttribute('data-status')!)\n  }\n\n  // Toggles subscribed/unsubscribed status\n  if (form.hasAttribute('data-subscription-status')) {\n    toggleNotificationSubscriptionStatus(notification, form.getAttribute('data-subscription-status')!)\n  }\n\n  // Toggles starred/unstarred status\n  if (form.hasAttribute('data-starred-status')) {\n    toggleNotificationStarredStatus(notification, form.getAttribute('data-starred-status')!)\n  }\n}\n\nfunction toggleNotificationStatus(notification: HTMLElement, status: string) {\n  notification.classList.toggle('notification-archived', status === 'archived')\n  notification.classList.toggle('notification-unread', status === 'unread')\n  notification.classList.toggle('notification-read', status === 'read')\n}\n\nfunction toggleNotificationSubscriptionStatus(notification: HTMLElement, status: string) {\n  notification.classList.toggle('notification-unsubscribed', status === 'unsubscribed')\n}\n\nfunction toggleNotificationStarredStatus(notification: HTMLElement, status: string) {\n  notification.classList.toggle('notification-starred', status === 'starred')\n}\n","// eslint-disable-next-line no-restricted-imports\nimport {observe} from 'selector-observer'\n\nexport function getPlatform(): string | null {\n  if (/Windows/.test(navigator.userAgent)) {\n    return 'windows'\n  }\n  if (/Macintosh/.test(navigator.userAgent)) {\n    return 'mac'\n  }\n  return null\n}\n\nfunction runningOnPlatform(element: Element): boolean {\n  const platforms = (element.getAttribute('data-platforms') || '').split(',')\n  const platform = getPlatform()\n  return Boolean(platform && platforms.includes(platform))\n}\n\nobserve('.js-remove-unless-platform', function (el) {\n  if (!runningOnPlatform(el)) {\n    el.remove()\n  }\n})\n","import safeStorage from './safe-storage'\n\nexport const {getItem, setItem, removeItem} = safeStorage('sessionStorage')\n","import {getItem, removeItem, setItem} from './session-storage'\nimport {requestUri} from './analytics-overrides'\n\nexport const SOFT_NAV_STATE = Object.freeze({\n  INITIAL: 'soft-nav:initial',\n  SUCCESS: 'soft-nav:success',\n  ERROR: 'soft-nav:error'\n})\nconst SOFT_NAV_FAIL = 'soft-navigation-fail'\nconst SOFT_NAV_REFERRER = 'soft-navigation-referrer'\nconst SOFT_NAV_MARK = 'soft-navigation-marker'\nconst DEFAULT_SOFT_NAV_ERROR_REASON = 'reload'\n\nexport function inSoftNavigation() {\n  return getItem(SOFT_NAV_MARK) === '1'\n}\n\nexport function hasSoftNavFailure() {\n  return Boolean(getSoftNavFailReason())\n}\n\nexport function startSoftNav() {\n  setItem(SOFT_NAV_MARK, '1')\n  setItem(SOFT_NAV_REFERRER, requestUri() || window.location.href)\n}\n\nexport function endSoftNav() {\n  setItem(SOFT_NAV_MARK, '0')\n}\n\nfunction clearSoftNav() {\n  setItem(SOFT_NAV_MARK, '0')\n  removeItem(SOFT_NAV_REFERRER)\n  removeItem(SOFT_NAV_FAIL)\n}\n\nexport function setSoftNavFailReason(reason: string) {\n  setItem(SOFT_NAV_FAIL, reason || DEFAULT_SOFT_NAV_ERROR_REASON)\n}\n\nfunction getSoftNavFailReason() {\n  return getItem(SOFT_NAV_FAIL)\n}\n\nlet visitCount = 0\nexport function softNavSucceeded() {\n  visitCount += 1\n  document.dispatchEvent(new CustomEvent(SOFT_NAV_STATE.SUCCESS, {detail: visitCount}))\n}\n\nexport function softNavFailed() {\n  document.dispatchEvent(\n    new CustomEvent(SOFT_NAV_STATE.ERROR, {detail: getSoftNavFailReason() || DEFAULT_SOFT_NAV_ERROR_REASON})\n  )\n  visitCount = 0\n  clearSoftNav()\n}\n\nexport function softNavInitial() {\n  document.dispatchEvent(new CustomEvent(SOFT_NAV_STATE.INITIAL))\n  visitCount = 0\n  clearSoftNav()\n}\n\nexport function getSoftNavReferrer() {\n  return getItem(SOFT_NAV_REFERRER) || document.referrer\n}\n","import {findFragmentTarget} from './fragment-target'\nimport {forceStickyRelayout} from './behaviors/sticky'\n\n// Scroll element into view accounting for sticky/fixed overlays.\nexport function scrollIntoView(el: Element) {\n  const document = el.ownerDocument\n  setTimeout(() => {\n    if (document && document.defaultView) {\n      el.scrollIntoView()\n      document.defaultView.scrollBy(0, -computeFixedYOffset(document))\n    }\n  }, 0)\n}\n\n// Scroll to fragment target element accounting for sticky/fixed\n// overlays.\nexport function scrollToFragmentTarget(document: Document) {\n  const target = findFragmentTarget(document)\n  if (target) {\n    scrollIntoView(target)\n  }\n}\n\n// Compute height of visible sticky/fixed overlay on page.\nexport function computeFixedYOffset(document: Document): number {\n  // Force synchronous layout of any sticky elements before measuring offset\n  forceStickyRelayout()\n\n  const jsStickyEls = document.querySelectorAll('.js-sticky-offset-scroll')\n  const positionStickyEls = document.querySelectorAll('.js-position-sticky')\n\n  // Find maximum combined height of sticky-offset / position-sticky elements\n  // If none are present, fallback to 0 as Math.max() returns -Infinity\n\n  const scrollOffset =\n    Math.max(\n      0,\n      ...Array.from(jsStickyEls).map(el => {\n        const {top, height} = el.getBoundingClientRect()\n        return top === 0 ? height : 0\n      })\n    ) +\n    Math.max(\n      0,\n      ...Array.from(positionStickyEls).map(el => {\n        const {top, height} = el.getBoundingClientRect()\n        const topStyleValue = parseInt(getComputedStyle(el).top)\n\n        if (!el.parentElement) {\n          return 0\n        }\n\n        const parentTop = el.parentElement.getBoundingClientRect().top\n        // include js-position-sticky element height in scroll offset if element is sticky\n        return top === topStyleValue && parentTop < 0 ? height : 0\n      })\n    )\n\n  // Use .js-position-sticky-stacked for sticky elements that are stacked (e.g. multiple sticky elements on a page)\n  // rather than nested\n  const jsStickyElsStacked = document.querySelectorAll('.js-position-sticky-stacked')\n  const stackedHeight = Array.from(jsStickyElsStacked).reduce((a, el) => {\n    const {height, top} = el.getBoundingClientRect()\n    const isOffScreen = top < 0\n    const isStuck = el.classList.contains('is-stuck')\n    return a + (!isOffScreen && isStuck ? height : 0)\n  }, 0)\n\n  return scrollOffset + stackedHeight\n}\n","import {dialog} from './details-dialog'\nimport {fetchSafeDocumentFragment} from './fetch'\nimport {remoteForm} from '@github/remote-form'\nimport {webauthnSupportLevel} from './webauthn-support-level'\n\nlet sudoPromptExist = false\n\n/**\n * Take a URL and add webauthn params to it.\n *\n * @param {string} oldURL - The old URL.\n * @returns {string} - The new URL with added params.\n */\nfunction urlWithParams(oldURL: string): string {\n  const newURL = new URL(oldURL, window.location.origin)\n  const params = new URLSearchParams(newURL.search.slice(1))\n  params.set('webauthn-support', webauthnSupportLevel())\n  newURL.search = params.toString()\n  return newURL.toString()\n}\n\nasync function loadPromptTemplate(): Promise<HTMLTemplateElement> {\n  const link = document.querySelector<HTMLLinkElement>('link[rel=sudo-modal]')!\n  const template = document.querySelector('.js-sudo-prompt')\n  if (template instanceof HTMLTemplateElement) {\n    return template\n  } else if (link) {\n    const fragment = await fetchSafeDocumentFragment(document, urlWithParams(link.href))\n    document.body.appendChild(fragment)\n    return document.querySelector<HTMLTemplateElement>('.js-sudo-prompt')!\n  } else {\n    throw new Error(\"couldn't load sudo prompt\")\n  }\n}\n\nlet succeeded = false\n\n/**\n * Provide a sudo prompt, and return when it has been filled in or dismissed.\n *\n * @returns {Promise<boolean>} - Resolves to `true` if the user successfully authed with sudo.\n */\nasync function sudoPrompt(): Promise<boolean> {\n  if (sudoPromptExist) return false\n  sudoPromptExist = true\n  succeeded = false\n  const template = await loadPromptTemplate()\n  const content = template.content.cloneNode(true)\n  const prompt = await dialog({content})\n  await new Promise<void>(resolve => {\n    prompt.addEventListener(\n      'dialog:remove',\n      function () {\n        sudoPromptExist = false\n        resolve()\n      },\n      {once: true}\n    )\n  })\n  return succeeded\n}\n\nremoteForm('.js-sudo-form', async function (form, wants) {\n  try {\n    await wants.text()\n  } catch (error) {\n    if (!error.response) throw error\n    let errorMessage\n    switch (error.response.status) {\n      case 401:\n        // eslint-disable-next-line i18n-text/no-en\n        errorMessage = 'Incorrect password.'\n        break\n      case 429:\n        // eslint-disable-next-line i18n-text/no-en\n        errorMessage = 'Too many password attempts. Please wait and try again later.'\n        break\n      default:\n        // eslint-disable-next-line i18n-text/no-en\n        errorMessage = 'Failed to receive a response. Please try again later.'\n    }\n\n    form.querySelector<HTMLElement>('.js-sudo-error')!.textContent = errorMessage\n    form.querySelector<HTMLElement>('.js-sudo-error')!.hidden = false\n    form.querySelector<HTMLInputElement>('.js-sudo-password')!.value = ''\n\n    return\n  }\n  succeeded = true\n  form.closest<HTMLElement>('details')!.removeAttribute('open')\n})\n\n/**\n * Check if user is in sudo mode. If not, show a sudo prompt.\n *\n * @returns {Promise<boolean>} - Will be `true` if user is in or got in sudo mode after prompt.\n */\nexport default async function triggerSudoPrompt(): Promise<boolean> {\n  const response = await fetch('/sessions/in_sudo', {\n    headers: {accept: 'application/json', 'X-Requested-With': 'XMLHttpRequest'}\n  })\n  if (response.ok) {\n    const sudoResponse = await response.text()\n    if (sudoResponse === 'true') {\n      return true\n    } else {\n      return sudoPrompt()\n    }\n  }\n  return sudoPrompt()\n}\n","// Gets the length of code-points from a String.\n//\n// This is different to `string.length` which returns the amount of utf-8\n// bytes, which is a different metric as - for example - the poo emoji is 2\n// utf-8 bytes, but 1 unicode code point.\n//\n// See http://blog.jonnew.com/posts/poo-dot-length-equals-two for more.\nexport function getUtf8StringLength(str: string): number {\n  const joiner = '\\u200D'\n  const split = str.split(joiner)\n  let count = 0\n\n  for (const s of split) {\n    // removing the variation selectors\n    const num = Array.from(s.split(/[\\ufe00-\\ufe0f]/).join('')).length\n    count += num\n  }\n\n  // assuming the joiners are used appropriately\n  return count / split.length\n}\n/**\n * Replace text in a textarea with a new string and\n * place the cursor at the selectionEnd position.\n * @param textarea an `<input>` or `<textarea>` element\n * @param oldText The text to replace\n * @param newText The new text to replace with\n * @returns The new text\n */\nexport function replaceText(\n  textarea: HTMLInputElement | HTMLTextAreaElement,\n  oldText: string,\n  newText: string\n): string {\n  let beginning = textarea.value.substring(0, textarea.selectionEnd || 0)\n  let remaining = textarea.value.substring(textarea.selectionEnd || 0)\n  beginning = beginning.replace(oldText, newText)\n  remaining = remaining.replace(oldText, newText)\n\n  setTextareaValueAndCursor(textarea, beginning + remaining, beginning.length)\n\n  return newText\n}\n\n/**\n * Replace selected text in a textarea with a new string.\n * If the selection is empty, the old text is replaced by the\n * new text in the whole textarea.\n * @param textarea an `<input>` or `<textarea>` element\n * @param oldText The text to replace\n * @param newText The new text to replace with\n * @returns The new text\n */\nexport function replaceSelection(\n  textarea: HTMLInputElement | HTMLTextAreaElement,\n  oldText: string,\n  newText: string\n): string {\n  if (textarea.selectionStart === null || textarea.selectionEnd === null) {\n    return replaceText(textarea, oldText, newText)\n  }\n  const beginning = textarea.value.substring(0, textarea.selectionStart)\n  const remaining = textarea.value.substring(textarea.selectionEnd)\n\n  setTextareaValueAndCursor(textarea, beginning + newText + remaining, beginning.length)\n\n  return newText\n}\n\ntype InsertOptions = {\n  appendNewline?: boolean\n}\n/**\n * Inserts text into a text input and moves the cursor appropriately.\n * If the cursor happens to be in the middle of a line, or the textarea isn't empty,\n * we add a newline character before the inserted text. We also advance the cursor\n * appropriately\n * @param textarea an `<input>` or `<textarea>` element\n * @param text The text to add\n * @param appendNewline optionally adds a `\\n` character after `text`\n */\nexport function insertText(\n  textarea: HTMLInputElement | HTMLTextAreaElement,\n  text: string,\n  options: InsertOptions = {}\n): string {\n  const point = textarea.selectionEnd || 0\n  const beginning = textarea.value.substring(0, point)\n  const remaining = textarea.value.substring(point)\n  const newline = textarea.value === '' || beginning.match(/\\n$/) ? '' : '\\n'\n  const trailingNewline = options.appendNewline ? '\\n' : ''\n  const insertedText = newline + text + trailingNewline\n\n  textarea.value = beginning + insertedText + remaining\n  const newPoint = point + insertedText.length\n  textarea.selectionStart = newPoint\n  textarea.selectionEnd = newPoint\n  textarea.dispatchEvent(new CustomEvent('change', {bubbles: true, cancelable: false}))\n  textarea.focus()\n  return insertedText\n}\n\n/**\n * Helper function to set the value of a textarea and move the cursor to a given position.\n * Emits a `change` event.\n * @param textarea an `<input>` or `<textarea>` element\n * @param value The new value\n * @param cursor The position to move the cursor to\n */\nfunction setTextareaValueAndCursor(textarea: HTMLInputElement | HTMLTextAreaElement, value: string, cursor: number) {\n  textarea.value = value\n  textarea.selectionStart = cursor\n  textarea.selectionEnd = cursor\n  textarea.dispatchEvent(new CustomEvent('change', {bubbles: true, cancelable: false}))\n}\n","import {supported as webauthnSupported} from '@github/webauthn-json'\n\n// Note: the default feedback value stored in the form is 'unknown', but that\n// should not be used unless the JS fails to run.\ntype WebauthnSupportLevel = 'supported' | 'unsupported'\n\n// Calculates a string value to send to the server.\nexport function webauthnSupportLevel(): WebauthnSupportLevel {\n  return webauthnSupported() ? 'supported' : 'unsupported'\n}\n\n// Calculates a string value to send to the server.\nexport async function iuvpaaSupportLevel(): Promise<WebauthnSupportLevel> {\n  if (await window.PublicKeyCredential?.isUserVerifyingPlatformAuthenticatorAvailable()) {\n    return 'supported'\n  }\n  return 'unsupported'\n}\n"],"sourceRoot":""}